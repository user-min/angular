/*!
 * Tiny PowerPaste plugin
 *
 * Copyright 2010-2021 Tiny Technologies, Inc. All rights reserved.
 *
 * Version: 5.4.1-472
 */
!function() {
    "use strict";
    function e(t) {
        return parseInt(t, 10)
    }
    function r(t, e) {
        return 0 == (e = t - e) ? 0 : 0 < e ? 1 : -1
    }
    function n(t, e, n) {
        return {
            major: t,
            minor: e,
            patch: n
        }
    }
    function o(t) {
        return (t = /([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(t)) ? n(e(t[1]), e(t[2]), e(t[3])) : n(0, 0, 0)
    }
    function i(n, r) {
        return function() {
            for (var t = [], e = 0; e < arguments.length; e++)
                t[e] = arguments[e];
            return n(r.apply(null, t))
        }
    }
    function u(t) {
        return t
    }
    var c = function(t, e) {
        return !!t && -1 === function(t, e) {
            var n = r(t.major, e.major);
            if (0 !== n)
                return n;
            n = r(t.minor, e.minor);
            if (0 !== n)
                return n;
            e = r(t.patch, e.patch);
            return 0 !== e ? e : 0
        }(o([(t = t = t).majorVersion, t.minorVersion].join(".").split(".").slice(0, 3).join(".")), o(e))
    }
        , t = function(r, o) {
        return function() {
            for (var t = [], e = 0; e < arguments.length; e++)
                t[e] = arguments[e];
            var n = r.console;
            n && o in n && n[o].apply(n, arguments)
        }
    }
        , s = {
        log: t(window, "log"),
        error: t(window, "error"),
        warn: t(window, "warn")
    }
        , f = function(t, e) {
        t.addCommand("mceTogglePlainTextPaste", e.toggle)
    }
        , y = function() {}
        , l = function(t) {
        return function() {
            return t
        }
    };
    function p(r) {
        for (var o = [], t = 1; t < arguments.length; t++)
            o[t - 1] = arguments[t];
        return function() {
            for (var t = [], e = 0; e < arguments.length; e++)
                t[e] = arguments[e];
            var n = o.concat(t);
            return r.apply(null, n)
        }
    }
    function a(t) {
        return function() {
            throw new Error(t)
        }
    }
    var b = function(t) {
        return t()
    }
        , d = l(!1)
        , m = l(!0)
        , g = function() {
        return v
    }
        , v = {
        fold: function(t, e) {
            return t()
        },
        is: d,
        isSome: d,
        isNone: m,
        getOr: T,
        getOrThunk: x,
        getOrDie: function(t) {
            throw new Error(t || "error: getOrDie called on none.")
        },
        getOrNull: l(null),
        getOrUndefined: l(void 0),
        or: T,
        orThunk: x,
        map: g,
        each: y,
        bind: g,
        exists: d,
        forall: m,
        filter: g,
        equals: h,
        equals_: h,
        toArray: function() {
            return []
        },
        toString: l("none()")
    };
    function h(t) {
        return t.isNone()
    }
    function x(t) {
        return t()
    }
    function T(t) {
        return t
    }
    function w(t) {
        return null == t
    }
    function E(t) {
        return !w(t)
    }
    function S(t, e) {
        return t = t,
            e = e,
        -1 < ot.call(t, e)
    }
    function A(t, e) {
        for (var n = [], r = [], o = 0, i = t.length; o < i; o++) {
            var u = t[o];
            (e(u, o) ? n : r).push(u)
        }
        return {
            pass: n,
            fail: r
        }
    }
    function I(t, e, n) {
        return ct(t, function(t) {
            n = e(n, t)
        }),
            n
    }
    function _(t, e) {
        return function(t, e, n) {
            for (var r = 0, o = t.length; r < o; r++) {
                var i = t[r];
                if (e(i, r))
                    return G.some(i);
                if (n(i, r))
                    break
            }
            return G.none()
        }(t, e, d)
    }
    function L(t, e) {
        for (var n = 0, r = t.length; n < r; n++) {
            if (e(t[n], n))
                return G.some(n)
        }
        return G.none()
    }
    function O(t) {
        for (var e = [], n = 0, r = t.length; n < r; ++n) {
            if (!Q(t[n]))
                throw new Error("Arr.flatten item " + n + " was not an array, input: " + t);
            it.apply(e, t[n])
        }
        return e
    }
    function D(t, e) {
        for (var n = 0, r = t.length; n < r; ++n) {
            if (!0 !== e(t[n], n))
                return !1
        }
        return !0
    }
    function N(t, e) {
        for (var n = {}, r = 0, o = t.length; r < o; r++) {
            var i = t[r];
            n[String(i)] = e(i, r)
        }
        return n
    }
    function C(t) {
        return 0 === t.length ? G.none() : G.some(t[0])
    }
    function P(t, e) {
        for (var n = 0; n < t.length; n++) {
            var r = e(t[n], n);
            if (r.isSome())
                return r
        }
        return G.none()
    }
    function k(t, e) {
        t.dom.bind(e, "drop dragstart dragend dragover dragenter dragleave dragdrop draggesture", function(t) {
            t.preventDefault(),
                t.stopImmediatePropagation()
        })
    }
    function R(t, e) {
        for (var n = Ot(t), r = 0, o = n.length; r < o; r++) {
            var i = n[r];
            e(t[i], i)
        }
    }
    function M(t, n) {
        return Nt(t, function(t, e) {
            return {
                k: e,
                v: n(t, e)
            }
        })
    }
    function F(t, n) {
        var r = [];
        return R(t, function(t, e) {
            r.push(n(t, e))
        }),
            r
    }
    function j(t) {
        return Ot(t).length
    }
    function U(t, e, n) {
        return "" === e || t.length >= e.length && t.substr(n, n + e.length) === e
    }
    function H(t, e) {
        return kt(t, e) ? (n = t,
            e = e.length,
            n.substring(e)) : t;
        var n
    }
    function B(t, e) {
        return Rt(t, e) ? (n = t,
            e = e.length,
            n.substring(0, n.length - e)) : t;
        var n
    }
    var W, z, Y, q, $, V = function(n) {
        function t() {
            return o
        }
        function e(t) {
            return t(n)
        }
        var r = l(n)
            , o = {
            fold: function(t, e) {
                return e(n)
            },
            is: function(t) {
                return n === t
            },
            isSome: m,
            isNone: d,
            getOr: r,
            getOrThunk: r,
            getOrDie: r,
            getOrNull: r,
            getOrUndefined: r,
            or: t,
            orThunk: t,
            map: function(t) {
                return V(t(n))
            },
            each: function(t) {
                t(n)
            },
            bind: e,
            exists: e,
            forall: e,
            filter: function(t) {
                return t(n) ? o : v
            },
            toArray: function() {
                return [n]
            },
            toString: function() {
                return "some(" + n + ")"
            },
            equals: function(t) {
                return t.is(n)
            },
            equals_: function(t, e) {
                return t.fold(d, function(t) {
                    return e(n, t)
                })
            }
        };
        return o
    }, G = {
        some: V,
        none: g,
        from: function(t) {
            return null == t ? v : V(t)
        }
    }, K = function(n) {
        return function(t) {
            return t = typeof (e = t),
            (null === e ? "null" : "object" == t && (Array.prototype.isPrototypeOf(e) || e.constructor && "Array" === e.constructor.name) ? "array" : "object" == t && (String.prototype.isPrototypeOf(e) || e.constructor && "String" === e.constructor.name) ? "string" : t) === n;
            var e
        }
    }, X = function(e) {
        return function(t) {
            return typeof t === e
        }
    }, J = K("string"), Z = K("object"), Q = K("array"), tt = X("boolean"), et = X("function"), nt = X("number"), rt = Array.prototype.slice, ot = Array.prototype.indexOf, it = Array.prototype.push, ut = function(t, e) {
        for (var n = 0, r = t.length; n < r; n++) {
            if (e(t[n], n))
                return !0
        }
        return !1
    }, at = function(t, e) {
        for (var n = t.length, r = new Array(n), o = 0; o < n; o++) {
            var i = t[o];
            r[o] = e(i, o)
        }
        return r
    }, ct = function(t, e) {
        for (var n = 0, r = t.length; n < r; n++) {
            e(t[n], n)
        }
    }, st = function(t, e) {
        for (var n = [], r = 0, o = t.length; r < o; r++) {
            var i = t[r];
            e(i, r) && n.push(i)
        }
        return n
    }, ft = function(t, e) {
        return O(at(t, e))
    }, lt = function(t) {
        return t.getParam("powerpaste_block_drop", !1, "boolean")
    }, dt = function(t) {
        return t.getParam("images_upload_url")
    }, mt = function(t) {
        return J(dt(t))
    }, pt = function(t) {
        return t.getParam("smart_paste", !0, "boolean")
    }, gt = function(t) {
        return t.getParam("automatic_uploads", !0, "boolean")
    }, vt = function(t) {
        return t.getParam("powerpaste_keep_unsupported_src", !1, "boolean")
    }, ht = function(t) {
        return t.getParam("paste_preprocess")
    }, yt = function(t) {
        return t.getParam("cache_suffix")
    }, bt = function(t) {
        return t.getParam("powerpaste_allow_local_images", !0, "boolean")
    }, xt = function(t) {
        return t.getParam("powerpaste_word_import", "prompt", "string")
    }, Tt = function(t) {
        return t.getParam("powerpaste_html_import", "clean", "string")
    }, wt = function(t) {
        return t.getParam("images_upload_base_path")
    }, Et = function(t) {
        return t.getParam("images_upload_credentials")
    }, St = function(t) {
        return !1 !== t.getParam("paste_merge_formats")
    }, At = function(t) {
        t = t.getParam("powerpaste_clean_filtered_inline_elements");
        return J(t) ? at(t.split(","), function(t) {
            return t.trim()
        }) : []
    }, It = function(t) {
        return t.getParam("paste_tab_spaces", 4, "number")
    }, _t = function(t) {
        return tinymce.explode(t.getParam("images_file_types", "jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp", "string"))
    }, Lt = function(e) {
        e.on("init", function(t) {
            k(e, e.getBody()),
            e.inline || k(e, e.getDoc())
        })
    }, Ot = Object.keys, Dt = Object.hasOwnProperty, Nt = function(t, n) {
        var r = {};
        return R(t, function(t, e) {
            e = n(t, e);
            r[e.k] = e.v
        }),
            r
    }, Ct = function(t, e) {
        return Dt.call(t, e)
    }, Pt = function(t, e) {
        return -1 !== t.indexOf(e)
    }, kt = function(t, e) {
        return U(t, e, 0)
    }, Rt = function(t, e) {
        return U(t, e, t.length - e.length)
    }, Mt = (W = /^\s+|\s+$/g,
            function(t) {
                return t.replace(W, "")
            }
    ), Ft = function() {
        return (Ft = Object.assign || function(t) {
                for (var e, n = 1, r = arguments.length; n < r; n++)
                    for (var o in e = arguments[n])
                        Object.prototype.hasOwnProperty.call(e, o) && (t[o] = e[o]);
                return t
            }
        ).apply(this, arguments)
    }, jt = function(u) {
        if (!Q(u))
            throw new Error("cases must be an array");
        if (0 === u.length)
            throw new Error("there must be at least one case");
        var a = []
            , n = {};
        return ct(u, function(t, r) {
            var e = Ot(t);
            if (1 !== e.length)
                throw new Error("one and only one name per case");
            var o = e[0]
                , i = t[o];
            if (void 0 !== n[o])
                throw new Error("duplicate key detected:" + o);
            if ("cata" === o)
                throw new Error("cannot have a case named cata (sorry)");
            if (!Q(i))
                throw new Error("case arguments must be an array");
            a.push(o),
                n[o] = function() {
                    var t = arguments.length;
                    if (t !== i.length)
                        throw new Error("Wrong number of arguments to case " + o + ". Expected " + i.length + " (" + i + "), got " + t);
                    for (var n = new Array(t), e = 0; e < n.length; e++)
                        n[e] = arguments[e];
                    return {
                        fold: function() {
                            if (arguments.length !== u.length)
                                throw new Error("Wrong number of arguments to fold. Expected " + u.length + ", got " + arguments.length);
                            return arguments[r].apply(null, n)
                        },
                        match: function(t) {
                            var e = Ot(t);
                            if (a.length !== e.length)
                                throw new Error("Wrong number of arguments to match. Expected: " + a.join(",") + "\nActual: " + e.join(","));
                            if (!D(a, function(t) {
                                return S(e, t)
                            }))
                                throw new Error("Not all branches were specified when using match. Specified: " + e.join(", ") + "\nRequired: " + a.join(", "));
                            return t[o].apply(null, n)
                        },
                        log: function(t) {
                            console.log(t, {
                                constructors: a,
                                constructor: o,
                                params: n
                            })
                        }
                    }
                }
        }),
            n
    }, Ut = jt([{
        blob: ["id", "imageresult", "objurl"]
    }, {
        url: ["id", "url", "raw"]
    }]), Ht = Ft({
        cata: function(t, e, n) {
            return t.fold(e, n)
        }
    }, Ut), Bt = {}, Wt = {
        exports: Bt
    };
    Y = Bt,
        q = Wt,
        $ = z = void 0,
        function(t) {
            "object" == typeof Y && void 0 !== q ? q.exports = t() : "function" == typeof z && z.amd ? z([], t) : ("undefined" != typeof window ? window : "undefined" != typeof global ? global : "undefined" != typeof self ? self : this).EphoxContactWrapper = t()
        }(function() {
            return function r(o, i, u) {
                function a(e, t) {
                    if (!i[e]) {
                        if (!o[e]) {
                            var n = "function" == typeof $ && $;
                            if (!t && n)
                                return n(e, !0);
                            if (c)
                                return c(e, !0);
                            throw (n = new Error("Cannot find module '" + e + "'")).code = "MODULE_NOT_FOUND",
                                n
                        }
                        n = i[e] = {
                            exports: {}
                        },
                            o[e][0].call(n.exports, function(t) {
                                return a(o[e][1][t] || t)
                            }, n, n.exports, r, o, i, u)
                    }
                    return i[e].exports
                }
                for (var c = "function" == typeof $ && $, t = 0; t < u.length; t++)
                    a(u[t]);
                return a
            }({
                1: [function(t, e, n) {
                    var r, o, e = e.exports = {};
                    function i() {
                        throw new Error("setTimeout has not been defined")
                    }
                    function u() {
                        throw new Error("clearTimeout has not been defined")
                    }
                    function a(e) {
                        if (r === setTimeout)
                            return setTimeout(e, 0);
                        if ((r === i || !r) && setTimeout)
                            return r = setTimeout,
                                setTimeout(e, 0);
                        try {
                            return r(e, 0)
                        } catch (t) {
                            try {
                                return r.call(null, e, 0)
                            } catch (t) {
                                return r.call(this, e, 0)
                            }
                        }
                    }
                    !function() {
                        try {
                            r = "function" == typeof setTimeout ? setTimeout : i
                        } catch (t) {
                            r = i
                        }
                        try {
                            o = "function" == typeof clearTimeout ? clearTimeout : u
                        } catch (t) {
                            o = u
                        }
                    }();
                    var c, s = [], f = !1, l = -1;
                    function d() {
                        f && c && (f = !1,
                            c.length ? s = c.concat(s) : l = -1,
                        s.length && m())
                    }
                    function m() {
                        if (!f) {
                            var t = a(d);
                            f = !0;
                            for (var e = s.length; e; ) {
                                for (c = s,
                                         s = []; ++l < e; )
                                    c && c[l].run();
                                l = -1,
                                    e = s.length
                            }
                            c = null,
                                f = !1,
                                function(e) {
                                    if (o === clearTimeout)
                                        return clearTimeout(e);
                                    if ((o === u || !o) && clearTimeout)
                                        return o = clearTimeout,
                                            clearTimeout(e);
                                    try {
                                        o(e)
                                    } catch (t) {
                                        try {
                                            return o.call(null, e)
                                        } catch (t) {
                                            return o.call(this, e)
                                        }
                                    }
                                }(t)
                        }
                    }
                    function p(t, e) {
                        this.fun = t,
                            this.array = e
                    }
                    function g() {}
                    e.nextTick = function(t) {
                        var e = new Array(arguments.length - 1);
                        if (1 < arguments.length)
                            for (var n = 1; n < arguments.length; n++)
                                e[n - 1] = arguments[n];
                        s.push(new p(t,e)),
                        1 !== s.length || f || a(m)
                    }
                        ,
                        p.prototype.run = function() {
                            this.fun.apply(null, this.array)
                        }
                        ,
                        e.title = "browser",
                        e.browser = !0,
                        e.env = {},
                        e.argv = [],
                        e.version = "",
                        e.versions = {},
                        e.on = g,
                        e.addListener = g,
                        e.once = g,
                        e.off = g,
                        e.removeListener = g,
                        e.removeAllListeners = g,
                        e.emit = g,
                        e.prependListener = g,
                        e.prependOnceListener = g,
                        e.listeners = function(t) {
                            return []
                        }
                        ,
                        e.binding = function(t) {
                            throw new Error("process.binding is not supported")
                        }
                        ,
                        e.cwd = function() {
                            return "/"
                        }
                        ,
                        e.chdir = function(t) {
                            throw new Error("process.chdir is not supported")
                        }
                        ,
                        e.umask = function() {
                            return 0
                        }
                }
                    , {}],
                2: [function(t, l, e) {
                    (function(e) {
                            function r() {}
                            function i(t) {
                                if ("object" != typeof this)
                                    throw new TypeError("Promises must be constructed via new");
                                if ("function" != typeof t)
                                    throw new TypeError("not a function");
                                this._state = 0,
                                    this._handled = !1,
                                    this._value = void 0,
                                    this._deferreds = [],
                                    f(t, this)
                            }
                            function o(n, r) {
                                for (; 3 === n._state; )
                                    n = n._value;
                                0 !== n._state ? (n._handled = !0,
                                    i._immediateFn(function() {
                                        var t, e = 1 === n._state ? r.onFulfilled : r.onRejected;
                                        if (null !== e) {
                                            try {
                                                t = e(n._value)
                                            } catch (t) {
                                                return void a(r.promise, t)
                                            }
                                            u(r.promise, t)
                                        } else
                                            (1 === n._state ? u : a)(r.promise, n._value)
                                    })) : n._deferreds.push(r)
                            }
                            function u(e, t) {
                                try {
                                    if (t === e)
                                        throw new TypeError("A promise cannot be resolved with itself.");
                                    if (t && ("object" == typeof t || "function" == typeof t)) {
                                        var n = t.then;
                                        if (t instanceof i)
                                            return e._state = 3,
                                                e._value = t,
                                                void c(e);
                                        if ("function" == typeof n)
                                            return void f((r = n,
                                                    o = t,
                                                    function() {
                                                        r.apply(o, arguments)
                                                    }
                                            ), e)
                                    }
                                    e._state = 1,
                                        e._value = t,
                                        c(e)
                                } catch (t) {
                                    a(e, t)
                                }
                                var r, o
                            }
                            function a(t, e) {
                                t._state = 2,
                                    t._value = e,
                                    c(t)
                            }
                            function c(t) {
                                2 === t._state && 0 === t._deferreds.length && i._immediateFn(function() {
                                    t._handled || i._unhandledRejectionFn(t._value)
                                });
                                for (var e = 0, n = t._deferreds.length; e < n; e++)
                                    o(t, t._deferreds[e]);
                                t._deferreds = null
                            }
                            function s(t, e, n) {
                                this.onFulfilled = "function" == typeof t ? t : null,
                                    this.onRejected = "function" == typeof e ? e : null,
                                    this.promise = n
                            }
                            function f(t, e) {
                                var n = !1;
                                try {
                                    t(function(t) {
                                        n || (n = !0,
                                            u(e, t))
                                    }, function(t) {
                                        n || (n = !0,
                                            a(e, t))
                                    })
                                } catch (t) {
                                    if (n)
                                        return;
                                    n = !0,
                                        a(e, t)
                                }
                            }
                            var t, n;
                            t = this,
                                n = setTimeout,
                                i.prototype.catch = function(t) {
                                    return this.then(null, t)
                                }
                                ,
                                i.prototype.then = function(t, e) {
                                    var n = new this.constructor(r);
                                    return o(this, new s(t,e,n)),
                                        n
                                }
                                ,
                                i.all = function(t) {
                                    var a = Array.prototype.slice.call(t);
                                    return new i(function(o, i) {
                                            if (0 === a.length)
                                                return o([]);
                                            var u = a.length;
                                            for (var t = 0; t < a.length; t++)
                                                !function e(n, t) {
                                                    try {
                                                        if (t && ("object" == typeof t || "function" == typeof t)) {
                                                            var r = t.then;
                                                            if ("function" == typeof r)
                                                                return void r.call(t, function(t) {
                                                                    e(n, t)
                                                                }, i)
                                                        }
                                                        a[n] = t,
                                                        0 == --u && o(a)
                                                    } catch (t) {
                                                        i(t)
                                                    }
                                                }(t, a[t])
                                        }
                                    )
                                }
                                ,
                                i.resolve = function(e) {
                                    return e && "object" == typeof e && e.constructor === i ? e : new i(function(t) {
                                            t(e)
                                        }
                                    )
                                }
                                ,
                                i.reject = function(n) {
                                    return new i(function(t, e) {
                                            e(n)
                                        }
                                    )
                                }
                                ,
                                i.race = function(o) {
                                    return new i(function(t, e) {
                                            for (var n = 0, r = o.length; n < r; n++)
                                                o[n].then(t, e)
                                        }
                                    )
                                }
                                ,
                                i._immediateFn = "function" == typeof e ? function(t) {
                                        e(t)
                                    }
                                    : function(t) {
                                        n(t, 0)
                                    }
                                ,
                                i._unhandledRejectionFn = function(t) {
                                    "undefined" != typeof console && console && console.warn("Possible Unhandled Promise Rejection:", t)
                                }
                                ,
                                i._setImmediateFn = function(t) {
                                    i._immediateFn = t
                                }
                                ,
                                i._setUnhandledRejectionFn = function(t) {
                                    i._unhandledRejectionFn = t
                                }
                                ,
                                void 0 !== l && l.exports ? l.exports = i : t.Promise || (t.Promise = i)
                        }
                    ).call(this, t("timers").setImmediate)
                }
                    , {
                        timers: 3
                    }],
                3: [function(c, t, s) {
                    (function(t, e) {
                            var r = c("process/browser.js").nextTick
                                , n = Function.prototype.apply
                                , o = Array.prototype.slice
                                , i = {}
                                , u = 0;
                            function a(t, e) {
                                this._id = t,
                                    this._clearFn = e
                            }
                            s.setTimeout = function() {
                                return new a(n.call(setTimeout, window, arguments),clearTimeout)
                            }
                                ,
                                s.setInterval = function() {
                                    return new a(n.call(setInterval, window, arguments),clearInterval)
                                }
                                ,
                                s.clearTimeout = s.clearInterval = function(t) {
                                    t.close()
                                }
                                ,
                                a.prototype.unref = a.prototype.ref = function() {}
                                ,
                                a.prototype.close = function() {
                                    this._clearFn.call(window, this._id)
                                }
                                ,
                                s.enroll = function(t, e) {
                                    clearTimeout(t._idleTimeoutId),
                                        t._idleTimeout = e
                                }
                                ,
                                s.unenroll = function(t) {
                                    clearTimeout(t._idleTimeoutId),
                                        t._idleTimeout = -1
                                }
                                ,
                                s._unrefActive = s.active = function(t) {
                                    clearTimeout(t._idleTimeoutId);
                                    var e = t._idleTimeout;
                                    0 <= e && (t._idleTimeoutId = setTimeout(function() {
                                        t._onTimeout && t._onTimeout()
                                    }, e))
                                }
                                ,
                                s.setImmediate = "function" == typeof t ? t : function(t) {
                                    var e = u++
                                        , n = !(arguments.length < 2) && o.call(arguments, 1);
                                    return i[e] = !0,
                                        r(function() {
                                            i[e] && (n ? t.apply(null, n) : t.call(null),
                                                s.clearImmediate(e))
                                        }),
                                        e
                                }
                                ,
                                s.clearImmediate = "function" == typeof e ? e : function(t) {
                                    delete i[t]
                                }
                        }
                    ).call(this, c("timers").setImmediate, c("timers").clearImmediate)
                }
                    , {
                        "process/browser.js": 1,
                        timers: 3
                    }],
                4: [function(t, e, n) {
                    var r = t("promise-polyfill")
                        , t = "undefined" != typeof window ? window : Function("return this;")();
                    e.exports = {
                        boltExport: t.Promise || r
                    }
                }
                    , {
                        "promise-polyfill": 2
                    }]
            }, {}, [4])(4)
        });
    function zt(t) {
        setTimeout(function() {
            throw t
        }, 0)
    }
    function Yt(u, t) {
        return t(function(r) {
            var o = []
                , i = 0;
            0 === u.length ? r([]) : ct(u, function(t, e) {
                var n;
                t.get((n = e,
                        function(t) {
                            o[n] = t,
                            ++i >= u.length && r(o)
                        }
                ))
            })
        })
    }
    function qt(t, e) {
        return Zt(at(t, e))
    }
    function $t(t) {
        var e = (new Date).getTime();
        return t + "_" + Math.floor(1e9 * Math.random()) + ++te + String(e)
    }
    var Vt = Wt.exports.boltExport
        , Gt = function(t) {
        var n = G.none()
            , e = []
            , r = function(t) {
            o() ? u(t) : e.push(t)
        }
            , o = function() {
            return n.isSome()
        }
            , i = function(t) {
            ct(t, u)
        }
            , u = function(e) {
            n.each(function(t) {
                setTimeout(function() {
                    e(t)
                }, 0)
            })
        };
        return t(function(t) {
            o() || (n = G.some(t),
                i(e),
                e = [])
        }),
            {
                get: r,
                map: function(n) {
                    return Gt(function(e) {
                        r(function(t) {
                            e(n(t))
                        })
                    })
                },
                isReady: o
            }
    }
        , Kt = {
        nu: Gt,
        pure: function(e) {
            return Gt(function(t) {
                t(e)
            })
        }
    }
        , Xt = function(n) {
        function t(t) {
            n().then(t, zt)
        }
        return {
            map: function(t) {
                return Xt(function() {
                    return n().then(t)
                })
            },
            bind: function(e) {
                return Xt(function() {
                    return n().then(function(t) {
                        return e(t).toPromise()
                    })
                })
            },
            anonBind: function(t) {
                return Xt(function() {
                    return n().then(function() {
                        return t.toPromise()
                    })
                })
            },
            toLazy: function() {
                return Kt.nu(t)
            },
            toCached: function() {
                var t = null;
                return Xt(function() {
                    return null === t && (t = n()),
                        t
                })
            },
            toPromise: n,
            get: t
        }
    }
        , Jt = {
        nu: function(t) {
            return Xt(function() {
                return new Vt(t)
            })
        },
        pure: function(t) {
            return Xt(function() {
                return Vt.resolve(t)
            })
        }
    }
        , Zt = function(t) {
        return Yt(t, Jt.nu)
    }
        , Qt = qt
        , te = 0;
    function ee(t, e) {
        return n = document.createElement("canvas"),
            t = t,
            e = e,
            n.width = t,
            n.height = e,
            n;
        var n
    }
    function ne(t) {
        var e = ee(t.width, t.height);
        return re(e).drawImage(t, 0, 0),
            e
    }
    function re(t) {
        return t.getContext("2d")
    }
    var oe, ie, ue, ae = window.Promise || (oe = window,
        ie = ce.immediateFn || "function" == typeof oe.setImmediate && oe.setImmediate || function(t) {
            setTimeout(t, 1)
        }
        ,
        ue = Array.isArray || function(t) {
            return "[object Array]" === Object.prototype.toString.call(t)
        }
        ,
        ce.prototype.catch = function(t) {
            return this.then(null, t)
        }
        ,
        ce.prototype.then = function(n, r) {
            var o = this;
            return new ce(function(t, e) {
                    fe.call(o, new pe(n,r,t,e))
                }
            )
        }
        ,
        ce.all = function() {
            for (var t = [], e = 0; e < arguments.length; e++)
                t[e] = arguments[e];
            var a = Array.prototype.slice.call(1 === t.length && ue(t[0]) ? t[0] : t);
            return new ce(function(o, i) {
                    if (0 === a.length)
                        return o([]);
                    var u = a.length;
                    for (var t = 0; t < a.length; t++)
                        !function e(n, t) {
                            try {
                                if (t && ("object" == typeof t || "function" == typeof t)) {
                                    var r = t.then;
                                    if ("function" == typeof r)
                                        return void r.call(t, function(t) {
                                            e(n, t)
                                        }, i)
                                }
                                a[n] = t,
                                0 == --u && o(a)
                            } catch (t) {
                                i(t)
                            }
                        }(t, a[t])
                }
            )
        }
        ,
        ce.resolve = function(e) {
            return e && "object" == typeof e && e.constructor === ce ? e : new ce(function(t) {
                    t(e)
                }
            )
        }
        ,
        ce.reject = function(n) {
            return new ce(function(t, e) {
                    e(n)
                }
            )
        }
        ,
        ce.race = function(o) {
            return new ce(function(t, e) {
                    for (var n = 0, r = o; n < r.length; n++) {
                        r[n].then(t, e)
                    }
                }
            )
        }
        ,
        ce);
    function ce(t) {
        if ("object" != typeof this)
            throw new TypeError("Promises must be constructed via new");
        if ("function" != typeof t)
            throw new TypeError("not a function");
        this._state = null,
            this._value = null,
            this._deferreds = [],
            ge(t, se(le, this), se(de, this))
    }
    function se(t, e) {
        return function() {
            return t.apply(e, arguments)
        }
    }
    function fe(n) {
        var r = this;
        null !== this._state ? ie(function() {
            var t, e = r._state ? n.onFulfilled : n.onRejected;
            if (null !== e) {
                try {
                    t = e(r._value)
                } catch (t) {
                    return void n.reject(t)
                }
                n.resolve(t)
            } else
                (r._state ? n.resolve : n.reject)(r._value)
        }) : this._deferreds.push(n)
    }
    function le(t) {
        try {
            if (t === this)
                throw new TypeError("A promise cannot be resolved with itself.");
            if (t && ("object" == typeof t || "function" == typeof t)) {
                var e = t.then;
                if ("function" == typeof e)
                    return void ge(se(e, t), se(le, this), se(de, this))
            }
            this._state = !0,
                this._value = t,
                me.call(this)
        } catch (t) {
            de.call(this, t)
        }
    }
    function de(t) {
        this._state = !1,
            this._value = t,
            me.call(this)
    }
    function me() {
        for (var t = 0, e = this._deferreds; t < e.length; t++) {
            var n = e[t];
            fe.call(this, n)
        }
        this._deferreds = []
    }
    function pe(t, e, n, r) {
        this.onFulfilled = "function" == typeof t ? t : null,
            this.onRejected = "function" == typeof e ? e : null,
            this.resolve = n,
            this.reject = r
    }
    function ge(t, e, n) {
        var r = !1;
        try {
            t(function(t) {
                r || (r = !0,
                    e(t))
            }, function(t) {
                r || (r = !0,
                    n(t))
            })
        } catch (t) {
            if (r)
                return;
            r = !0,
                n(t)
        }
    }
    function ve(r) {
        return new ae(function(t, n) {
                var e = new XMLHttpRequest;
                e.open("GET", r, !0),
                    e.responseType = "blob",
                    e.onload = function() {
                        200 === this.status && t(this.response)
                    }
                    ,
                    e.onerror = function() {
                        var t, e = this;
                        n(0 === this.status ? ((t = new Error("No access to download image")).code = 18,
                            t.name = "SecurityError",
                            t) : new Error("Error " + e.status + " downloading image"))
                    }
                    ,
                    e.send()
            }
        )
    }
    function he(t) {
        var e = t.split(",")
            , t = /data:([^;]+)/.exec(e[0]);
        if (!t)
            return G.none();
        for (var t = t[1], e = e[1], n = atob(e), r = n.length, o = Math.ceil(r / 1024), i = new Array(o), u = 0; u < o; ++u) {
            for (var a = 1024 * u, c = Math.min(1024 + a, r), s = new Array(c - a), f = a, l = 0; f < c; ++l,
                ++f)
                s[l] = n[f].charCodeAt(0);
            i[u] = new Uint8Array(s)
        }
        return G.some(new Blob(i,{
            type: t
        }))
    }
    function ye(n) {
        return new ae(function(t, e) {
                he(n).fold(function() {
                    e("uri is not base64: " + n)
                }, t)
            }
        )
    }
    function be(t, r, o) {
        return r = r || "image/png",
            et(HTMLCanvasElement.prototype.toBlob) ? new ae(function(e, n) {
                    t.toBlob(function(t) {
                        t ? e(t) : n()
                    }, r, o)
                }
            ) : ye(t.toDataURL(r, o))
    }
    function xe(t) {
        return a = t,
            new ae(function(t, e) {
                    var n = URL.createObjectURL(a)
                        , r = new Image
                        , o = function() {
                        r.removeEventListener("load", i),
                            r.removeEventListener("error", u)
                    };
                    function i() {
                        o(),
                            t(r)
                    }
                    function u() {
                        o(),
                            e("Unable to load data of type " + a.type + ": " + n)
                    }
                    r.addEventListener("load", i),
                        r.addEventListener("error", u),
                        r.src = n,
                    r.complete && i()
                }
            ).then(function(t) {
                e = t,
                    URL.revokeObjectURL(e.src);
                var e, e = ee((e = t).naturalWidth || e.width, (e = t).naturalHeight || e.height);
                return re(e).drawImage(t, 0, 0),
                    e
            });
        var a
    }
    function Te(n) {
        return new ae(function(t) {
                var e = new FileReader;
                e.onloadend = function() {
                    t(e.result)
                }
                    ,
                    e.readAsDataURL(n)
            }
        )
    }
    function we(t) {
        return G.from(0 === (t = t).indexOf("blob:") ? ve(t) : 0 === t.indexOf("data:") ? ye(t) : null)
    }
    var Ee = Te
        , Se = he;
    function Ae(t, e, n) {
        var r = e.type;
        function o(r, o) {
            return t.then(function(t) {
                return n = o,
                    e = (e = r) || "image/png",
                    t.toDataURL(e, n);
                var e, n
            })
        }
        return {
            getType: l(r),
            toBlob: function() {
                return ae.resolve(e)
            },
            toDataURL: l(n),
            toBase64: function() {
                return n.split(",")[1]
            },
            toAdjustedBlob: function(e, n) {
                return t.then(function(t) {
                    return be(t, e, n)
                })
            },
            toAdjustedDataURL: o,
            toAdjustedBase64: function(t, e) {
                return o(t, e).then(function(t) {
                    return t.split(",")[1]
                })
            },
            toCanvas: function() {
                return t.then(ne)
            }
        }
    }
    function Ie(t) {
        return (0 === (t = (t = t).src).indexOf("data:") ? ye : ve)(t).then(function(t) {
            return Te(e = t).then(function(t) {
                return Ae(xe(e), e, t)
            });
            var e
        })
    }
    function _e(t, e) {
        return e = e,
            Ae(xe(t = t), t, e)
    }
    function Le(t, e, n) {
        return void 0 === e && void 0 === n ? Ze(t) : t.toAdjustedBlob(e, n)
    }
    function Oe(t) {
        var e = URL.createObjectURL(t);
        return tn(t, e)
    }
    function De(t, e) {
        return function(t, e) {
            for (var n = null != e ? e : nn, r = 0; r < t.length && null != n; ++r)
                n = n[t[r]];
            return n
        }(t.split("."), e)
    }
    function Ne(t, e) {
        return function(t, e) {
            for (var n, r, o = void 0 !== e ? e : nn, i = 0; i < t.length; ++i)
                n = o,
                    r = t[i],
                void 0 !== n[r] && null !== n[r] || (n[r] = {}),
                    o = n[r];
            return o
        }(t.split("."), e)
    }
    function Ce(t) {
        return t.dom.nodeName.toLowerCase()
    }
    function Pe(t) {
        return t.dom.nodeType
    }
    function ke(e) {
        return function(t) {
            return un(t) && Ce(t) === e
        }
    }
    function Re(t, e, n) {
        if (!(J(n) || tt(n) || nt(n)))
            throw console.error("Invalid call to Attribute.set. Key ", e, ":: Value ", n, ":: Element ", t),
                new Error("Attribute value was not simple");
        t.setAttribute(e, n + "")
    }
    function Me(t, e) {
        var n = t.dom;
        R(e, function(t, e) {
            Re(n, e, t)
        })
    }
    function Fe(t, e) {
        return G.from(ln(t, e))
    }
    function je(t, e) {
        return !(!(t = t.dom) || !t.hasAttribute) && t.hasAttribute(e)
    }
    function Ue(t, e) {
        t.dom.removeAttribute(e)
    }
    function He(t, e, n) {
        return e = function(t, e) {
            if (t && "string" != typeof t)
                return t;
            switch (t) {
                case "clean":
                    return bn;
                case "merge":
                    return xn;
                default:
                    return e
            }
        }(t, e),
            e = yn.extend(e, {
                base_64_images: n
            })
    }
    function Be(t) {
        return t.replace(/-(.)/g, function(t, e) {
            return e.toUpperCase()
        })
    }
    function We(o, t, e) {
        var i, n, r, u, a, c, s, f;
        switch (o.nodeType) {
            case 1:
                t ? i = En : (i = wn,
                    u = In(o),
                    a = {},
                    d = o,
                    c = function(t, e) {
                        a[t] = e
                    }
                    ,
                null != (e = (e = e) || d.getAttribute("style")) && e.split || (e = d.style.cssText),
                    yn.each(e.split(";"), function(t) {
                        var e = t.indexOf(":");
                        0 < e && ((s = yn.trim(t.substring(0, e))).toUpperCase() === s && (s = s.toLowerCase()),
                            s = s.replace(/([A-Z])/g, function(t, e) {
                                return "-" + e.toLowerCase()
                            }),
                            f = yn.trim(t.substring(e + 1)),
                            _n = _n || 0 === s.indexOf("mso-"),
                            c(s, f))
                    }),
                _n || (f = d.style["mso-list"]) && c("mso-list", f)),
                    n = "HTML" !== o.scopeName && o.scopeName && o.tagName && o.tagName.indexOf(":") <= 0 ? (o.scopeName + ":" + o.tagName).toUpperCase() : o.tagName;
                break;
            case 3:
                i = Sn,
                    r = o.nodeValue;
                break;
            case 8:
                i = An,
                    r = o.nodeValue;
                break;
            default:
                yn.log("WARNING: Unsupported node type encountered: " + o.nodeType)
        }
        function l(t) {
            i === wn && u.filter(t)
        }
        var d = function() {
            return i
        };
        return {
            getNode: function() {
                return u && u.getAttributes(),
                    o
            },
            tag: function() {
                return n
            },
            type: d,
            text: function() {
                return r
            },
            toString: function() {
                return "Type: " + i + ", Tag: " + n + " Text: " + r
            },
            getAttribute: function(t) {
                return u.get(t.toLowerCase())
            },
            filterAttributes: l,
            filterStyles: function(n) {
                var r;
                i === wn && (r = "",
                    yn.each(a, function(t, e) {
                        t = n(e, t);
                        null === t ? (o.style.removeProperty ? o.style.removeProperty(Be(e)) : o.style.removeAttribute(Be(e)),
                            delete a[e]) : (r += e + ": " + t + "; ",
                            a[e] = t)
                    }),
                    r = r || null,
                    l(function(t, e) {
                        return "style" === t ? r : e
                    }),
                    o.style.cssText = r)
            },
            getAttributeCount: function() {
                return u.getAttributeCount()
            },
            attributes: function(t) {
                u.each(t)
            },
            getStyle: function(t) {
                return a[t]
            },
            styles: function(n) {
                yn.each(a, function(t, e) {
                    n(e, t)
                })
            },
            getComputedStyle: function() {
                return yn.ephoxGetComputedStyle(o)
            },
            isWhitespace: function() {
                return i === Sn && /^[\s\u00A0]*$/.test(r)
            }
        }
    }
    function ze(p, g) {
        return function(e, t, n) {
            function r() {
                g && g(m),
                    s = !1,
                    a = [],
                    c = []
            }
            function o(t) {
                yn.each(t, function(t) {
                    e.receive(t)
                })
            }
            function i(t) {
                s ? c.push(t) : e.receive(t)
            }
            var u, a, c, s = !1, f = function() {
                l(),
                    o(c),
                    r()
            }, l = function() {
                yn.each(u, function(t) {
                    i(t)
                }),
                    d()
            }, d = function() {
                u = []
            }, m = {
                document: n || window.document,
                settings: t || {},
                emit: i,
                receive: function(t) {
                    g && a.push(t),
                        p(m, t),
                    t === Dn.FINISHED && f()
                },
                startTransaction: function() {
                    s = !0
                },
                rollback: function() {
                    o(a),
                        r()
                },
                commit: f,
                defer: function(t) {
                    (u = u || []).push(t)
                },
                hasDeferred: function() {
                    return u && 0 < u.length
                },
                emitDeferred: l,
                dropDeferred: d
            };
            return r(),
                m
        }
    }
    function Ye() {
        return null
    }
    function qe(t) {
        if (qn)
            for (var e = void 0, n = zn.length, r = void 0, r = 0; r < n; r++)
                (e = zn[r]) && (e.type() === Dn.START_ELEMENT_TYPE && "SPAN" === e.tag() && Un(e) ? function(t, e) {
                    for (var n, r = 1, o = e + 1; o < t; o++)
                        if ((n = zn[o]) && "SPAN" === n.tag())
                            if (n.type() === Dn.START_ELEMENT_TYPE)
                                r++;
                            else if (n.type() === Dn.END_ELEMENT_TYPE && 0 === --r)
                                return zn[o] = null
                }(n, r) : t.emit(e));
        zn = [],
            qn = !(Yn = [])
    }
    function $e(t, e) {
        zn.push(e),
            Yn = Yn || [],
            e.type() === Dn.START_ELEMENT_TYPE ? Yn.push(e) : e.type() === Dn.END_ELEMENT_TYPE && (Yn.pop(),
            0 === Yn.length && qe(t))
    }
    function Ve(t) {
        return !Un(t) && !/^OLE_LINK/.test(t.getAttribute("name"))
    }
    function Ge(t, e) {
        return e = {
            tag: t.tag,
            type: t.type,
            variant: e
        },
        t.start && (e.start = t.start),
        t.type || delete e.type,
            e
    }
    var Ke, Xe, Je = Ie, Ze = function(t) {
        return t.toBlob()
    }, Qe = function(t) {
        return t.toDataURL()
    }, tn = function(r, o) {
        return Jt.nu(function(n) {
            Ee(r).then(function(t) {
                var e = _e(r, t)
                    , t = $t("image")
                    , e = Ht.blob(t, e, o);
                n(e)
            })
        })
    }, en = function(t) {
        return qt(t, Oe)
    }, nn = "undefined" != typeof window ? window : Function("return this;")(), rn = function(e) {
        return function(t) {
            return Pe(t) === e
        }
    }, on = function(t) {
        return 8 === Pe(t) || "#comment" === Ce(t)
    }, un = rn(1), an = rn(3), cn = rn(9), sn = rn(11), fn = function(t, e, n) {
        Re(t.dom, e, n)
    }, ln = function(t, e) {
        e = t.dom.getAttribute(e);
        return null === e ? void 0 : e
    }, dn = function(t) {
        if (null == t)
            throw new Error("Node cannot be null or undefined");
        return {
            dom: t
        }
    }, mn = {
        fromHtml: function(t, e) {
            e = (e || document).createElement("div");
            if (e.innerHTML = t,
            !e.hasChildNodes() || 1 < e.childNodes.length)
                throw console.error("HTML does not have a single root node", t),
                    new Error("HTML must have a single root node");
            return dn(e.childNodes[0])
        },
        fromTag: function(t, e) {
            t = (e || document).createElement(t);
            return dn(t)
        },
        fromText: function(t, e) {
            t = (e || document).createTextNode(t);
            return dn(t)
        },
        fromDom: dn,
        fromPoint: function(t, e, n) {
            return G.from(t.dom.elementFromPoint(e, n)).map(dn)
        }
    }, pn = function() {
        return 'Safari does not support direct paste of images. <a href="https://support.ephox.com/entries/88543243-Safari-Direct-paste-of-images-does-not-work" style="text-decoration: underline">More information on image pasting for Safari</a>'
    }, gn = {
        "cement.dialog.paste.title": "Paste Formatting Options",
        "cement.dialog.paste.instructions": "Choose to keep or remove formatting in the pasted content.",
        "cement.dialog.paste.merge": "Keep Formatting",
        "cement.dialog.paste.clean": "Remove Formatting",
        "safari.imagepaste": pn(),
        "webview.imagepaste": pn(),
        "error.code.images.not.found": "The images service was not found: (",
        "error.imageupload": "Image failed to upload: (",
        "error.full.stop": ").",
        "errors.local.images.disallowed": "Local image paste has been disabled. Local images have been removed from pasted content.",
        "errors.imageimport.failed": "Some images failed to import.",
        "errors.imageimport.unsupported": "Unsupported image type.",
        "errors.imageimport.invalid": "Image is invalid."
    }, vn = function(t) {
        return tinymce.translate(gn[t])
    }, hn = {
        insert: function(t, e) {
            var n, r = e.getDoc(), o = "ephoxInsertMarker", i = e.selection, u = e.dom;
            i.setContent('<span id="' + o + '">&nbsp;</span>'),
                n = u.get(o);
            for (var a = r.createDocumentFragment(); t.firstChild && !u.isBlock(t.firstChild); )
                a.appendChild(t.firstChild);
            for (var c = r.createDocumentFragment(); t.lastChild && !u.isBlock(t.lastChild); )
                c.appendChild(t.lastChild);
            if (n.parentNode.insertBefore(a, n),
                u.insertAfter(c, n),
                t.firstChild) {
                if (u.isBlock(t.firstChild)) {
                    for (; !u.isBlock(n.parentNode) && n.parentNode !== u.getRoot(); )
                        n = u.split(n.parentNode, n);
                    u.is(n.parentNode, "td,th") || n.parentNode === u.getRoot() || (n = u.split(n.parentNode, n))
                }
                u.replace(t, n)
            } else
                u.remove(n)
        }
    }, yn = {
        each: tinymce.each,
        trim: tinymce.trim,
        bind: function(t, e) {
            return function() {
                return t.apply(e, arguments)
            }
        },
        extend: function(n) {
            for (var t = [], e = 1; e < arguments.length; e++)
                t[e - 1] = arguments[e];
            return tinymce.each(Array.prototype.slice.call(arguments, 1), function(t) {
                for (var e in t)
                    n[e] = t[e]
            }),
                n
        },
        ephoxGetComputedStyle: function(t) {
            return t.ownerDocument.defaultView ? t.ownerDocument.defaultView.getComputedStyle(t, null) : t.currentStyle || {}
        },
        log: function(t) {
            "undefined" != typeof console && console.log && console.log(t)
        },
        compose: function(t) {
            var r = Array.prototype.slice.call(t).reverse();
            return function(t) {
                for (var e = t, n = 0; n < r.length; n++)
                    e = (0,
                        r[n])(e);
                return e
            }
        }
    }, bn = {
        strip_class_attributes: "all",
        retain_style_properties: "none"
    }, xn = {
        strip_class_attributes: "none",
        retain_style_properties: "valid"
    }, Tn = {
        create: function(t, e, n) {
            var r = He(t, bn, n)
                , o = He(e, xn, n)
                , i = o;
            return {
                setWordContent: function(t) {
                    i = t ? r : o
                },
                get: function(t) {
                    return i[t]
                }
            }
        }
    }, wn = "startElement", En = "endElement", Sn = "text", An = "comment", In = function(o) {
        function e() {
            return i
        }
        var i, u, a, c = 0, s = function() {
            return i = {},
                c = 0,
                yn.each(o.attributes, function(t) {
                    var e = t.nodeName
                        , n = t.value;
                    !1 === (t = t).specified && ("name" !== t.nodeName || "" === t.value) || null != n && (i[e] = n,
                        c++)
                }),
            void 0 === i.style && o.style.cssText && (i.style = o.style.cssText,
                c++),
                s = e,
                i
        }, f = function(n) {
            yn.each(s(), function(t, e) {
                n(e, t)
            })
        };
        return {
            get: function(t) {
                return s()[t]
            },
            each: f,
            filter: function(t) {
                var n, r;
                u || (a = s),
                    r = t,
                    u = (n = u) && r ? function(t, e) {
                            return r(t, n(t, e))
                        }
                        : n || r,
                    s = function() {
                        return s = a,
                            f(function(t, e) {
                                var n = u(t, e);
                                null === n ? (o.removeAttribute(t),
                                    delete i[t],
                                    c--) : n !== e && ("class" === t ? o.className = n : o.setAttribute(t, n),
                                    i[t] = n)
                            }),
                            s = e,
                            i
                    }
            },
            getAttributes: function() {
                return s()
            },
            getAttributeCount: function() {
                return s(),
                    c
            }
        }
    }, _n = !1, Ln = function(t, e) {
        return We(e.createElement(t), !0)
    }, On = Ln("HTML", window.document), Dn = {
        START_ELEMENT_TYPE: wn,
        END_ELEMENT_TYPE: En,
        TEXT_TYPE: Sn,
        COMMENT_TYPE: An,
        FINISHED: On,
        token: We,
        createStartElement: function(t, e, n, r) {
            var o = r.createElement(t)
                , i = "";
            return yn.each(e, function(t, e) {
                o.setAttribute(e, t)
            }),
                yn.each(n, function(t, e) {
                    i += e + ":" + t + ";",
                        o.style[Be(e)] = t
                }),
                We(o, !1, "" !== i ? i : null)
        },
        createEndElement: Ln,
        createComment: function(t, e) {
            return We(e.createComment(t), !1)
        },
        createText: function(t, e) {
            return We(e.createTextNode(t))
        }
    }, Nn = function(e) {
        var n = e.createDocumentFragment()
            , r = function(t) {
            n.appendChild(t)
        };
        return {
            dom: n,
            receive: function(t) {
                switch (t.type()) {
                    case Dn.START_ELEMENT_TYPE:
                        !function(t) {
                            t = t.getNode().cloneNode(!1);
                            r(t = t),
                                n = t
                        }(t);
                        break;
                    case Dn.TEXT_TYPE:
                        !function(t) {
                            t = e.createTextNode(t.text());
                            r(t)
                        }(t);
                        break;
                    case Dn.END_ELEMENT_TYPE:
                        n = n.parentNode;
                        break;
                    case Dn.COMMENT_TYPE:
                        break;
                    default:
                        throw {
                            message: "Unsupported token type: " + t.type()
                        }
                }
            }
        }
    }, Cn = function(t, n) {
        var r;
        n = n || window.document,
            r = n.createElement("div"),
            n.body.appendChild(r),
            r.style.position = "absolute",
            r.style.left = "-10000px",
            r.innerHTML = t;
        var o = r.firstChild || Dn.FINISHED
            , i = []
            , u = !1;
        return {
            hasNext: function() {
                return void 0 !== o
            },
            next: function() {
                var t = o
                    , e = u;
                return !u && o.firstChild ? (i.push(o),
                    o = o.firstChild) : u = !u && 1 === o.nodeType || (o.nextSibling ? (o = o.nextSibling,
                    !1) : (o = i.pop(),
                    !0)),
                t === Dn.FINISHED || o || (n.body.removeChild(r),
                    o = Dn.FINISHED),
                    e = e,
                    (t = t) === Dn.FINISHED ? t : t ? Dn.token(t, e) : void 0
            }
        }
    }, Pn = ze, t = function(n) {
        return ze(function(t, e) {
            e.filterAttributes(yn.bind(n, t)),
                t.emit(e)
        })
    }, kn = /^(P|H[1-6]|T[DH]|LI|DIV|BLOCKQUOTE|PRE|ADDRESS|FIELDSET|DD|DT|CENTER)$/, Rn = !1, Mn = Pn(function(t, e) {
        function n() {
            Rn || (t.emit(Dn.createStartElement("P", {}, {}, t.document)),
                Rn = !0)
        }
        var r;
        switch (e.type()) {
            case Dn.TEXT_TYPE:
                n(),
                    t.emit(e);
                break;
            case Dn.END_ELEMENT_TYPE:
                Rn && (r = e,
                kn.test(r.tag()) || e === Dn.FINISHED) ? (t.emit(Dn.createEndElement("P", t.document)),
                    Rn = !1) : "BR" === e.tag() && t.emit(e);
                break;
            case Dn.START_ELEMENT_TYPE:
                "BR" === e.tag() ? (e.filterAttributes(Ye),
                    e.filterStyles(Ye),
                    t.emit(e)) : "IMG" === e.tag() && e.getAttribute("alt") && (n(),
                    t.emit(Dn.createText(e.getAttribute("alt"), t.document)))
        }
        e === Dn.FINISHED && t.emit(e)
    }), g = function(t) {
        var e = t;
        return 65279 === e.charCodeAt(e.length - 1) ? e.substring(0, e.length - 1) : t
    }, K = [g], X = tinymce.isIE && 9 <= document.documentMode ? [function(t) {
        return t.replace(/<BR><BR>/g, "<br>")
    }
        , function(t) {
            return t.replace(/<br>/g, " ")
        }
        , function(t) {
            return t.replace(/<br><br>/g, "<BR><BR>")
        }
        , function(t) {
            return /<(h[1-6r]|p|div|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|blockquote|center|dl|dt|dd|dir|fieldset)/.test(t) ? t.replace(/(?:<br>&nbsp;[\s\r\n]+|<br>)*(<\/?(h[1-6r]|p|div|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|blockquote|center|dl|dt|dd|dir|fieldset)[^>]*>)(?:<br>&nbsp;[\s\r\n]+|<br>)*/g, "$1") : t
        }
    ].concat(K) : K, Fn = {
        all: yn.compose(X),
        textOnly: g
    }, jn = /^(mso-.*|tab-stops|tab-interval|language|text-underline|text-effect|text-line-through|font-color|horiz-align|list-image-[0-9]+|separator-image|table-border-color-(dark|light)|vert-align|vnd\..*)$/, Ut = Pn(function(t, e) {
        var r, n = t.settings.get("retain_style_properties");
        e.filterStyles((r = n,
                function(t, e) {
                    var n = !1;
                    switch (r) {
                        case "all":
                        case "*":
                            n = !0;
                            break;
                        case "valid":
                            n = !jn.test(t);
                            break;
                        case void 0:
                        case "none":
                            n = "list-style-type" === t;
                            break;
                        default:
                            n = 0 <= ("," + r + ",").indexOf("," + t + ",")
                    }
                    return n ? e : null
                }
        )),
            t.emit(e)
    }), Bt = Pn(function(t, e) {
        t.seenList || (t.inferring ? "LI" === e.tag() && (e.type() === Dn.START_ELEMENT_TYPE ? t.inferring++ : (t.inferring--,
        t.inferring || (t.needsClosing = !0))) : ("OL" === e.tag() || "UL" === e.tag() ? t.seenList = !0 : "LI" === e.tag() && (t.inferring = 1,
        t.needsClosing || t.emit(Dn.createStartElement("UL", {}, {}, t.document))),
        !t.needsClosing || t.inferring || e.isWhitespace() || (t.needsClosing = !1,
            t.emit(Dn.createEndElement("UL", t.document))))),
            t.emit(e)
    }), Wt = t(function(t, e) {
        return "name" === t || "id" === t ? null : e
    }), rn = t(function(t, e) {
        if ("class" === t)
            switch (this.settings.get("strip_class_attributes")) {
                case "mso":
                    return 0 === e.indexOf("Mso") ? null : e;
                case "none":
                    return e;
                default:
                    return null
            }
        return e
    }), pn = function() {
        if (0 < navigator.userAgent.indexOf("Gecko") && navigator.userAgent.indexOf("WebKit") < 0)
            return !1;
        var t = document.createElement("div");
        try {
            t.innerHTML = '<p style="mso-list: Ignore;">&nbsp;</p>'
        } catch (t) {
            return !1
        }
        return "Ignore" === Dn.token(t.firstChild).getStyle("mso-list")
    }(), Un = function(t, e) {
        return t.type() === Dn.START_ELEMENT_TYPE ? 0 === t.getAttributeCount() || e && 1 === t.getAttributeCount() && null !== t.getAttribute("style") && void 0 !== t.getAttribute("style") : t.type() === Dn.END_ELEMENT_TYPE
    }, Hn = pn, Bn = function(t) {
        return "A" === t.tag() || "SPAN" === t.tag()
    }, Wn = function(t) {
        t = t.getStyle("mso-list");
        return t && "skip" !== t
    }, zn = [], Yn = [], qn = !1, On = Pn(function(t, e) {
        function n(t) {
            return !(0 <= ",FONT,EM,STRONG,SAMP,ACRONYM,CITE,CODE,DFN,KBD,TT,B,I,U,S,SUB,SUP,INS,DEL,VAR,SPAN,".indexOf("," + t.tag() + ",") && Un(t, !0))
        }
        0 === (zn = zn || []).length ? e.type() !== Dn.START_ELEMENT_TYPE || n(e) ? t.emit(e) : $e(t, e) : (qn = qn || n(e),
            $e(t, e))
    }), Ln = t(function(t, e) {
        return "style" === t && "" === e ? null : e
    }), K = t(function(t, e) {
        return "lang" === t ? null : e
    }), X = Pn(function(t, e) {
        if ("IMG" === e.tag()) {
            if (e.type() === Dn.END_ELEMENT_TYPE && t.skipEnd)
                return void (t.skipEnd = !1);
            if (e.type() === Dn.START_ELEMENT_TYPE) {
                if (/^file:/.test(e.getAttribute("src")))
                    return void (t.skipEnd = !0);
                if (t.settings.get("base_64_images") && /^data:image\/.*;base64/.test(e.getAttribute("src")))
                    return void (t.skipEnd = !0)
            }
        }
        t.emit(e)
    }), g = Pn(function(t, e) {
        "META" !== e.tag() && "LINK" !== e.tag() && t.emit(e)
    }), $n = [], pn = Pn(function(t, e) {
        var n;
        e.type() === Dn.START_ELEMENT_TYPE && "A" === e.tag() ? ($n.push(e),
        Ve(e) && t.defer(e)) : e.type() === Dn.END_ELEMENT_TYPE && "A" === e.tag() ? (n = $n.pop(),
        Ve(n) && t.defer(e),
        0 === $n.length && t.emitDeferred()) : t.hasDeferred() ? t.defer(e) : t.emit(e)
    }), Vn = !1, Gn = [Pn(function(t, e) {
        "SCRIPT" === e.tag() ? Vn = e.type() === Dn.START_ELEMENT_TYPE : Vn || (e.filterAttributes(function(t, e) {
            return /^on/.test(t) || "language" === t ? null : e
        }),
            t.emit(e))
    }), Wt, X, Ut, K, Ln, rn, pn, On, g, Bt], pn = Pn(function(t, n) {
        n.filterAttributes(function(t, e) {
            return "align" !== t && ("UL" !== n.tag() && "OL" !== n.tag() || "type" !== t) ? e : null
        }),
            t.emit(n)
    }), On = t(function(t, e) {
        return /^xmlns(:|$)/.test(t) ? null : e
    }), g = Pn(function(t, e) {
        e.tag && /^([OVWXP]|U[0-9]+|ST[0-9]+):/.test(e.tag()) || t.emit(e)
    }), Bt = t(function(t, e) {
        return "href" === t && (0 <= e.indexOf("#_Toc") || 0 <= e.indexOf("#_mso")) ? null : e
    }), t = t(function(t, e) {
        return /^v:/.test(t) ? null : e
    }), Kn = [{
        regex: /^\(?[dc][\.\)]$/,
        type: {
            tag: "OL",
            type: "lower-alpha"
        }
    }, {
        regex: /^\(?[DC][\.\)]$/,
        type: {
            tag: "OL",
            type: "upper-alpha"
        }
    }, {
        regex: /^\(?M*(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})[\.\)]$/,
        type: {
            tag: "OL",
            type: "upper-roman"
        }
    }, {
        regex: /^\(?m*(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})[\.\)]$/,
        type: {
            tag: "OL",
            type: "lower-roman"
        }
    }, {
        regex: /^\(?[0-9]+[\.\)]$/,
        type: {
            tag: "OL"
        }
    }, {
        regex: /^([0-9]+\.)*[0-9]+\.?$/,
        type: {
            tag: "OL",
            variant: "outline"
        }
    }, {
        regex: /^\(?[a-z]+[\.\)]$/,
        type: {
            tag: "OL",
            type: "lower-alpha"
        }
    }, {
        regex: /^\(?[A-Z]+[\.\)]$/,
        type: {
            tag: "OL",
            type: "upper-alpha"
        }
    }], Xn = {
        "\u2022": {
            tag: "UL",
            type: "disc"
        },
        "\xb7": {
            tag: "UL",
            type: "disc"
        },
        "\xa7": {
            tag: "UL",
            type: "square"
        }
    }, Jn = {
        o: {
            tag: "UL",
            type: "circle"
        },
        "-": {
            tag: "UL",
            type: "disc"
        },
        "\u25cf": {
            tag: "UL",
            type: "disc"
        }
    }, Zn = function(t, e, n) {
        return t === e || t && e && t.tag === e.tag && t.type === e.type && (n || t.variant === e.variant)
    }, Qn = {
        guessListType: function(t, e, n) {
            var r, o, i = null;
            return t && (r = t.text,
                o = t.symbolFont),
                r = yn.trim(r),
                (i = Jn[r]) ? i = Ge(i, r) : o ? i = (i = Xn[r]) ? Ge(i, r) : {
                    tag: "UL",
                    variant: r
                } : (yn.each(Kn, function(t) {
                    if (t.regex.test(r)) {
                        if (e && Zn(t.type, e, !0))
                            return (i = t.type).start = parseInt(r, 10),
                                !1;
                        (i = i || t.type).start = parseInt(r, 10)
                    }
                }),
                i && !i.variant && (o = "(" === r.charAt(0) ? "()" : ")" === r.charAt(r.length - 1) ? ")" : ".",
                    i = Ge(i, o))),
            i && "OL" === i.tag && n && ("P" !== n.tag() || /^MsoHeading/.test(n.getAttribute("class"))) && (i = null),
                i
        },
        eqListType: Zn,
        checkFont: function(t, e) {
            var n;
            return t.type() === Dn.START_ELEMENT_TYPE && ((n = t.getStyle("font-family")) ? e = "Wingdings" === n || "Symbol" === n : /^(P|H[1-6]|DIV)$/.test(t.tag()) && (e = !1)),
                e
        }
    }, tr = (Ke = function(t, e) {
            var n, r = /([^{]+){([^}]+)}/g;
            for (r.lastIndex = 0; null !== (n = r.exec(t)); )
                yn.each(n[1].split(","), function(t) {
                    var e = t.indexOf(".");
                    if (0 <= e && void 0 === yn.trim(t.substring(e + 1)))
                        return (void 0)[2],
                            !1
                }(void 0));
            return !1
        }
            ,
            Xe = {},
            function(t, e) {
                var n = t + "," + e;
                return Xe.hasOwnProperty(n) ? Xe[n] : (e = Ke.call(null, t, e),
                    Xe[n] = e)
            }
    ), er = function(t, e) {
        function n(t) {
            (t = t.style.fontFamily) && (o = "Wingdings" === t || "Symbol" === t)
        }
        var r, o = !1;
        if (t.type() === Dn.START_ELEMENT_TYPE && e.openedTag && "SPAN" === t.tag()) {
            for (n(r = e.openedTag.getNode()),
                 1 < r.childNodes.length && "A" === r.firstChild.tagName && "" === r.firstChild.textContent && (r = r.childNodes[1]); r.firstChild && ("SPAN" === r.firstChild.tagName || "A" === r.firstChild.tagName); )
                n(r = r.firstChild);
            if (!(r = r.firstChild) || 3 !== r.nodeType)
                return r && "IMG" === r.tagName;
            if (t = r.value,
            yn.trim(t) || (t = (r = r.parentNode.nextSibling) ? r.value : ""),
            !r || yn.trim(r.parentNode.textContent) != t)
                return !1;
            if (t = Qn.guessListType({
                text: t,
                symbolFont: o
            }, null, e.originalToken))
                return r.nextSibling && "SPAN" === r.nextSibling.tagName && /^[\u00A0\s]/.test(r.nextSibling.firstChild.value) && ("P" === e.openedTag.tag() || "UL" === t.tag)
        }
        return !1
    }, nr = function() {
        var o, i;
        return {
            guessIndentLevel: function(t, e, n, r) {
                return r && /^([0-9]+\.)+[0-9]+\.?$/.test(r.text) ? r.text.replace(/([0-9]+|\.$)/g, "").length + 1 : (n = i || parseInt(tr(n, e.getAttribute("class"))),
                    e = function(t, e) {
                        for (var n = 0, r = t.parentNode; null != r && r !== e.parentNode; )
                            n += r.offsetLeft,
                                r = r.offsetParent;
                        return n
                    }(t.getNode(), e.getNode()),
                    n ? o ? e += o : 0 === e && (e += o = n) : n = 48,
                    i = n = Math.min(e, n),
                Math.max(1, Math.floor(e / n)) || 1)
            }
        }
    }, rr = function() {
        var e = !1;
        return {
            check: function(t) {
                return e && t.type() === Dn.TEXT_TYPE ? (t.text(),
                    !0) : t.type() === Dn.START_ELEMENT_TYPE && "STYLE" === t.tag() ? e = !0 : t.type() === Dn.END_ELEMENT_TYPE && "STYLE" === t.tag() && !(e = !1)
            }
        }
    }, or = ["disc", "circle", "square"];
    function ir(u, a) {
        function c(t, e) {
            var n = {}
                , r = {};
            d++,
            e && t.type && (n = {
                "list-style-type": t.type
            }),
            t.start && 1 < t.start && (r = {
                start: t.start
            }),
                o.push(t),
                u.emit(Dn.createStartElement(t.tag, r, n, a)),
                i = t
        }
        function s() {
            u.emit(Dn.createEndElement(o.pop().tag, a)),
                d--,
                i = o[o.length - 1]
        }
        function f(t, e, n) {
            var r, o = {};
            t ? void 0 !== (r = t.getStyle("margin-left")) && (o["margin-left"] = r) : o["list-style-type"] = "none",
            i && !Qn.eqListType(i, e) && (s(),
            n && (u.emit(Dn.createStartElement("P", {}, {}, a)),
                u.emit(Dn.createText("\xa0", a)),
                u.emit(Dn.createEndElement("P", a))),
                c(e, !0)),
                u.emit(Dn.createStartElement("LI", {}, o, a)),
                t && "P" !== t.tag() ? (l.push(t.tag()),
                    t.filterStyles(function() {
                        return null
                    }),
                    u.emit(t)) : l.push("P")
        }
        var i, o = [], l = [], d = 0, m = function() {
            var t = l ? l.pop() : "P";
            "P" !== t && u.emit(Dn.createEndElement(t, a)),
                u.emit(Dn.createEndElement("LI", a))
        };
        return {
            openList: c,
            closelist: s,
            closeAllLists: function() {
                for (; 0 < d; )
                    m(),
                        s();
                u.commit()
            },
            closeItem: m,
            openLI: f,
            openItem: function(t, e, n, r) {
                if (n) {
                    for (d = d || 0; t < d; )
                        m(),
                            s();
                    var o, i;
                    if (i = t,
                    "UL" === (o = n).tag && or[i - 1] === o.type && (o = {
                        tag: "UL"
                    }),
                        n = o,
                    d === t)
                        m(),
                            f(e, n, r);
                    else
                        for (1 < t && 0 < l.length && "P" !== l[l.length - 1] && (u.emit(Dn.createEndElement(l[l.length - 1], a)),
                            l[l.length - 1] = "P"); d < t; )
                            c(n, d === t - 1),
                                f(d === t ? e : void 0, n)
                }
            },
            getCurrentListType: function() {
                return i
            },
            getCurrentLevel: function() {
                return d
            }
        }
    }
    function ur(t, e) {
        yn.log("Unexpected token in list conversion: " + e.toString()),
            t.rollback()
    }
    function ar(t, e, n) {
        n.type() === Dn.TEXT_TYPE && "" === yn.trim(n.text()) ? t.defer(n) : e.skippedPara || n.type() !== Dn.START_ELEMENT_TYPE || "P" !== n.tag() || Wn(n) ? lr(t, e, n) : (e.openedTag = n,
            t.defer(n),
            e.nextFilter = fr)
    }
    function cr(t, e, n) {
        n.type() === Dn.END_ELEMENT_TYPE && e.originalToken.tag() === n.tag() && (e.nextFilter = ar,
            e.styleLevelAdjust = -1),
            t.emit(n)
    }
    function sr(t) {
        br.nextFilter = yr.initial,
            br.itemLevel = 0,
            br.originalToken = null,
            br.commentMode = !1,
            br.openedTag = null,
            br.symbolFont = !1,
            br.listType = null,
            br.indentGuesser = nr(),
            br.emitter = ir(t, t.document),
            br.styles = rr(),
            br.spanCount = [],
            br.skippedPara = !1,
            br.styleLevelAdjust = 0,
            br.bulletInfo = void 0
    }
    var fr = function(t, e, n) {
        n.type() !== Dn.START_ELEMENT_TYPE || "SPAN" !== n.tag() || 0 !== e.spanCount.length || !Hn && er(n, e) || Wn(n) ? n.type() === Dn.END_ELEMENT_TYPE ? "SPAN" === n.tag() ? (t.defer(n),
            e.spanCount.pop()) : "P" === n.tag() ? (t.defer(n),
            e.skippedPara = !0,
            e.openedTag = null,
            e.nextFilter = ar) : (e.nextFilter = lr,
            e.nextFilter(t, e, n)) : n.isWhitespace() ? t.defer(n) : (e.nextFilter = lr,
            e.nextFilter(t, e, n)) : (t.defer(n),
            e.spanCount.push(n))
    }
        , lr = function(t, e, n) {
        function r() {
            e.emitter.closeAllLists(),
                t.emitDeferred(),
                e.openedTag = null,
                t.emit(n),
                e.nextFilter = lr
        }
        var o;
        n.type() === Dn.START_ELEMENT_TYPE && Wn(n) && "LI" !== n.tag() ? (o = / level([0-9]+)/.exec(n.getStyle("mso-list"))) && o[1] ? (e.itemLevel = parseInt(o[1], 10) + e.styleLevelAdjust,
            e.nextFilter === lr ? t.emitDeferred() : t.dropDeferred(),
            e.nextFilter = dr,
            t.startTransaction(),
            e.originalToken = n,
            e.commentMode = !1) : r() : !Hn && (n.type() === Dn.COMMENT_TYPE && "[if !supportLists]" === n.text() || er(n, t)) ? (n.type() === Dn.START_ELEMENT_TYPE && "SPAN" === n.tag() && e.spanCount.push(n),
            e.nextFilter = dr,
            t.startTransaction(),
            e.originalToken = e.openedTag,
            e.commentMode = !0,
            e.openedTag = null,
            t.dropDeferred()) : n.type() === Dn.END_ELEMENT_TYPE && Bn(n) ? (t.defer(n),
            e.spanCount.pop()) : n.type() === Dn.START_ELEMENT_TYPE ? Bn(n) ? (t.defer(n),
            e.spanCount.push(n)) : (e.openedTag && (e.emitter.closeAllLists(),
            t.emitDeferred()),
            e.openedTag = n,
            t.defer(n)) : r()
    }
        , dr = function(t, e, n) {
        var r, o;
        n.type() === Dn.START_ELEMENT_TYPE && "Ignore" === n.getStyle("mso-list") && (e.nextFilter = mr),
            n.type() === Dn.START_ELEMENT_TYPE && "SPAN" === n.tag() ? (e.spanCount.push(n),
            (e.commentMode && "" === n.getAttribute("style") || null === n.getAttribute("style")) && (e.nextFilter = mr)) : "A" === n.tag() ? n.type() === Dn.START_ELEMENT_TYPE ? e.spanCount.push(n) : e.spanCount.pop() : n.type() === Dn.TEXT_TYPE ? e.commentMode ? (e.nextFilter = mr,
                e.nextFilter(t, e, n)) : (r = e.originalToken,
                o = e.spanCount,
                e.emitter.closeAllLists(),
                t.emit(r),
                yn.each(o, yn.bind(t.emit, t)),
                t.emit(n),
                t.commit(),
                e.originalToken = r,
                e.nextFilter = cr) : !e.commentMode && n.type() === Dn.COMMENT_TYPE || ur(t, n)
    }
        , mr = function(t, e, n) {
        n.type() === Dn.TEXT_TYPE ? n.isWhitespace() || (e.nextFilter = pr,
            e.bulletInfo = {
                text: n.text(),
                symbolFont: e.symbolFont
            }) : Bn(n) ? n.type() === Dn.START_ELEMENT_TYPE ? e.spanCount.push(n) : e.spanCount.pop() : n.type() === Dn.START_ELEMENT_TYPE && "IMG" === n.tag() ? (e.nextFilter = pr,
            e.bulletInfo = {
                text: "\u2202",
                symbolFont: !0
            }) : ur(t, n)
    }
        , pr = function(t, e, n) {
        n.type() === Dn.START_ELEMENT_TYPE && Bn(n) ? (e.spanCount.push(n),
            e.nextFilter = gr) : n.type() === Dn.END_ELEMENT_TYPE && Bn(n) ? (e.spanCount.pop(),
            e.nextFilter = vr) : n.type() === Dn.END_ELEMENT_TYPE && "IMG" === n.tag() || ur(t, n)
    }
        , gr = function(t, e, n) {
        n.type() === Dn.END_ELEMENT_TYPE && (Bn(n) && e.spanCount.pop(),
            e.nextFilter = vr)
    }
        , vr = function(o, i, u) {
        function t(t) {
            var e, n, r;
            if (i.nextFilter = hr,
            i.commentMode && (i.itemLevel = i.indentGuesser.guessIndentLevel(u, i.originalToken, i.styles.styles, i.bulletInfo)),
                i.listType = Qn.guessListType(i.bulletInfo, (e = i.emitter.getCurrentListType(),
                    n = i.emitter.getCurrentLevel(),
                    r = i.itemLevel,
                    n === r ? e : null), i.originalToken),
                i.listType) {
                for (i.emitter.openItem(i.itemLevel, i.originalToken, i.listType, i.skippedPara),
                         o.emitDeferred(); 0 < i.spanCount.length; )
                    o.emit(i.spanCount.shift());
                t && o.emit(u)
            } else
                yn.log("Unknown list type: " + i.bulletInfo.text + " Symbol font? " + i.bulletInfo.symbolFont),
                    o.rollback()
        }
        u.type() === Dn.TEXT_TYPE || u.type() === Dn.START_ELEMENT_TYPE ? t(!0) : u.type() === Dn.COMMENT_TYPE ? t("[endif]" !== u.text()) : u.type() === Dn.END_ELEMENT_TYPE ? Bn(u) && i.spanCount.pop() : ur(o, u)
    }
        , hr = function(t, e, n) {
        n.type() === Dn.END_ELEMENT_TYPE && n.tag() === e.originalToken.tag() ? (e.nextFilter = ar,
            e.skippedPara = !1) : t.emit(n)
    }
        , yr = {
        initial: lr
    }
        , br = {};
    sr({});
    function xr(t, e, n, r) {
        for (var o = Nn(n), i = Cn(t, n), u = function(t, e, n, r) {
            for (var o = e, i = t.length - 1; 0 <= i; i--)
                o = t[i](o, n, r);
            return o
        }(r, o, e, n); i.hasNext(); )
            u.receive(i.next());
        return o.dom
    }
    var Tr = [g, Pn(function(t, e) {
        br.styles.check(e) || (br.symbolFont = Qn.checkFont(e, br.symbolFont),
            br.nextFilter(t, br, e))
    }, function(t) {
        sr(t)
    }), Bt, t, On, pn]
        , wr = function(t) {
        return 0 <= t.indexOf("<o:p>") || 0 <= t.indexOf("p.MsoNormal, li.MsoNormal, div.MsoNormal") || 0 <= t.indexOf("MsoListParagraphCxSpFirst") || 0 <= t.indexOf("<w:WordDocument>")
    }
        , Er = {
        filter: function(t, e, n) {
            var r = Fn.all(t)
                , o = wr(r);
            e.setWordContent(o);
            t = Gn;
            return o && (t = Tr.concat(Gn)),
                xr(r, e, n, t)
        },
        filterPlainText: function(t, e, n) {
            t = Fn.textOnly(t);
            return xr(t, e, n, [Mn])
        },
        isWordContent: wr
    }
        , Sr = {
        openDialog: function(t, e, n) {
            var r = e("cement.dialog.paste.clean")
                , o = e("cement.dialog.paste.merge")
                , o = [{
                text: r,
                ariaLabel: r,
                onclick: function() {
                    i.close(),
                        n("clean")
                }
            }, {
                text: o,
                ariaLabel: o,
                onclick: function() {
                    i.close(),
                        n("merge")
                }
            }]
                , o = {
                title: e("cement.dialog.paste.title"),
                spacing: 10,
                padding: 10,
                items: [{
                    type: "container",
                    html: e("cement.dialog.paste.instructions")
                }],
                buttons: o
            }
                , i = t.windowManager.open(o);
            setTimeout(function() {
                i && i.getEl().focus()
            }, 1)
        }
    }
        , Ar = {
        openDialog: function(t, e, n) {
            var r = e("cement.dialog.paste.clean")
                , o = e("cement.dialog.paste.merge")
                , o = {
                title: e("cement.dialog.paste.title"),
                body: {
                    type: "panel",
                    items: [{
                        type: "htmlpanel",
                        name: "instructions",
                        html: e("cement.dialog.paste.instructions")
                    }]
                },
                buttons: [{
                    text: r,
                    type: "custom",
                    name: "clean"
                }, {
                    text: o,
                    type: "custom",
                    name: "merge"
                }],
                onAction: function(t, e) {
                    switch (e.name) {
                        case "clean":
                            t.close(),
                                n("clean");
                            break;
                        case "merge":
                            t.close(),
                                n("merge")
                    }
                }
            };
            t.windowManager.open(o)
        }
    };
    function Ir(i, u, a) {
        return {
            showDialog: function(r) {
                var t, e = xt(i), n = Tt(i), o = Er.isWordContent(r) ? e : n, n = function(t) {
                    var e = {
                        content: r
                    };
                    i.fire("PastePreProcess", {
                        content: e,
                        internal: !1
                    });
                    var t = Tn.create(t, t, !0)
                        , n = Er.filter(e.content, t, i.getDoc());
                    i.fire("PastePostProcess", {
                        node: n,
                        internal: !1
                    }),
                        i.undoManager.transact(function() {
                            hn.insert(n, i)
                        })
                };
                "clean" === (t = o) || "merge" === t ? n(o) : (a ? Ar : Sr).openDialog(i, u, n)
            }
        }
    }
    function _r(t, e) {
        return t.hasEventListeners(e)
    }
    function Lr(t) {
        return t.plugins.powerpaste
    }
    var Pn = "x-tinymce/html"
        , Or = l(Pn)
        , Dr = "\x3c!-- " + Pn + " --\x3e"
        , Nr = function(t) {
        return -1 !== t.indexOf(Dr)
    }
        , Cr = function(t) {
        return t.replace(/ data-mce-contenteditable="([^"]+)"/g, ' contenteditable="$1"')
    }
        , Pr = function(t, e, n, r, o) {
        var i, u, a, c = e.replace(Dr, "");
        return i = c,
            u = n,
            a = r,
            e = o,
            i = _r(t = c = t, "PastePreProcess") ? (e = {
                internal: u,
                content: i,
                source: a,
                mode: e = e
            },
                t.fire("PastePreProcess", e).content) : i,
            n = n,
            r = r,
            o = o,
            _r(c, "PastePostProcess") ? function(t, e, n, r, o) {
                e = t.dom.add(t.getBody(), "div", {
                    style: "display:none"
                }, e),
                    o = {
                        internal: n,
                        node: e,
                        source: r,
                        mode: o
                    },
                    o = t.fire("PastePostProcess", o).node.innerHTML;
                return t.dom.remove(e),
                    o
            }(c, i, n, r, o) : i
    }
        , kr = function(e) {
        var n = ht(e)
            , r = e.getParam("paste_postprocess");
        n && e.on("PastePreProcess", function(t) {
            return n.call(e, Lr(e), t)
        }),
        r && e.on("PastePostProcess", function(t) {
            return r.call(e, Lr(e), t)
        })
    }
        , Rr = function(t) {
        var e = t.toLowerCase()
            , t = {
            jpg: "jpeg",
            jpe: "jpeg",
            jfi: "jpeg",
            jif: "jpeg",
            jfif: "jpeg",
            pjpeg: "jpeg",
            pjp: "jpeg",
            svg: "svg+xml"
        };
        return Ct(t, e) ? "image/" + t[e] : "image/" + e
    };
    function Mr(r, t, n, o) {
        var i;
        r.on("dragstart dragend", function(t) {
            i = "dragstart" === t.type
        }),
            r.on("dragover dragend dragleave", function(t) {
                i || t.preventDefault()
            });
        function u(t, e) {
            return e in t && 0 < t[e].length
        }
        function a(t) {
            var n, t = t.target.files || t.dataTransfer.files;
            return st(t, (n = _t(r),
                    function(e) {
                        return kt(e.type, "image/") && ut(n, function(t) {
                            return Rr(t) === e.type
                        })
                    }
            ))
        }
        function c(t) {
            en(t).get(function(t) {
                var e = at(t, function(t) {
                    var e = mn.fromTag("img")
                        , t = Ht.cata(t, n.getLocalURL, function(t, e, n) {
                        return e
                    });
                    return fn(e, "src", t),
                        e.dom.outerHTML
                }).join("");
                r.insertContent(Pr(r, e, !1, "imagedrop", "auto"), {
                    merge: St(r)
                }),
                gt(r) && n.uploadImages(t)
            })
        }
        var s = function(t) {
            t = t["text/plain"];
            return !!t && 0 === t.indexOf("file://")
        };
        r.on("drop", function(t) {
            if (!i) {
                var e = tinymce.dom.RangeUtils;
                e && e.getCaretRangeFromPoint && ((n = e.getCaretRangeFromPoint(t.clientX, t.clientY, r.getDoc())) && r.selection.setRng(n));
                e = a(t);
                if (0 < e.length)
                    return c(e),
                        void t.preventDefault();
                var n = function(t) {
                    var e, n = {};
                    if (t && (!t.getData || (e = t.getData("Text")) && 0 < e.length && (n["text/plain"] = e),
                        t.types))
                        for (var r = 0; r < t.types.length; r++) {
                            var o = t.types[r];
                            n[o] = t.getData(o)
                        }
                    return n
                }(t.dataTransfer);
                s(e = n) || !u(e, "text/html") && !u(e, "text/plain") || (Ir(r, vn, o).showDialog(n["text/html"] || n["text/plain"]),
                    t.preventDefault())
            }
        })
    }
    function Fr() {
        function n(t) {
            URL.revokeObjectURL(t.objurl())
        }
        var r = {};
        return {
            add: function(t, e, n) {
                e = e,
                    n = n,
                    n = {
                        id: l(t),
                        imageresult: l(e),
                        objurl: l(n)
                    };
                return r[t] = n
            },
            get: function(t) {
                return G.from(r[t])
            },
            remove: function(t) {
                var e = r[t];
                delete r[t],
                void 0 !== e && n(e)
            },
            lookupByData: function(e) {
                return function(t, e) {
                    for (var n = Ot(t), r = 0, o = n.length; r < o; r++) {
                        var i = n[r]
                            , u = t[i];
                        if (e(u, i, t))
                            return G.some(u)
                    }
                    return G.none()
                }(r, function(t) {
                    return Qe(t.imageresult()) === e
                })
            },
            destroy: function() {
                R(r, n),
                    r = {}
            }
        }
    }
    function jr(n) {
        var r, o = !1;
        return function() {
            for (var t = [], e = 0; e < arguments.length; e++)
                t[e] = arguments[e];
            return o || (o = !0,
                r = n.apply(null, t)),
                r
        }
    }
    function Ur(t, e) {
        var n = String(e).toLowerCase();
        return _(t, function(t) {
            return t.search(n)
        })
    }
    function Hr(t) {
        return window.matchMedia(t).matches
    }
    function Br(t, e) {
        if (1 !== (t = t.dom).nodeType)
            return !1;
        if (void 0 !== t.matches)
            return t.matches(e);
        if (void 0 !== t.msMatchesSelector)
            return t.msMatchesSelector(e);
        if (void 0 !== t.webkitMatchesSelector)
            return t.webkitMatchesSelector(e);
        if (void 0 !== t.mozMatchesSelector)
            return t.mozMatchesSelector(e);
        throw new Error("Browser lacks native selectors")
    }
    function Wr(t) {
        return 1 !== t.nodeType && 9 !== t.nodeType && 11 !== t.nodeType || 0 === t.childElementCount
    }
    function zr(t, e) {
        return e = void 0 === e ? document : e.dom,
            Wr(e) ? [] : at(e.querySelectorAll(t), mn.fromDom)
    }
    function Yr(t, e) {
        return t.dom === e.dom
    }
    function qr(t) {
        return mn.fromDom(t.dom.ownerDocument)
    }
    function $r(t) {
        return cn(t) ? t : qr(t)
    }
    function Vr(t) {
        return mn.fromDom($r(t).dom.defaultView)
    }
    function Gr(t) {
        return G.from(t.dom.parentNode).map(mn.fromDom)
    }
    function Kr(t, e) {
        for (var n = et(e) ? e : d, r = t.dom, o = []; null !== r.parentNode && void 0 !== r.parentNode; ) {
            var i = r.parentNode
                , u = mn.fromDom(i);
            if (o.push(u),
            !0 === n(u))
                break;
            r = i
        }
        return o
    }
    function Xr(t) {
        return G.from(t.dom.previousSibling).map(mn.fromDom)
    }
    function Jr(t) {
        return G.from(t.dom.nextSibling).map(mn.fromDom)
    }
    function Zr(t) {
        return function(t) {
            t = rt.call(t, 0);
            return t.reverse(),
                t
        }(function(t, e) {
            for (var n = [], r = function(t) {
                return n.push(t),
                    e(t)
            }, o = e(t); (o = o.bind(r)).isSome(); )
                ;
            return n
        }(t, Xr))
    }
    function Qr(t) {
        return function(t, e) {
            t = t.dom.childNodes;
            return G.from(t[e]).map(mn.fromDom)
        }(t, 0)
    }
    function to(t) {
        return t = Io(t),
            sn(t) ? G.some(t) : G.none()
    }
    function eo(t) {
        return mn.fromDom(t.dom.host)
    }
    function no(t) {
        function e() {
            return t.stopPropagation()
        }
        function n() {
            return t.preventDefault()
        }
        var r = mn.fromDom(function(t) {
            if (Ao() && E(t.target)) {
                var e = mn.fromDom(t.target);
                if (un(e) && _o(e) && t.composed && t.composedPath) {
                    e = t.composedPath();
                    if (e)
                        return C(e)
                }
            }
            return G.from(t.target)
        }(t).getOr(t.target))
            , o = i(n, e);
        return {
            target: r,
            x: t.clientX,
            y: t.clientY,
            stop: e,
            prevent: n,
            kill: o,
            raw: t
        }
    }
    function ro(t, e, n, r, o) {
        var i, u, r = (i = n,
                u = r,
                function(t) {
                    i(t) && u(no(t))
                }
        );
        return t.dom.addEventListener(e, r, o),
            {
                unbind: p(Lo, t, e, r, o)
            }
    }
    var oo = function() {
        return io(0, 0)
    }
        , io = function(t, e) {
        return {
            major: t,
            minor: e
        }
    }
        , uo = {
        nu: io,
        detect: function(t, e) {
            e = String(e).toLowerCase();
            return 0 === t.length ? oo() : function(t, e) {
                var n = function(t, e) {
                    for (var n = 0; n < t.length; n++) {
                        var r = t[n];
                        if (r.test(e))
                            return r
                    }
                }(t, e);
                if (!n)
                    return {
                        major: 0,
                        minor: 0
                    };
                t = function(t) {
                    return Number(e.replace(n, "$" + t))
                }
                ;
                return io(t(1), t(2))
            }(t, e)
        },
        unknown: oo
    }
        , ao = function(t, n) {
        return Ur(t, n).map(function(t) {
            var e = uo.detect(t.versionRegexes, n);
            return {
                current: t.name,
                version: e
            }
        })
    }
        , co = function(t, n) {
        return Ur(t, n).map(function(t) {
            var e = uo.detect(t.versionRegexes, n);
            return {
                current: t.name,
                version: e
            }
        })
    }
        , Bt = /.*?version\/\ ?([0-9]+)\.([0-9]+).*/
        , t = function(e) {
        return function(t) {
            return Pt(t, e)
        }
    }
        , On = [{
        name: "Edge",
        versionRegexes: [/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],
        search: function(t) {
            return Pt(t, "edge/") && Pt(t, "chrome") && Pt(t, "safari") && Pt(t, "applewebkit")
        }
    }, {
        name: "Chrome",
        versionRegexes: [/.*?chrome\/([0-9]+)\.([0-9]+).*/, Bt],
        search: function(t) {
            return Pt(t, "chrome") && !Pt(t, "chromeframe")
        }
    }, {
        name: "IE",
        versionRegexes: [/.*?msie\ ?([0-9]+)\.([0-9]+).*/, /.*?rv:([0-9]+)\.([0-9]+).*/],
        search: function(t) {
            return Pt(t, "msie") || Pt(t, "trident")
        }
    }, {
        name: "Opera",
        versionRegexes: [Bt, /.*?opera\/([0-9]+)\.([0-9]+).*/],
        search: t("opera")
    }, {
        name: "Firefox",
        versionRegexes: [/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],
        search: t("firefox")
    }, {
        name: "Safari",
        versionRegexes: [Bt, /.*?cpu os ([0-9]+)_([0-9]+).*/],
        search: function(t) {
            return (Pt(t, "safari") || Pt(t, "mobile/")) && Pt(t, "applewebkit")
        }
    }]
        , pn = [{
        name: "Windows",
        search: t("win"),
        versionRegexes: [/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]
    }, {
        name: "iOS",
        search: function(t) {
            return Pt(t, "iphone") || Pt(t, "ipad")
        },
        versionRegexes: [/.*?version\/\ ?([0-9]+)\.([0-9]+).*/, /.*cpu os ([0-9]+)_([0-9]+).*/, /.*cpu iphone os ([0-9]+)_([0-9]+).*/]
    }, {
        name: "Android",
        search: t("android"),
        versionRegexes: [/.*?android\ ?([0-9]+)\.([0-9]+).*/]
    }, {
        name: "OSX",
        search: t("mac os x"),
        versionRegexes: [/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]
    }, {
        name: "Linux",
        search: t("linux"),
        versionRegexes: []
    }, {
        name: "Solaris",
        search: t("sunos"),
        versionRegexes: []
    }, {
        name: "FreeBSD",
        search: t("freebsd"),
        versionRegexes: []
    }, {
        name: "ChromeOS",
        search: t("cros"),
        versionRegexes: [/.*?chrome\/([0-9]+)\.([0-9]+).*/]
    }]
        , so = {
        browsers: l(On),
        oses: l(pn)
    }
        , fo = "Firefox"
        , lo = function(t) {
        var e = t.current
            , n = t.version
            , t = function(t) {
            return function() {
                return e === t
            }
        };
        return {
            current: e,
            version: n,
            isEdge: t("Edge"),
            isChrome: t("Chrome"),
            isIE: t("IE"),
            isOpera: t("Opera"),
            isFirefox: t(fo),
            isSafari: t("Safari")
        }
    }
        , mo = {
        unknown: function() {
            return lo({
                current: void 0,
                version: uo.unknown()
            })
        },
        nu: lo,
        edge: l("Edge"),
        chrome: l("Chrome"),
        ie: l("IE"),
        opera: l("Opera"),
        firefox: l(fo),
        safari: l("Safari")
    }
        , po = "Windows"
        , go = "Android"
        , vo = "Solaris"
        , ho = "FreeBSD"
        , yo = "ChromeOS"
        , bo = function(t) {
        var e = t.current
            , n = t.version
            , t = function(t) {
            return function() {
                return e === t
            }
        };
        return {
            current: e,
            version: n,
            isWindows: t(po),
            isiOS: t("iOS"),
            isAndroid: t(go),
            isOSX: t("OSX"),
            isLinux: t("Linux"),
            isSolaris: t(vo),
            isFreeBSD: t(ho),
            isChromeOS: t(yo)
        }
    }
        , xo = {
        unknown: function() {
            return bo({
                current: void 0,
                version: uo.unknown()
            })
        },
        nu: bo,
        windows: l(po),
        ios: l("iOS"),
        android: l(go),
        linux: l("Linux"),
        osx: l("OSX"),
        solaris: l(vo),
        freebsd: l(ho),
        chromeos: l(yo)
    }
        , To = function(t, e) {
        var n, r, o = so.browsers(), i = so.oses(), u = ao(o, t).fold(mo.unknown, mo.nu), a = co(i, t).fold(xo.unknown, xo.nu);
        return {
            browser: u,
            os: a,
            deviceType: (n = u,
                r = t,
                o = e,
                u = (i = a).isiOS() && !0 === /ipad/i.test(r),
                t = i.isiOS() && !u,
                e = i.isiOS() || i.isAndroid(),
                a = e || o("(pointer:coarse)"),
                o = u || !t && e && o("(min-device-width:768px)"),
                e = t || e && !o,
                n = n.isSafari() && i.isiOS() && !1 === /safari/i.test(r),
                r = !e && !o && !n,
                {
                    isiPad: l(u),
                    isiPhone: l(t),
                    isTablet: l(o),
                    isPhone: l(e),
                    isTouch: l(a),
                    isAndroid: i.isAndroid,
                    isiOS: i.isiOS,
                    isWebView: l(n),
                    isDesktop: l(r)
                })
        }
    }
        , wo = jr(function() {
        return To(navigator.userAgent, Hr)
    })
        , Eo = Br
        , So = function(t) {
        return at(t.dom.childNodes, mn.fromDom)
    }
        , Pn = et(Element.prototype.attachShadow) && et(Node.prototype.getRootNode)
        , Ao = l(Pn)
        , Io = Pn ? function(t) {
            return mn.fromDom(t.dom.getRootNode())
        }
        : $r
        , _o = function(t) {
        return E(t.dom.shadowRoot)
    }
        , Lo = function(t, e, n, r) {
        t.dom.removeEventListener(e, n, r)
    }
        , Oo = m
        , Do = function(t, e, n) {
        return ro(t, e, Oo, n, !1)
    };
    function No(t, e, n) {
        for (var r = t.dom, o = et(n) ? n : d; r.parentNode; ) {
            r = r.parentNode;
            var i = mn.fromDom(r);
            if (e(i))
                return G.some(i);
            if (o(i))
                break
        }
        return G.none()
    }
    function Co(t, e) {
        return _(t.dom.childNodes, function(t) {
            return e(mn.fromDom(t))
        }).map(mn.fromDom)
    }
    function Po(t, r) {
        var o = function(t) {
            for (var e = 0; e < t.childNodes.length; e++) {
                var n = mn.fromDom(t.childNodes[e]);
                if (r(n))
                    return G.some(n);
                n = o(t.childNodes[e]);
                if (n.isSome())
                    return n
            }
            return G.none()
        };
        return o(t.dom)
    }
    function ko(t, e) {
        return Po(t, e).isSome()
    }
    function Ro(t, e) {
        return zr(e, t)
    }
    function Mo(t, e) {
        return Ro(t, "img[" + Xo + '="' + e + '"]')
    }
    function Fo(t) {
        return Ro(t, "img:not([" + Xo + "])[" + $o.blobId() + "]")
    }
    function jo() {
        var o = []
            , i = []
            , t = Go({
            complete: Vo(["response"])
        })
            , u = function() {
            t.trigger.complete(i),
                i = []
        }
            , a = function() {
            return 0 < o.length
        };
        return {
            findById: Mo,
            findAll: Fo,
            register: function(t, e) {
                fn(t, Xo, e),
                    o.push(e)
            },
            report: function(t, e, n) {
                var r;
                ct(e, function(t) {
                    var e;
                    Ue(t, Xo),
                        e = n,
                        t = t,
                        i.push({
                            success: e,
                            element: t.dom
                        })
                }),
                    r = t,
                    o = st(o, function(t, e) {
                        return t !== r
                    }),
                a() || u()
            },
            inProgress: a,
            isActive: function(t) {
                return S(o, t)
            },
            events: t.registry
        }
    }
    var Uo, Ho = function(t) {
        var e = an(t) ? t.dom.parentNode : t.dom;
        if (null == e || null === e.ownerDocument)
            return !1;
        var n, r, o = e.ownerDocument;
        return to(mn.fromDom(e)).fold(function() {
            return o.body.contains(e)
        }, (n = Ho,
                r = eo,
                function(t) {
                    return n(r(t))
                }
        ))
    }, Bo = function(n) {
        return {
            is: function(t) {
                return n === t
            },
            isValue: m,
            isError: d,
            getOr: l(n),
            getOrThunk: l(n),
            getOrDie: l(n),
            or: function(t) {
                return Bo(n)
            },
            orThunk: function(t) {
                return Bo(n)
            },
            fold: function(t, e) {
                return e(n)
            },
            map: function(t) {
                return Bo(t(n))
            },
            mapError: function(t) {
                return Bo(n)
            },
            each: function(t) {
                t(n)
            },
            bind: function(t) {
                return t(n)
            },
            exists: function(t) {
                return t(n)
            },
            forall: function(t) {
                return t(n)
            },
            toOptional: function() {
                return G.some(n)
            }
        }
    }, Wo = function(n) {
        return {
            is: d,
            isValue: d,
            isError: m,
            getOr: u,
            getOrThunk: function(t) {
                return t()
            },
            getOrDie: function() {
                return a(String(n))()
            },
            or: function(t) {
                return t
            },
            orThunk: function(t) {
                return t()
            },
            fold: function(t, e) {
                return t(n)
            },
            map: function(t) {
                return Wo(n)
            },
            mapError: function(t) {
                return Wo(t(n))
            },
            each: y,
            bind: function(t) {
                return Wo(n)
            },
            exists: d,
            forall: m,
            toOptional: G.none
        }
    }, zo = {
        value: Bo,
        error: Wo,
        fromOption: function(t, e) {
            return t.fold(function() {
                return Wo(e)
            }, Bo)
        }
    }, Bt = function(t) {
        var e = Yo(t);
        return {
            resolve: function(t) {
                t = t.split(" ");
                return at(t, function(t) {
                    return qo(e, t)
                }).join(" ")
            }
        }
    }, Yo = function(t) {
        return t.replace(/\./g, "-")
    }, qo = function(t, e) {
        return t + "-" + e
    }, t = (Bt("ephox.flour"),
        Bt("ephox-salmon").resolve), On = t("upload-image-in-progress"), pn = "data-" + t("image-blob"), Pn = "data-" + t("image-upload"), $o = {
        uploadInProgress: l(On),
        blobId: l(pn),
        trackedImage: l(Pn)
    }, Vo = function(e) {
        var o = [];
        return {
            bind: function(t) {
                if (void 0 === t)
                    throw new Error("Event bind error: undefined handler");
                o.push(t)
            },
            unbind: function(e) {
                o = st(o, function(t) {
                    return t !== e
                })
            },
            trigger: function() {
                for (var n = [], t = 0; t < arguments.length; t++)
                    n[t] = arguments[t];
                var r = {};
                ct(e, function(t, e) {
                    r[t] = n[e]
                }),
                    ct(o, function(t) {
                        t(r)
                    })
            }
        }
    }, Go = function(t) {
        return {
            registry: M(t, function(t) {
                return {
                    bind: t.bind,
                    unbind: t.unbind
                }
            }),
            trigger: M(t, function(t) {
                return t.trigger
            })
        }
    }, Ko = function(t, e) {
        var n = [];
        return ct(So(t), function(t) {
            e(t) && (n = n.concat([t])),
                n = n.concat(Ko(t, e))
        }),
            n
    }, Xo = $o.trackedImage();
    (t = Uo = Uo || {}).JSON = "json",
        t.Blob = "blob",
        t.Text = "text",
        t.FormData = "formdata",
        t.MultipartFormData = "multipart/form-data";
    function Jo(t) {
        return mi(Jt.nu(t))
    }
    function Zo(n) {
        return Jt.nu(function(e) {
            var t = new FileReader;
            t.onload = function(t) {
                t = t.target ? t.target.result : new Blob([]);
                e(t)
            }
                ,
                t.readAsText(n)
        })
    }
    function Qo(t) {
        try {
            var e = JSON.parse(t);
            return zo.value(e)
        } catch (t) {
            return zo.error("Response was not JSON.")
        }
    }
    function ti(t) {
        return Jt.pure(t.response)
    }
    function ei(t, e) {
        switch (t) {
            case Uo.JSON:
                return Qo(e.response).fold(function() {
                    return ti(e)
                }, Jt.pure);
            case Uo.Blob:
                return t = e,
                    G.from(t.response).map(Zo).getOr(Jt.pure("no response content"));
            case Uo.Text:
            default:
                return ti(e)
        }
    }
    function ni(t, e) {
        function n() {
            return gi(e.response)
        }
        function r(t) {
            return vi({
                message: t,
                status: e.status,
                responseText: e.responseText
            })
        }
        switch (t) {
            case Uo.JSON:
                return Qo(e.response).fold(r, gi);
            case Uo.Blob:
            case Uo.Text:
                return n();
            default:
                return r("unknown data type")
        }
    }
    function ri(t) {
        var e = (o = t.body,
            G.from(o).bind(function(t) {
                switch (t.type) {
                    case Uo.JSON:
                        return G.some("application/json");
                    case Uo.FormData:
                        return G.some("application/x-www-form-urlencoded; charset=UTF-8");
                    case Uo.MultipartFormData:
                        return G.none();
                    case Uo.Text:
                    default:
                        return G.some("text/plain")
                }
            }))
            , n = !0 === t.credentials ? G.some(!0) : G.none()
            , r = function(t) {
            switch (t) {
                case Uo.Blob:
                    return "application/octet-stream";
                case Uo.JSON:
                    return "application/json, text/javascript";
                case Uo.Text:
                    return "text/plain";
                default:
                    return ""
            }
        }(t.responseType) + ", */*; q=0.01"
            , o = void 0 !== t.headers ? t.headers : {};
        return {
            contentType: e,
            responseType: function(t) {
                switch (t) {
                    case Uo.JSON:
                        return G.none();
                    case Uo.Blob:
                        return G.some("blob");
                    case Uo.Text:
                        return G.some("text");
                    default:
                        return G.none()
                }
            }(t.responseType),
            credentials: n,
            accept: r,
            headers: o,
            progress: et(t.progress) ? G.some(t.progress) : G.none()
        }
    }
    function oi(t) {
        var n = new FormData;
        return R(t, function(t, e) {
            n.append(e, t)
        }),
            n
    }
    function ii(u) {
        return pi(function(r) {
            var n, o = new XMLHttpRequest;
            o.open(u.method, (n = u.url,
                G.from(u.query).map(function(t) {
                    var e = F(t, function(t, e) {
                        return encodeURIComponent(e) + "=" + encodeURIComponent(t)
                    })
                        , t = Pt(n, "?") ? "&" : "?";
                    return 0 < e.length ? n + t + e.join("&") : n
                }).getOr(n)), !0);
            var i, t = ri(u);
            i = o,
                (t = t).contentType.each(function(t) {
                    return i.setRequestHeader("Content-Type", t)
                }),
                i.setRequestHeader("Accept", t.accept),
                t.credentials.each(function(t) {
                    return i.withCredentials = t
                }),
                t.responseType.each(function(t) {
                    return i.responseType = t
                }),
                t.progress.each(function(e) {
                    return i.upload.addEventListener("progress", function(t) {
                        return e(t.loaded, t.total)
                    })
                }),
                R(t.headers, function(t, e) {
                    return i.setRequestHeader(e, t)
                });
            function e() {
                var e, t, n;
                e = u.url,
                    t = u.responseType,
                    ei(t, n = o).map(function(t) {
                        return {
                            message: 0 === n.status ? "Unknown HTTP error (possible cross-domain request)" : "Could not load url " + e + ": " + n.statusText,
                            status: n.status,
                            responseText: t
                        }
                    }).get(function(t) {
                        return r(zo.error(t))
                    })
            }
            o.onerror = e,
                o.onload = function() {
                    0 === o.status && !kt(u.url, "file:") || o.status < 100 || 400 <= o.status ? e() : ni(u.responseType, o).get(r)
                }
                ,
                t = u.body,
                G.from(t).map(function(t) {
                    return t.type === Uo.JSON ? JSON.stringify(t.data) : t.type === Uo.FormData || t.type === Uo.MultipartFormData ? oi(t.data) : t.data
                }).fold(function() {
                    return o.send()
                }, function(t) {
                    o.send(t)
                })
        })
    }
    function ui(t, e) {
        var n = (e ? hi : yi).exec(t)
            , t = N(["source", "protocol", "authority", "userInfo", "user", "password", "host", "port", "relative", "path", "directory", "file", "query", "anchor"], function(t, e) {
            return null !== (e = n[e]) && void 0 !== e ? e : ""
        });
        return Ft(Ft({}, t), {
            queryKey: function(t) {
                for (var e = {}; ; ) {
                    var n = bi.exec(t);
                    if (null === n)
                        return e;
                    e[n[1]] = n[2]
                }
            }(t.query)
        })
    }
    function ai(t, e) {
        return void 0 === e && (e = {}),
            ui(t, null !== (e = e.strictMode) && void 0 !== e && e)
    }
    function ci(t) {
        return B(t, xi(t))
    }
    function si(t) {
        for (var e, n = t, r = ""; "" !== n; ) {
            kt(n, "../") ? n = H(n, "../") : kt(n, "./") ? n = H(n, "./") : kt(n, "/./") ? n = "/" + H(n, "/./") : "/." === n ? n = "/" : kt(n, "/../") ? (n = "/" + H(n, "/../"),
                r = ci(r)) : "/.." === n ? (n = "/",
                r = ci(r)) : "." === n || ".." === n ? n = "" : (e = n.match(/(^\/?.*?)(\/|$)/)[1],
                n = H(n, e),
                r += e)
        }
        return r
    }
    function fi(t, e) {
        var t = ai(t, n = {
            strictMode: !0
        })
            , e = ai(e, n)
            , n = {};
        return "" !== e.protocol ? (n.protocol = e.protocol,
            n.authority = e.authority,
            n.path = si(e.path),
            n.query = e.query) : ("" !== e.authority ? (n.authority = e.authority,
            n.path = si(e.path),
            n.query = e.query) : ("" === e.path ? (n.path = t.path,
            "" !== e.query ? n.query = e.query : n.query = t.query) : (kt(e.path, "/") ? n.path = si(e.path) : (n.path = function(t, e, n) {
            if ("" !== n && "" === t)
                return "/" + e;
            n = t.substring(t.lastIndexOf("/") + 1);
            return B(t, n) + e
        }(t.path, e.path, t.authority),
            n.path = si(n.path)),
            n.query = e.query),
            n.authority = t.authority),
            n.protocol = t.protocol),
            n.anchor = e.anchor,
            n
    }
    function li(t, e, n) {
        return {
            message: l(t),
            status: l(e),
            contents: l(n)
        }
    }
    function di(t, e) {
        var n = t.name;
        return J(n) && !Rt(n, ".tmp") ? n : function(t, e) {
            if (J(t.type) && kt(t.type, "image/")) {
                t = t.type.substr("image/".length);
                return S(Ti, t) ? e + "." + t : e
            }
            return e
        }(t, e)
    }
    var mi = function(i) {
        return Ft(Ft({}, i), {
            toCached: function() {
                return mi(i.toCached())
            },
            bindFuture: function(e) {
                return mi(i.bind(function(t) {
                    return t.fold(function(t) {
                        return Jt.pure(zo.error(t))
                    }, function(t) {
                        return e(t)
                    })
                }))
            },
            bindResult: function(e) {
                return mi(i.map(function(t) {
                    return t.bind(e)
                }))
            },
            mapResult: function(e) {
                return mi(i.map(function(t) {
                    return t.map(e)
                }))
            },
            mapError: function(e) {
                return mi(i.map(function(t) {
                    return t.mapError(e)
                }))
            },
            foldResult: function(e, n) {
                return i.map(function(t) {
                    return t.fold(e, n)
                })
            },
            withTimeout: function(t, o) {
                return mi(Jt.nu(function(e) {
                    var n = !1
                        , r = setTimeout(function() {
                        n = !0,
                            e(zo.error(o()))
                    }, t);
                    i.get(function(t) {
                        n || (clearTimeout(r),
                            e(t))
                    })
                }))
            }
        })
    }
        , On = function(t) {
        return mi(Jt.pure(zo.value(t)))
    }
        , pi = Jo
        , gi = On
        , vi = function(t) {
        return mi(Jt.pure(zo.error(t)))
    }
        , hi = /^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@\/]*)(?::([^:@\/]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/
        , yi = /^(?:(?![^:@\/]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*)(?::([^:@\/]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/
        , bi = /(?:^|&)([^&=]+)=?([^&]*)/g
        , xi = function(t) {
        return t.substring(t.lastIndexOf("/"))
    }
        , Ti = ["jpg", "png", "gif", "jpeg"];
    function wi(o) {
        function s(t, e) {
            return t = t.split(/\s+/),
                e = 1 === t.length && "" !== t[0] ? t[0] : e,
                function(t, e) {
                    t = fi(t, e);
                    return (e = "") !== (t = t).protocol && (e += t.protocol,
                        e += ":"),
                    "" !== t.authority && (e += "//",
                        e += t.authority),
                        e += t.path,
                    "" !== t.query && (e += "?",
                        e += t.query),
                    "" !== t.anchor && (e += "#",
                        e += t.anchor),
                        e
                }(n, e)
        }
        function r(t, e, a) {
            var n, r, c = di(t, e), t = (n = "image",
                r = t,
                e = c,
                (t = new FormData).append(n, r, e),
                t = t.get("image"),
                {
                    type: Uo.Blob,
                    data: t
                });
            t = {
                url: o.url,
                body: t,
                responseType: Uo.Text,
                credentials: !0 === o.credentials
            },
                ii(Ft(Ft({}, t), {
                    method: "post"
                })).get(function(t) {
                    t.fold(function(t) {
                        a(zo.error(li(t.message, t.status, t.responseText)))
                    }, function(e) {
                        var n, t, r, o;
                        try {
                            var i = JSON.parse(e);
                            if (!J(i.location))
                                return t = "JSON response did not contain a string location",
                                    r = 500,
                                    o = e,
                                    void a(zo.error(li(t, r, o)));
                            n = i.location
                        } catch (t) {
                            n = e
                        }
                        var u = s(n, c);
                        a(zo.value({
                            location: u
                        }))
                    })
                })
        }
        var t, e, n = (t = o.url,
            t = 0 < (e = t.lastIndexOf("/")) ? t.substr(0, e) : t,
            t = void 0 === o.basePath ? t : o.basePath,
            Rt(t, "/") ? t : t + "/");
        return {
            upload: function(t, e, n) {
                t = t.imageresult();
                Le(t).then(function(t) {
                    r(t, e, n)
                })
            }
        }
    }
    function Ei(t, e) {
        return void 0 === (e = ln(t, e)) || "" === e ? [] : e.split(" ")
    }
    function Si(t) {
        return void 0 !== t.dom.classList
    }
    function Ai(t) {
        return Ei(t, "class")
    }
    function Ii(t, e) {
        return function(t, e, n) {
            n = Ei(t, e).concat([n]);
            return fn(t, e, n.join(" ")),
                !0
        }(t, "class", e)
    }
    function _i(t, e) {
        return r = e,
            0 < (t = st(Ei(n = t, e = "class"), function(t) {
                return t !== r
            })).length ? fn(n, e, t.join(" ")) : Ue(n, e),
            0;
        var n, r
    }
    function Li(t, e) {
        Si(t) ? t.dom.classList.add(e) : Ii(t, e)
    }
    function Oi(t, e) {
        Si(t) ? t.dom.classList.remove(e) : _i(t, e),
        0 === (Si(t = t) ? t.dom.classList : Ai(t)).length && Ue(t, "class")
    }
    function Di(t, e) {
        return Si(t) && t.dom.classList.contains(e)
    }
    function Ni(t) {
        return (Si(t) ? function(t) {
                for (var e = t.dom.classList, n = new Array(e.length), r = 0; r < e.length; r++) {
                    var o = e.item(r);
                    null !== o && (n[r] = o)
                }
                return n
            }
            : Ai)(t)
    }
    function Ci(t, e, n) {
        return No(t, function(t) {
            return Br(t, e)
        }, n)
    }
    function Pi(t, e, n) {
        var r;
        return r = Ci,
            n = n,
            Br(t = t, e = e) ? G.some(t) : et(n) && n(t) ? G.none() : r(t, e, n)
    }
    function ki(t, e) {
        return {
            image: l(t),
            blobInfo: l(e)
        }
    }
    function Ri(t, n, i, r, u, e, a) {
        function c() {
            var t = "Internal error with blob cache";
            console.error(t, u),
                a(Wi.failure(li(t, 666, u)))
        }
        t.upload(e, u, function(t) {
            var e, o = n.findById(r, u);
            ct(o, (e = $o.uploadInProgress(),
                    function(t) {
                        Oi(t, e)
                    }
            )),
                t.fold(function(t) {
                    a(Wi.failure(t))
                }, function(e) {
                    var t, n, r;
                    t = i,
                        n = u,
                        r = e,
                        ct(o, function(t) {
                            fn(t, "src", r.location),
                                Ue(t, $o.blobId())
                        }),
                        zi(t, n).fold(c, function(t) {
                            a(Wi.success(e, o, t))
                        })
                }),
                n.report(u, o, t.isValue())
        })
    }
    function Mi(s, e, t) {
        return ft(t, function(t) {
            return Ht.cata(t, function(u, a, c) {
                return Bi(e, 'img[src="' + c + '"]').fold(function() {
                    return [zo.error("Image that was just inserted could not be found: " + c)]
                }, function(t) {
                    return [zo.value((e = s,
                        n = u,
                        o = c,
                        i = t,
                        t = Qe(r = a),
                        t = e.lookupByData(t).getOrThunk(function() {
                            return e.add(n, r, o)
                        }),
                        fn(i, $o.blobId(), t.id()),
                        ki(i, t)))];
                    var e, n, r, o, i
                })
            }, l([]))
        })
    }
    function Fi(t, o, e) {
        return e = t.findAll(e),
            t.inProgress() ? [] : at(e, function(t) {
                return e = o,
                    r = ln(n = t, $o.blobId()),
                    e.get(r).fold(function() {
                        return zo.error(r)
                    }, function(t) {
                        return zo.value(ki(n, t))
                    });
                var e, n, r
            })
    }
    function ji(t) {
        return parseInt(t, 10)
    }
    function Ui(t, e, n) {
        return {
            major: l(t),
            minor: l(e),
            patch: l(n)
        }
    }
    var Hi = wi
        , pn = function(e) {
        return function(t) {
            return Di(t, e)
        }
    }
        , Bi = function(t, e) {
        return function(t, e) {
            e = void 0 === e ? document : e.dom;
            return Wr(e) ? G.none() : G.from(e.querySelector(t)).map(mn.fromDom)
        }(e, t)
    }
        , Wi = jt([{
        failure: ["error"]
    }, {
        success: ["result", "images", "blob"]
    }])
        , zi = function(e, n) {
        return e.get(n).fold(function() {
            return zo.error("Internal error with blob cache")
        }, function(t) {
            return e.remove(n),
                zo.value(t)
        })
    }
        , Yi = function() {
        return function(t) {
            t = /([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(t);
            return t ? Ui(ji(t[1]), ji(t[2]), ji(t[3])) : Ui(0, 0, 0)
        }([tinymce.majorVersion, tinymce.minorVersion].join(".").split(".").slice(0, 3).join("."))
    };
    function qi(c) {
        function s(t, e) {
            return l(4 === (n = Yi()).major() && n.minor() < 6 ? t : t + "." + (e = (t = e).toLowerCase(),
                Ct(t = {
                    "image/jpeg": "jpg",
                    "image/jpg": "jpg",
                    "image/gif": "gif",
                    "image/png": "png"
                }, e) ? t[e] : "dat"));
            var n
        }
        return {
            importImages: function(t) {
                t = ft(t, function(t) {
                    return Ht.cata(t, function(t, e, n) {
                        var r, o, i, u, a = Qe(e);
                        return [(r = t,
                            o = e,
                            i = a,
                            u = n,
                            Jt.nu(function(e) {
                                Ze(o).then(function(t) {
                                    c.editorUpload.blobCache.add({
                                        id: l(r),
                                        name: l(r),
                                        filename: s(r, t.type),
                                        blob: l(t),
                                        base64: l(i.split(",")[1]),
                                        blobUri: l(u),
                                        uri: l(null)
                                    }),
                                        e(t)
                                })
                            }))]
                    }, l([]))
                });
                return Zt(t)
            },
            uploadImages: function() {
                c.uploadImages()
            },
            prepareImages: y,
            getLocalURL: function(t, e, n) {
                return Qe(e)
            }
        }
    }
    function $i(e, t, n) {
        function r() {
            return vn("error.code.images.not.found") + t + vn("error.full.stop")
        }
        function o() {
            return vn("error.imageupload") + t + vn("error.full.stop")
        }
        function i(t) {
            t = 0 === (t = t.status()) || 400 <= t || t < 500 ? r : o,
                n.showDialog(e, t())
        }
        return {
            instance: function() {
                return n = i,
                    r = !1,
                    function() {
                        for (var t = [], e = 0; e < arguments.length; e++)
                            t[e] = arguments[e];
                        r || (r = !0,
                            n.apply(null, t))
                    }
                    ;
                var n, r
            }
        }
    }
    function Vi(t, e) {
        return (e = (e || document).createElement("div")).innerHTML = t,
            So(mn.fromDom(e))
    }
    function Gi(t, e) {
        Jr(t).fold(function() {
            Gr(t).each(function(t) {
                eu(t, e)
            })
        }, function(t) {
            tu(t, e)
        })
    }
    function Ki(e, n) {
        Qr(e).fold(function() {
            eu(e, n)
        }, function(t) {
            e.dom.insertBefore(n.dom, t.dom)
        })
    }
    function Xi(t, e) {
        tu(t, e),
            eu(e, t)
    }
    function Ji(n, r) {
        ct(r, function(t, e) {
            e = 0 === e ? n : r[e - 1];
            Gi(e, t)
        })
    }
    function Zi(e, t) {
        ct(t, function(t) {
            eu(e, t)
        })
    }
    function Qi(t) {
        Oi(t, $o.uploadInProgress())
    }
    var tu = function(e, n) {
        Gr(e).each(function(t) {
            t.dom.insertBefore(n.dom, e.dom)
        })
    }
        , eu = function(t, e) {
        t.dom.appendChild(e.dom)
    }
        , nu = {
        showDialog: function(t, e) {
            var e = {
                title: "Error",
                spacing: 10,
                padding: 10,
                items: [{
                    type: "container",
                    html: e
                }],
                buttons: [{
                    text: "Ok",
                    onclick: function() {
                        n.close()
                    }
                }]
            }
                , n = t.windowManager.open(e)
        }
    }
        , ru = function(r, t) {
        function u() {
            return mn.fromDom(r.getBody())
        }
        function a(e, t, n) {
            ct(t, function(t) {
                fn(t, "data-mce-src", e.location)
            }),
                function(t, e, n) {
                    for (var r = 0; r < t.undoManager.data.length; r++)
                        t.undoManager.data[r].content = t.undoManager.data[r].content.split(e.objurl()).join(n.location)
                }(r, n, e)
        }
        var c = Fr()
            , s = jo()
            , o = $i(r, t.url, nu)
            , f = Hi(t);
        s.events.complete.bind(function(t) {
            !function(t) {
                for (var e = 0; e < t.undoManager.data.length; e++) {
                    var n = t.undoManager.data[e].content
                        , r = mn.fromTag("div");
                    Zi(r, Vi(n));
                    n = Ro(r, "." + $o.uploadInProgress());
                    ct(n, Qi),
                        t.undoManager.data[e].content = r.dom.innerHTML
                }
            }(r)
        });
        function i(r, o) {
            var t, e, n, i;
            t = s,
                e = r.blobInfo().id(),
                n = r.image(),
                i = t.isActive(e),
                t.register(n, e),
                Li(n, $o.uploadInProgress()),
                (i ? G.none() : G.some(e)).each(function(t) {
                    var e, n;
                    e = t,
                        t = r.blobInfo(),
                        n = o,
                        Ri(f, s, c, u(), e, t, function(t) {
                            t.fold(function(t) {
                                n(t)
                            }, a)
                        })
                })
        }
        return {
            importImages: function() {
                return Jt.pure([])
            },
            uploadImages: function(t) {
                var e, n, r;
                e = o.instance(),
                    n = Fi(s, c, u()),
                    ct(n, function(t) {
                        t.fold(function(t) {
                            s.report(t, [], !1)
                        }, function(t) {
                            i(t, e)
                        })
                    }),
                    t = t,
                    r = o.instance(),
                    t = Mi(c, u(), t),
                    ct(t, function(t) {
                        t.fold(function(t) {
                            console.error(t)
                        }, function(t) {
                            i(t, r)
                        })
                    })
            },
            prepareImages: y,
            getLocalURL: function(t, e, n) {
                return n
            }
        }
    }
        , ou = function(o) {
        var t = qi(o);
        return {
            importImages: function() {
                return Jt.pure([])
            },
            uploadImages: y,
            prepareImages: function(t) {
                ct(t, function(t) {
                    Ht.cata(t, function(t, e, n) {
                        var r = Qe(e);
                        ct(o.dom.select('img[src="' + n + '"]'), function(t) {
                            o.dom.setAttrib(t, "src", r)
                        })
                    }, y)
                })
            },
            getLocalURL: t.getLocalURL
        }
    };
    var iu = function(t) {
        return void 0 !== t.uploadImages
    };
    function uu(t) {
        return (iu(t) ? qi : function(t) {
                if (mt(t)) {
                    var e = {
                        url: dt(t),
                        basePath: wt(t),
                        credentials: Et(t)
                    };
                    return ru(t, e)
                }
                return ou(t)
            }
        )(t)
    }
    function au(e, r, t, n) {
        var o, i = e.selection, u = e.dom, a = e.getBody(), c = t.isText();
        if (t.reset(),
        n.clipboardData && n.clipboardData.getData("text/html")) {
            n.preventDefault();
            var t = n.clipboardData.getData("text/html")
                , s = t.match(/<html[\s\S]+<\/html>/i)
                , s = null === s ? t : s[0];
            return r(s)
        }
        if (!u.get("_mcePaste")) {
            if (s = u.add(a, "div", {
                id: "_mcePaste",
                class: "mcePaste"
            }, '\ufeff<br _mce_bogus="1">'),
                a = a !== e.getDoc().body ? u.getPos(e.selection.getStart(), a).y : a.scrollTop,
                u.setStyles(s, {
                    position: "absolute",
                    left: -1e4,
                    top: a,
                    width: 1,
                    height: 1,
                    overflow: "hidden"
                }),
                tinymce.isIE)
                return (f = u.doc.body.createTextRange()).moveToElementText(s),
                    f.execCommand("Paste"),
                    u.remove(s),
                    "\ufeff" === s.innerHTML ? (e.execCommand("mcePasteWord"),
                        void n.preventDefault()) : (r(c ? s.innerText : s.innerHTML),
                        tinymce.dom.Event.cancel(n));
            var f, l = function(t) {
                t.preventDefault()
            };
            u.bind(e.getDoc(), "mousedown", l),
                u.bind(e.getDoc(), "keydown", l),
            tinymce.isGecko && ((f = e.selection.getRng(!0)).startContainer !== f.endContainer || 3 !== f.startContainer.nodeType || 1 === (n = u.select("p,h1,h2,h3,h4,h5,h6,pre", s)).length && u.remove(n.reverse(), !0)),
                o = e.selection.getRng(),
                s = s.firstChild,
                (f = e.getDoc().createRange()).setStart(s, 0),
                f.setEnd(s, 1),
                i.setRng(f),
                window.setTimeout(function() {
                    var n = ""
                        , t = u.select("div.mcePaste");
                    yn.each(t, function(t) {
                        var e = t.firstChild;
                        e && "DIV" === e.nodeName && e.style.marginTop && e.style.backgroundColor && u.remove(e, 1),
                            yn.each(u.select("div.mcePaste", t), function(t) {
                                u.remove(t, 1)
                            }),
                            yn.each(u.select("span.Apple-style-span", t), function(t) {
                                u.remove(t, 1)
                            }),
                            yn.each(u.select("br[_mce_bogus]", t), function(t) {
                                u.remove(t)
                            }),
                            n += t.innerHTML
                    }),
                        yn.each(t, function(t) {
                            u.remove(t)
                        }),
                    o && i.setRng(o),
                        r(n),
                        u.unbind(e.getDoc(), "mousedown", l),
                        u.unbind(e.getDoc(), "keydown", l)
                }, 0)
        }
    }
    var cu = {
        getOnPasteFunction: function(e, n, r) {
            return function(t) {
                au(e, n, r, t)
            }
        },
        getOnKeyDownFunction: function(e, n, r) {
            return function(t) {
                (tinymce.isOpera || 0 < navigator.userAgent.indexOf("Firefox/2")) && ((tinymce.isMac ? t.metaKey : t.ctrlKey) && 86 === t.keyCode || t.shiftKey && 45 === t.keyCode) && au(e, n, r, t)
            }
        }
    };
    function su(e, t) {
        function n(e) {
            return function(t) {
                e(t)
            }
        }
        var r = this
            , o = Ir(e, vn, !1)
            , i = cu.getOnPasteFunction(e, o.showDialog, t);
        e.on("paste", n(i));
        t = cu.getOnKeyDownFunction(e, o.showDialog, t);
        e.on("keydown", n(t)),
            e.addCommand("mceInsertClipboardContent", function(t, e) {
                o.showDialog(e.content || e)
            }),
        ht(e) && e.on("PastePreProcess", function(t) {
            ht(e).call(r, r, t)
        })
    }
    function fu(t) {
        var e = t;
        return {
            get: function() {
                return e
            },
            set: function(t) {
                e = t
            }
        }
    }
    var lu = function() {
        return t = function(t) {
            return t.unbind()
        }
            ,
            n = fu(G.none()),
            {
                clear: function() {
                    e(),
                        n.set(G.none())
                },
                isSet: function() {
                    return n.get().isSome()
                },
                set: function(t) {
                    e(),
                        n.set(G.some(t))
                }
            };
        function e() {
            return n.get().each(t)
        }
        var t, n
    }
        , du = function() {
        var e = fu(G.none());
        return {
            clear: function() {
                return e.set(G.none())
            },
            set: function(t) {
                return e.set(G.some(t))
            },
            isSet: function() {
                return e.get().isSome()
            },
            on: function(t) {
                return e.get().each(t)
            }
        }
    };
    function mu(n, r) {
        var e = function(t) {
            return n(t) ? G.from(t.dom.nodeValue) : G.none()
        };
        return {
            get: function(t) {
                if (!n(t))
                    throw new Error("Can only get " + r + " value of a " + r + " node");
                return e(t).getOr("")
            },
            getOption: e,
            set: function(t, e) {
                if (!n(t))
                    throw new Error("Can only set raw " + r + " value of a " + r + " node");
                t.dom.nodeValue = e
            }
        }
    }
    function pu(t, n) {
        var r = {};
        return ct(sa, function(e) {
            n[e].or(t[e]).each(function(t) {
                r[e] = t
            })
        }),
            fa(r)
    }
    function gu(t, e, n, r, o) {
        return t.fold(e, n, r, o)
    }
    function vu(e) {
        return ha(function(t) {
            t(e)
        })
    }
    function hu(t, e) {
        t(e)
    }
    function yu(t) {
        return vu({
            response: da(t),
            bundle: fa({})
        })
    }
    function bu(t, e, n, r) {
        return {
            steps: t,
            input: e,
            label: n,
            capture: r
        }
    }
    function xu(t, e, n) {
        var r;
        return (r = n,
            P(t, function(e) {
                return e.getAvailable(r).map(function(t) {
                    return bu(e.steps(), t, e.label(), e.capture())
                })
            })).getOrThunk(function() {
            var t = e.getAvailable(n);
            return bu(e.steps(), t, e.label(), e.capture())
        })
    }
    function Tu(o, t) {
        function e() {
            return t().map(function(t) {
                var e, r, n = pu(o.bundle, t.bundle);
                return {
                    response: (e = o.response,
                        r = t.response,
                        gu(e, G.none, G.none, G.none, function(t, e, n) {
                            return gu(r, G.none, function(t, e) {
                                return G.some(la.incomplete(t, e, n))
                            }, G.none, G.none)
                        }).getOr(r)),
                    bundle: n
                }
            })
        }
        var n = p(va, o);
        return gu(o.response, n, e, n, e)
    }
    function wu(t, n) {
        return I(t, function(t, e) {
            return t.bind(function(t) {
                return Tu(t, function() {
                    return e(n, t)
                })
            })
        }, vu({
            response: ma([], []),
            bundle: fa({})
        }))
    }
    function Eu(t) {
        var e = xa(t);
        return e && ya(t) || !e && ba(t)
    }
    function Su(t) {
        return t.isInternal.getOr(!1)
    }
    function Au(t, e, n) {
        var r, o, t = t.document.createRange();
        return r = t,
            e.fold(function(t) {
                r.setStartBefore(t.dom)
            }, function(t, e) {
                r.setStart(t.dom, e)
            }, function(t) {
                r.setStartAfter(t.dom)
            }),
            o = t,
            n.fold(function(t) {
                o.setEndBefore(t.dom)
            }, function(t, e) {
                o.setEnd(t.dom, e)
            }, function(t) {
                o.setEndAfter(t.dom)
            }),
            t
    }
    function Iu(t, e, n, r, o) {
        return (t = t.document.createRange()).setStart(e.dom, n),
            t.setEnd(r.dom, o),
            t
    }
    function _u(t, e, n) {
        return e(mn.fromDom(n.startContainer), n.startOffset, mn.fromDom(n.endContainer), n.endOffset)
    }
    function Lu(t, e) {
        var o, n, e = (o = t,
            e.match({
                domRange: function(t) {
                    return {
                        ltr: l(t),
                        rtl: G.none
                    }
                },
                relative: function(t, e) {
                    return {
                        ltr: jr(function() {
                            return Au(o, t, e)
                        }),
                        rtl: jr(function() {
                            return G.some(Au(o, e, t))
                        })
                    }
                },
                exact: function(t, e, n, r) {
                    return {
                        ltr: jr(function() {
                            return Iu(o, t, e, n, r)
                        }),
                        rtl: jr(function() {
                            return G.some(Iu(o, n, r, t, e))
                        })
                    }
                }
            }));
        return (n = (e = e).ltr()).collapsed ? e.rtl().filter(function(t) {
            return !1 === t.collapsed
        }).map(function(t) {
            return wa.rtl(mn.fromDom(t.endContainer), t.endOffset, mn.fromDom(t.startContainer), t.startOffset)
        }).getOrThunk(function() {
            return _u(0, wa.ltr, n)
        }) : _u(0, wa.ltr, n)
    }
    function Ou(t) {
        return Sa.get(t)
    }
    function Du(t, e) {
        return Sa.set(t, e)
    }
    function Nu(t, e) {
        var n = Ce(t);
        return "input" === n ? Aa.after(t) : S(["br", "img"], n) ? 0 === e ? Aa.before(t) : Aa.after(t) : Aa.on(t, e)
    }
    function Cu(t, e, n, r) {
        var o = qr(t).dom.createRange();
        return o.setStart(t.dom, e),
            o.setEnd(n.dom, r),
            o
    }
    function Pu(t) {
        return G.from(t.getSelection())
    }
    function ku(t, e, n, r, o) {
        var i, o = Iu(t, e, n, r, o);
        i = o,
            Pu(t).each(function(t) {
                t.removeAllRanges(),
                    t.addRange(i)
            })
    }
    function Ru(f, t) {
        return Lu(f, t).match({
            ltr: function(t, e, n, r) {
                ku(f, t, e, n, r)
            },
            rtl: function(u, a, c, s) {
                Pu(f).each(function(t) {
                    if (t.setBaseAndExtent)
                        t.setBaseAndExtent(u.dom, a, c.dom, s);
                    else if (t.extend)
                        try {
                            n = u,
                                r = a,
                                o = c,
                                i = s,
                                (e = t).collapse(n.dom, r),
                                e.extend(o.dom, i)
                        } catch (t) {
                            ku(f, c, s, u, a)
                        }
                    else
                        ku(f, c, s, u, a);
                    var e, n, r, o, i
                })
            }
        })
    }
    function Mu(t, e, n, r, o) {
        o = function(t, e, n, r) {
            e = Nu(t, e),
                r = Nu(n, r);
            return _a.relative(e, r)
        }(e, n, r, o),
            Ru(t, o)
    }
    function Fu(t) {
        if (0 < t.rangeCount) {
            var e = t.getRangeAt(0)
                , t = t.getRangeAt(t.rangeCount - 1);
            return G.some(Ea(mn.fromDom(e.startContainer), e.startOffset, mn.fromDom(t.endContainer), t.endOffset))
        }
        return G.none()
    }
    function ju(t) {
        if (null === t.anchorNode || null === t.focusNode)
            return Fu(t);
        var e, n, r, o, i, u = mn.fromDom(t.anchorNode), a = mn.fromDom(t.focusNode);
        return e = u,
            n = t.anchorOffset,
            r = a,
            o = t.focusOffset,
            i = Cu(e, n, r, o),
            o = Yr(e, r) && n === o,
            i.collapsed && !o ? G.some(Ea(u, t.anchorOffset, a, t.focusOffset)) : Fu(t)
    }
    function Uu(t) {
        return Pu(t).filter(function(t) {
            return 0 < t.rangeCount
        }).bind(ju)
    }
    function Hu(t) {
        t.dom.textContent = "",
            ct(So(t), function(t) {
                La(t)
            })
    }
    function Bu(t) {
        var e, n = So(t);
        0 < n.length && (e = t,
            ct(n, function(t) {
                tu(e, t)
            })),
            La(t)
    }
    function Wu(t, e, n, r) {
        var o = Yr(t, n) && e === r;
        return {
            startContainer: l(t),
            startOffset: l(e),
            endContainer: l(n),
            endOffset: l(r),
            collapsed: l(o)
        }
    }
    function zu(t) {
        return t.slice(0).sort()
    }
    function Yu(e, t) {
        0 < (t = st(t, function(t) {
            return !S(e, t)
        })).length && function(t) {
            throw new Error("Unsupported keys for object: " + zu(t).join(", "))
        }(t)
    }
    function qu(t) {
        return void 0 !== t.style && et(t.style.getPropertyValue)
    }
    function $u(t, e, n) {
        if (!J(n))
            throw console.error("Invalid call to CSS.set. Property ", e, ":: Value ", n, ":: Element ", t),
                new Error("CSS value must be a string: " + n);
        qu(t) && t.style.setProperty(e, n)
    }
    function Vu(t, e) {
        qu(t) && t.style.removeProperty(e)
    }
    function Gu(t, e, n) {
        t = t.dom,
            $u(t, e, n)
    }
    function Ku(t, e) {
        var n = t.dom;
        R(e, function(t, e) {
            $u(n, e, t)
        })
    }
    function Xu(t, e) {
        var n = t.dom
            , r = window.getComputedStyle(n).getPropertyValue(e);
        return "" !== r || Ho(t) ? r : Da(n, e)
    }
    function Ju(t, e) {
        return t = t.dom,
            e = Da(t, e),
            G.from(e).filter(function(t) {
                return 0 < t.length
            })
    }
    function Zu(t, e) {
        var n = t.dom;
        Vu(n, e),
        Fe(t, "style").map(Mt).is("") && Ue(t, "style")
    }
    function Qu(t) {
        return t.dom.innerHTML
    }
    function ta(n) {
        var t, r = (t = !1,
            {
                isBlocked: function() {
                    return t
                },
                block: function() {
                    t = !0
                },
                unblock: function() {
                    t = !1
                }
            });
        return {
            control: r,
            instance: function() {
                for (var t = [], e = 0; e < arguments.length; e++)
                    t[e] = arguments[e];
                r.isBlocked() || n.apply(null, t)
            }
        }
    }
    function ea(t) {
        ct(So(t), function(t) {
            var e;
            un(e = t) && !e.dom.hasChildNodes() && S(Ra, Ce(e)) && La(t)
        })
    }
    function na(e, t) {
        var n, r = mn.fromTag("div");
        function o(t) {
            return Di(t, ja)
        }
        return Me(r, t),
            Me(r, {
                contenteditable: "true",
                "aria-hidden": "true"
            }),
            Ku(r, {
                position: "fixed",
                top: "0px",
                width: "100px",
                height: "100px",
                overflow: "hidden",
                opacity: "0"
            }),
            n = r,
            ct([Fa, ja], function(t) {
                Li(n, t)
            }),
            {
                attach: function(t) {
                    Hu(r),
                        Gu(r, "left", Ua(t)),
                        eu(t, r)
                },
                focus: function() {
                    Ci(r, "body").each(function(t) {
                        e.toOff(t, r)
                    })
                },
                contents: function() {
                    var n, t;
                    return t = o,
                        Jr(n = r).filter(t).each(function(t) {
                            var e = So(t);
                            Zi(n, e),
                                La(t)
                        }),
                        Ma(n, t),
                        ea(n),
                        {
                            elements: So(r),
                            html: Qu(r),
                            offscreen: r
                        }
                },
                container: l(r),
                detach: function() {
                    La(r)
                }
            }
    }
    function ra(e, n, t) {
        function r() {
            e.cleanup();
            var t = o.contents();
            o.detach(),
                u.trigger.after(t.elements, t.html, o.container())
        }
        var o = na(e, t)
            , i = ta(function() {
            var t;
            u.trigger.before(),
                o.attach(n),
                o.focus(),
                t = qr(n),
                Pa(t, i, r)
        })
            , u = Go({
            before: Vo([]),
            after: Vo(["elements", "html", "container"])
        })
            , t = y;
        return {
            instance: l(function() {
                i.instance()
            }),
            destroy: t,
            events: u.registry
        }
    }
    function oa(t) {
        var e = Yr(t.start, t.finish) && t.soffset === t.foffset;
        return {
            startContainer: l(t.start),
            startOffset: l(t.soffset),
            endContainer: l(t.finish),
            endOffset: l(t.foffset),
            collapsed: l(e)
        }
    }
    var ia, ua, aa = mu(on, "comment"), ca = function(t) {
        return aa.get(t)
    }, sa = ["officeStyles", "htmlStyles", "isWord", "isGoogleDocs", "proxyBin", "isInternal", "backgroundAssets"], fa = function(e) {
        return N(sa, function(t) {
            return G.from(e[t])
        })
    }, la = jt([{
        error: ["message"]
    }, {
        paste: ["elements", "correlated"]
    }, {
        cancel: []
    }, {
        incomplete: ["elements", "correlated", "message"]
    }]), da = la.error, ma = la.paste, pa = la.cancel, ga = la.incomplete, va = vu, ha = function(e) {
        function t(t) {
            e(t)
        }
        var r = ha;
        return {
            get: t,
            map: function(n) {
                return r(function(e) {
                    t(function(t) {
                        t = n(t);
                        e(t)
                    })
                })
            },
            bind: function(n) {
                return r(function(e) {
                    t(function(t) {
                        n(t).get(e)
                    })
                })
            }
        }
    }, ya = function(t) {
        return t.officeStyles.getOr(!0)
    }, ba = function(t) {
        return t.htmlStyles.getOr(!1)
    }, xa = function(t) {
        return t.isWord.getOr(!1)
    }, Pn = wo(), t = Pn.deviceType.isiOS() || Pn.deviceType.isAndroid(), On = l({
        isSupported: !1,
        cleanDocument: function() {
            return Vt.reject("not supported")
        }
    }), Ta = t ? On : function(t, e, n) {
        var n = e + "/wordimport.js" + (n = n || "v=6.0.2",
            G.from(n).filter(function(t) {
                return 0 !== t.length
            }).map(function(t) {
                return (-1 === t.indexOf("?") ? "?" : "") + t
            }).getOr(""))
            , o = t.loadScript("ephox.wimp", n);
        o.catch(function(t) {
            console.error("Unable to load word import: ", t)
        });
        return {
            isSupported: !0,
            cleanDocument: function(e, n, r) {
                return o.then(function(t) {
                    return t.cleanDocument(e, n, r.cleanFilteredInlineElements)
                })
            }
        }
    }
        , wa = jt([{
        ltr: ["start", "soffset", "finish", "foffset"]
    }, {
        rtl: ["start", "soffset", "finish", "foffset"]
    }]), Ea = (wa.ltr,
            wa.rtl,
            function(t, e, n, r) {
                return {
                    start: t,
                    soffset: e,
                    finish: n,
                    foffset: r
                }
            }
    ), Sa = mu(an, "text"), Pn = jt([{
        before: ["element"]
    }, {
        on: ["element", "offset"]
    }, {
        after: ["element"]
    }]), Aa = {
        before: Pn.before,
        on: Pn.on,
        after: Pn.after,
        cata: function(t, e, n, r) {
            return t.fold(e, n, r)
        },
        getStart: function(t) {
            return t.fold(u, u, u)
        }
    }, Ia = jt([{
        domRange: ["rng"]
    }, {
        relative: ["startSitu", "finishSitu"]
    }, {
        exact: ["start", "soffset", "finish", "foffset"]
    }]), _a = {
        domRange: Ia.domRange,
        relative: Ia.relative,
        exact: Ia.exact,
        exactFromRange: function(t) {
            return Ia.exact(t.start, t.soffset, t.finish, t.foffset)
        },
        getWin: function(t) {
            t = t.match({
                domRange: function(t) {
                    return mn.fromDom(t.startContainer)
                },
                relative: function(t, e) {
                    return Aa.getStart(t)
                },
                exact: function(t, e, n, r) {
                    return t
                }
            });
            return Vr(t)
        },
        range: Ea
    }, La = function(t) {
        t = t.dom;
        null !== t.parentNode && t.parentNode.removeChild(t)
    }, Oa = function(r, o, i) {
        if (0 === o.length)
            throw new Error("You must specify at least one required field.");
        var n;
        return function(e, t) {
            if (!Q(t))
                throw new Error("The " + e + " fields must be an array. Was: " + t + ".");
            ct(t, function(t) {
                if (!J(t))
                    throw new Error("The value " + t + " in the " + e + " fields was not a string.")
            })
        }("required", o),
            n = zu(o),
            _(n, function(t, e) {
                return e < n.length - 1 && t === n[e + 1]
            }).each(function(t) {
                throw new Error("The field: " + t + " occurs more than once in the combined fields: [" + n.join(", ") + "].")
            }),
            function(e) {
                var n = Ot(e);
                D(o, function(t) {
                    return S(n, t)
                }) || function(t, e) {
                    throw new Error("All required keys (" + zu(t).join(", ") + ") were not specified. Specified keys were: " + zu(e).join(", ") + ".")
                }(o, n),
                    r(o, n);
                var t = st(o, function(t) {
                    return !i.validate(e[t], t)
                });
                return 0 < t.length && function(t, e) {
                    throw new Error("All values need to be of type: " + e + ". Keys (" + zu(t).join(", ") + ") were not.")
                }(t, i.label),
                    e
            }
    }, Da = function(t, e) {
        return qu(t) ? t.style.getPropertyValue(e) : ""
    }, t = wo(), On = t.browser, Pn = (On.isEdge() && On.version.major < 16 || t.deviceType.isiOS(),
        Oa(Yu, ["doc", "win", "body", "getSelection", "setSelection"], {
            validate: et,
            label: "function"
        }),
        Bt("ephox-sloth").resolve), Na = l(Pn("bin")), On = wo(), Ca = l(On.browser.isIE() && On.browser.version.major <= 10), Pa = Ca() ? function(t, e, n) {
            e.control.block(),
                t.dom.execCommand("paste"),
                n(),
                e.control.unblock()
        }
        : function(t, e, n) {
            setTimeout(n, 1)
        }
        , ka = function(t) {
        return "rtl" === Xu(t, "direction") ? "rtl" : "ltr"
    }, Ra = ["b", "i", "u", "sub", "sup", "strike"], Ma = function(t, r) {
        t = So(t);
        ct(t, function(t) {
            var e, n;
            r(t) && (n = So(e = t),
                t = mn.fromTag("div", qr(e).dom),
                Zi(t, n),
                tu(e, t),
                La(e))
        })
    }, Fa = Na(), ja = Fa + $t(""), Ua = (ia = "-100000px",
            ua = "100000px",
            function(t) {
                return "rtl" === ka(t) ? ua : ia
            }
    ), Ha = {
        set: function(t, e) {
            Mu(t, e.startContainer(), e.startOffset(), e.endContainer(), e.endOffset())
        },
        get: function(t) {
            return Uu(t).map(oa)
        }
    };
    function Ba(c) {
        return function(e) {
            var i, r, u, a, n = Go({
                after: Vo(["container"])
            }), o = (i = Ha,
                r = mn.fromTag("br"),
                u = G.none(),
                a = function(t) {
                    return Vr(t).dom
                }
                ,
                {
                    cleanup: function() {
                        La(r)
                    },
                    toOn: function(r, t) {
                        var o = a(t);
                        u.each(function(t) {
                            var e = r.dom.childNodes.length
                                , n = Yr(r, t.startContainer()) && e < t.startOffset() ? e : t.startOffset()
                                , e = Yr(r, t.endContainer()) && e < t.endOffset() ? e : t.endOffset()
                                , e = Wu(t.startContainer(), n, t.endContainer(), e);
                            i.set(o, e)
                        })
                    },
                    toOff: function(t, e) {
                        var n = a(e);
                        eu(e, r),
                            u = i.get(n),
                            i.set(n, Wu(r, 0, r, 0))
                    }
                }), t = ra(o, e, c);
            t.events.after.bind(function(t) {
                o.toOn(e, t.container),
                    n.trigger.after(t.container)
            });
            return {
                run: function() {
                    t.instance()()
                },
                events: n.registry
            }
        }
    }
    function Wa() {
        var n = {};
        return {
            getOrSetIndexed: function(t, e) {
                return void 0 !== n[t] ? n[t] : (t = t,
                    e = e(),
                    n[t] = e)
            },
            waitForLoad: function() {
                var t = F(n, function(t) {
                    return t
                });
                return Zt(t)
            }
        }
    }
    function za(t, e) {
        t = function(t) {
            t = t.dom.head;
            if (null == t)
                throw new Error("Head is not available yet");
            return mn.fromDom(t)
        }(t),
            eu(t, e)
    }
    function Ya(u, a) {
        return Kt.nu(function(e) {
            function n(t) {
                ct(i, function(t) {
                    t.unbind()
                }),
                    e(t.fold(function(t) {
                        return zo.error(t + 'Unable to download editor stylesheets from "' + u + '"')
                    }, zo.value))
            }
            var t, r, o, r = (t = u,
                o = r || mn.fromDom(document),
                r = mn.fromTag("link", o.dom),
                Me(r, {
                    rel: "stylesheet",
                    type: "text/css",
                    href: t
                }),
                za(o, r),
                r), i = [Do(r, "load", function(t) {
                !function(t) {
                    try {
                        var e = t.target.dom.sheet.cssRules;
                        return Z(e) && 0 === e.length
                    } catch (t) {}
                    return !1
                }(t) ? a(n) : n(zo.error(""))
            }), Do(r, "error", p(n, zo.error("")))]
        })
    }
    function qa(t) {
        return e = t,
            t = !1,
            mn.fromDom(e.dom.cloneNode(t));
        var e
    }
    function $a(t, n) {
        return G.from(t.dom.nodeValue).bind(function(t) {
            var e = t.indexOf("]>")
                , t = function(e) {
                try {
                    return (new DOMParser).parseFromString(e, "text/html").body
                } catch (t) {
                    var n = document.implementation.createHTMLDocument("").body;
                    return n.innerHTML = e,
                        n
                }
            }("<div>" + t.slice(e + "]>".length, t.lastIndexOf("<![")) + "</div>");
            return Po(mn.fromDom(t), function(t) {
                return Ce(t) === n
            })
        })
    }
    function Va(t) {
        return (on(t = t) ? $a(t, "v:shape") : G.none()).map(function(t) {
            var n, e = ln(t, "o:spid"), r = void 0 === e ? Fe(t, "id").getOr("") : e, e = mn.fromTag("img");
            return Li(e, "rtf-data-image"),
                fn(e, "data-image-id", r.substr("_x0000_".length)),
                fn(e, "data-image-type", "code"),
                r = e,
                t = {
                    width: Ju(t, "width"),
                    height: Ju(t, "height")
                },
                n = r.dom,
                R(t, function(t, e) {
                    t.fold(function() {
                        Vu(n, e)
                    }, function(t) {
                        $u(n, e, t)
                    })
                }),
                e
        })
    }
    function Ga(t) {
        if (ke("img")(t)) {
            var e = ln(t, "src");
            if (null != e && kt(e, "file://")) {
                t = qa(t),
                    e = e.split(/[\/\\]/),
                    e = e[e.length - 1];
                return fn(t, "data-image-id", e),
                    Ue(t, "src"),
                    fn(t, "data-image-type", "local"),
                    Li(t, "rtf-data-image"),
                    G.some(t)
            }
            return G.none()
        }
        return G.none()
    }
    function Ka(t, e) {
        var n = Ce(t)
            , r = e.name
            , e = void 0 !== e.condition ? e.condition : m;
        return Lc.matches(r, n) && e(t)
    }
    function Xa(t, e) {
        var n, r = at(t.dom.attributes, function(t) {
            return t.name
        });
        j(e) !== r.length && (n = t,
            e = e,
            ct(r, function(t) {
                Ue(n, t)
            }),
            R(e, function(t, e) {
                fn(n, e, t)
            }))
    }
    function Ja(t, e, n) {
        var r, t = t.dom.getAttribute("style"), o = (r = {},
            t = E(t = t) ? t.split(";") : [],
            ct(t, function(t) {
                t = t.split(":");
                2 === t.length && (r[Mt(t[0])] = Mt(t[1]))
            }),
            r), i = {};
        return ct(e, function(t) {
            var e = o[t];
            void 0 === e || n(e, t) || (i[t] = e)
        }),
            i
    }
    function Za(e) {
        var t = Ot(e);
        return at(t, function(t) {
            return t + ": " + e[t]
        }).join("; ")
    }
    function Qa(t, e) {
        var n, r, o, i = Ja(t, Oc, e);
        !function(n, t, e) {
            fn(n, "style", "");
            var r = j(t)
                , o = j(e);
            0 === r && 0 === o ? Ue(n, "style") : 0 === r ? fn(n, "style", Za(e)) : (R(t, function(t, e) {
                Gu(n, e, t)
            }),
                t = ln(n, "style"),
                e = 0 < o ? Za(e) + "; " : "",
                fn(n, "style", e + t))
        }(t, (r = e,
            t = (n = t).dom.style,
            t = w(t) ? [] : t,
            o = {},
            ct(t, function(e) {
                Ju(n, e).each(function(t) {
                    r(t, e) || (o[e] = t)
                })
            }),
            o), i)
    }
    function tc(t, e) {
        var n, r, e = (n = e,
            r = {},
            ct(t.dom.attributes, function(t) {
                n(t.value, t.name) || (r[t.name] = t.value)
            }),
            r);
        Xa(t, e)
    }
    function ec(t, e, c) {
        t(c, function(u, a) {
            return ut(e, function(t) {
                return e = c,
                    n = u,
                    r = a,
                    i = (o = t).name,
                    t = void 0 !== o.condition ? o.condition : m,
                    o = void 0 !== o.value ? o.value : Lc.all(),
                Lc.matches(i, r) && Lc.matches(o, n) && t(e);
                var e, n, r, o, i
            })
        })
    }
    function nc(t, e, n) {
        var r, o, i = mn.fromDom(t);
        switch (t.nodeType) {
            case 1:
                e ? r = Nc : (r = Dc,
                    Ku(i, n || {}));
                var n = t
                    , u = ("HTML" !== n.scopeName && n.scopeName && n.tagName && n.tagName.indexOf(":") <= 0 ? n.scopeName + ":" + n.tagName : n.tagName).toLowerCase();
                break;
            case 3:
                r = Cc,
                    o = t.nodeValue;
                break;
            case 8:
                r = Pc,
                    o = t.nodeValue;
                break;
            default:
                console.log("WARNING: Unsupported node type encountered: " + t.nodeType)
        }
        return {
            getNode: function() {
                return t
            },
            tag: function() {
                return u
            },
            type: function() {
                return r
            },
            text: function() {
                return o
            }
        }
    }
    function rc(t, e, n, r) {
        var o = r.createElement(t);
        return R(e, function(t, e) {
            o.setAttribute(e, t + "")
        }),
            nc(o, !1, n)
    }
    function oc(t, e) {
        return nc(e.createElement(t), !0)
    }
    function ic(n) {
        var r = n.createDocumentFragment()
            , o = r
            , i = function(t) {
            o.appendChild(t)
        };
        return {
            dom: r,
            receive: function(t) {
                var e;
                switch (t.type()) {
                    case Dc:
                        !function(t) {
                            t = t.getNode().cloneNode(!1);
                            i(t = t),
                                o = t
                        }(t);
                        break;
                    case Cc:
                        !function(t) {
                            t = n.createTextNode(t.text());
                            i(t)
                        }(t);
                        break;
                    case Nc:
                        e = o.parentNode,
                            o = null === e ? r : e;
                        break;
                    case Pc:
                        break;
                    default:
                        throw {
                            message: "Unsupported token type: " + t.type()
                        }
                }
            },
            label: "SERIALISER"
        }
    }
    function uc(t, r) {
        void 0 === r && (r = window.document);
        var o = r.createElement("div");
        r.body.appendChild(o),
            o.style.position = "absolute",
            o.style.left = "-10000px",
            o.innerHTML = t;
        var i = o.firstChild || kc
            , u = []
            , a = !1;
        return {
            hasNext: function() {
                return void 0 !== i
            },
            next: function() {
                var t = i
                    , e = i
                    , n = a;
                return !a && t.firstChild ? (u.push(t),
                    i = t.firstChild) : a = !a && 1 === t.nodeType || (t.nextSibling ? (i = t.nextSibling,
                    !1) : (i = u.pop(),
                    !0)),
                e === kc || i || (r.body.removeChild(o),
                    i = kc),
                    n = n,
                    (e = e) === kc ? e : e ? nc(e, n) : void 0
            }
        }
    }
    function ac(n) {
        return function(t) {
            var e;
            t = t,
                e = Ic({
                    tags: []
                }, n),
                t = Ro(t, "*"),
                ct(t, function(t) {
                    ut(e.tags, p(Ka, t)) && Bu(t)
                })
        }
    }
    function cc(e) {
        return function(t) {
            var n;
            t = t,
                n = Ic({
                    tags: []
                }, e),
                t = Ro(t, "*"),
                ct(t, function(e) {
                    _(n.tags, p(Ka, e)).each(function(t) {
                        t.mutate(e)
                    })
                })
        }
    }
    function sc(n) {
        return function(t) {
            var e = Qu(t)
                , e = function(t, e, n) {
                for (var r = ic(t), o = uc(e, t), i = function(t, e, n) {
                    for (var r = n, o = e.length - 1; 0 <= o; o--)
                        r = e[o](r, {}, t);
                    return r
                }(t, n, r); o.hasNext(); ) {
                    var u = o.next();
                    i.receive(u)
                }
                return r.dom
            }(qr(t).dom, e, n);
            Hu(t),
                t.dom.appendChild(e)
        }
    }
    function fc(t, e, n) {
        var r = mn.fromTag("div", t.dom);
        return r.dom.innerHTML = e,
            ct(n, function(t) {
                t(r)
            }),
            Qu(r)
    }
    function lc(i, t) {
        return function(e) {
            var n = function(t) {
                e.receive(t)
            }
                , r = function(t, e, n) {
                return n = void 0 !== n ? n : t.type() === Nc,
                    nc(e, n, {})
            }
                , o = {
                emit: n,
                emitTokens: function(t) {
                    ct(t, n)
                },
                receive: function(t) {
                    i(o, t, r)
                },
                document: window.document
            };
            return t(o),
                o
        }
    }
    function dc(t, e) {
        if (void 0 === t || void 0 === e)
            throw console.trace(),
                new Error("brick");
        t.nextFilter.set(e)
    }
    function mc(t, e) {
        return je(mn.fromDom(e.getNode()), "data-list-level")
    }
    function pc(t) {
        if (S(["p"], t.tag())) {
            t = function(t, e) {
                t = mn.fromDom(t.getNode());
                return ln(t, e)
            }(t, "class");
            return E(t) && /^MsoHeading/.test(t)
        }
        return 1
    }
    function gc(t, e, n, r) {
        var o, i, u = n.getCurrentListType(), u = n.getCurrentLevel() == r.level() ? u : null;
        return o = r.emblems(),
            i = u,
            _(o, function(t) {
                return "ul" === t.tag || E(i) && Rc(t, i, !0)
            }).orThunk(function() {
                return C(o)
            }).filter(function(t) {
                return !("ol" === t.tag && pc(e))
            })
    }
    function vc(t, e, n) {
        return gc(n.listType.get(), t, n.emitter, e).each(n.listType.set),
            t = e.level(),
            e = n.originalToken.get(),
            n = n.listType.get(),
            {
                level: l(t),
                token: l(e),
                type: l(n)
            }
    }
    function hc(u) {
        return function(t, e, n) {
            var r, o, i = n, n = (r = mn.fromDom(i.getNode()),
                o = parseInt(ln(r, "data-list-level"), 10),
                n = ln(r, "data-list-emblems"),
                n = E(n) ? JSON.parse(n) : [],
                Ue(r, "data-list-level"),
                Ue(r, "data-list-emblems"),
                {
                    level: l(o),
                    emblems: l(n)
                });
            e.originalToken.set(i);
            n = vc(i, n, e);
            e.emitter.openItem(n.level(), n.token(), n.type()),
                dc(e, u.inside())
        }
    }
    function yc(t, e, n) {
        return {
            pred: t,
            action: e,
            label: l(n)
        }
    }
    var bc, xc, Tc, wc = function(a) {
        var c = p(Ne, a);
        Ne("callbacks", c());
        function e(n, r) {
            var t, e, o, i = c(), u = (e = void 0 === (t = i).count ? 0 : t.count,
                o = "callback_" + e,
                t.count = e + 1,
                o);
            return i.callbacks[u] = function() {
                for (var t = [], e = 0; e < arguments.length; e++)
                    t[e] = arguments[e];
                r || s(u),
                    n.apply(null, t)
            }
                ,
            a + ".callbacks." + u
        }
        var s = function(t) {
            var e = t.substring(t.lastIndexOf(".") + 1)
                , t = c();
            void 0 !== t.callbacks[e] && delete t.callbacks[e]
        };
        return {
            ephemeral: function(t) {
                return e(t, !1)
            },
            permanent: function(t) {
                return e(t, !0)
            },
            unregister: s
        }
    }("ephox.henchman.features"), Ec = (bc = Wa(),
        {
            preload: function() {
                xc().get(u)
            },
            addStylesheet: function(t, e) {
                return bc.getOrSetIndexed(t, function() {
                    return Ya(t, e)
                })
            },
            addScript: function(t, e) {
                return bc.getOrSetIndexed(t, function() {
                    return i = t,
                        Kt.nu(function(e) {
                            function t() {
                                r.unbind(),
                                    o.unbind()
                            }
                            var n = mn.fromTag("script");
                            fn(n, "src", i),
                                fn(n, "type", "text/javascript"),
                                fn(n, "async", "async"),
                                fn(n, "data-main", wc.ephemeral(function(t) {
                                    e(zo.value(t))
                                }));
                            var r = Do(n, "error", function() {
                                t(),
                                    e(zo.error("Error loading external script tag " + i))
                            })
                                , o = Do(n, "load", t);
                            eu(mn.fromDom(document.head), n)
                        }).map(e);
                    var i
                })
            },
            waitForLoad: xc = function() {
                return bc.waitForLoad()
            }
        }), Sc = {
        loadScript: function(t, o) {
            return new Vt(function(e, n) {
                    var t, r;
                    t = o,
                        r = u,
                        Ec.addScript(t, r).get(function(t) {
                            t.fold(n, e)
                        })
                }
            )
        }
    }, Ac = Object.prototype.hasOwnProperty, Ic = (Tc = function(t, e) {
            return e
        }
            ,
            function() {
                for (var t = new Array(arguments.length), e = 0; e < t.length; e++)
                    t[e] = arguments[e];
                if (0 === t.length)
                    throw new Error("Can't merge zero objects");
                for (var n = {}, r = 0; r < t.length; r++) {
                    var o, i = t[r];
                    for (o in i)
                        Ac.call(i, o) && (n[o] = Tc(n[o], i[o]))
                }
                return n
            }
    ), t = jt([{
        starts: ["value", "f"]
    }, {
        pattern: ["regex", "f"]
    }, {
        contains: ["value", "f"]
    }, {
        exact: ["value", "f"]
    }, {
        all: []
    }, {
        not: ["stringMatch"]
    }]), _c = function(t, n) {
        return t.fold(function(t, e) {
            return 0 === e(n).indexOf(e(t))
        }, function(t, e) {
            return t.test(e(n))
        }, function(t, e) {
            return 0 <= e(n).indexOf(e(t))
        }, function(t, e) {
            return e(n) === e(t)
        }, function() {
            return !0
        }, function(t) {
            return !_c(t, n)
        })
    }, Lc = {
        starts: t.starts,
        pattern: t.pattern,
        contains: t.contains,
        exact: t.exact,
        all: t.all,
        not: t.not,
        cata: function(t, e, n, r, o, i, u) {
            return t.fold(e, n, r, o, i, u)
        },
        matches: _c,
        caseSensitive: function(t) {
            return t
        },
        caseInsensitive: function(t) {
            return t.toLowerCase()
        }
    }, Oc = ["mso-list"], Dc = "startElement", Nc = "endElement", Cc = "text", Pc = "comment", kc = oc("html", window.document), Pn = function(e) {
        return function(t) {
            !function(t, e) {
                var r = Ic({
                    styles: [],
                    attributes: [],
                    classes: [],
                    tags: []
                }, e)
                    , e = Ro(t, "*");
                ct(e, function(n) {
                    ec(Qa, r.styles, n),
                        ec(tc, r.attributes, n),
                        ct(r.classes, function(e) {
                            var t = je(n, "class") ? Ni(n) : [];
                            ct(t, function(t) {
                                Lc.matches(e.name, t) && Oi(n, t)
                            })
                        })
                });
                t = Ro(t, "*");
                ct(t, function(t) {
                    ut(r.tags, p(Ka, t)) && La(t)
                })
            }(t, e)
        }
    }, Rc = function(t, e, n) {
        return void 0 === n && (n = !1),
        t === e || E(t) && E(e) && t.tag === e.tag && t.type === e.type && (n || t.variant === e.variant)
    };
    function Mc(t, r, o) {
        function e(t, e, n) {
            _(r, function(t) {
                return t.pred(e, n)
            }).fold(l(o), function(t) {
                return t.action
            })(t, e, n)
        }
        return e.toString = function() {
            return "Handlers for " + t
        }
            ,
            e
    }
    function Fc(t, e) {
        return {
            state: l(t),
            result: l(e)
        }
    }
    function jc(t, e) {
        return {
            state: l(t),
            value: l(e)
        }
    }
    function Uc(t, e, n, r) {
        return {
            level: l(t),
            type: l(e),
            types: l(n),
            items: l(r)
        }
    }
    function Hc(t) {
        var e = t.items().slice(0);
        if (0 < e.length && "p" !== e[e.length - 1]) {
            var n = e[e.length - 1];
            e[e.length - 1] = "p";
            e = Uc(t.level(), t.type(), t.types(), e);
            return jc(e, G.some(n))
        }
        return jc(t, G.none())
    }
    function Bc(t, e, n) {
        for (var r = [], o = t; e(o); )
             var i = n(o)
                 , o = i.state()
                 , r = r.concat(i.result());
        return Fc(o, r)
    }
    function Wc(t) {
        return t = function(t, e) {
            t = mn.fromDom(t.getNode());
            return Xu(t, e)
        }(t, "margin-left"),
            E(t) && "0px" !== t ? {
                "margin-left": t
            } : {}
    }
    function zc(t, e, n) {
        var r = e.start && 1 < e.start ? {
            start: e.start
        } : {}
            , o = t.level() + 1
            , i = e
            , u = t.types().concat([e])
            , n = [p(rc, e.tag, r, n)]
            , t = Uc(o, i, u, t.items());
        return Fc(t, n)
    }
    function Yc(t) {
        var e = t.types().slice(0)
            , n = [p(oc, e.pop().tag)]
            , r = t.level() - 1
            , o = e[e.length - 1]
            , t = Uc(r, o, e, t.items());
        return Fc(t, n)
    }
    function qc(t, o, e) {
        var n = (r = o) ? Wc(r) : {
            "list-style-type": "none"
        }
            , r = t.type() && !Rc(t.type(), e) ? function(t, e) {
            t = Yc(t),
                e = zc(t.state(), e, e.type ? {
                    "list-style-type": e.type
                } : {});
            return Fc(e.state(), t.result().concat(e.result()))
        }(t, e) : Fc(t, [])
            , e = [p(rc, "li", {}, n)]
            , n = (t = function(t, e) {
            var n = t.items().slice(0)
                , e = void 0 !== e && "p" !== e ? G.some(e) : G.none();
            e.fold(function() {
                n.push("p")
            }, function(t) {
                n.push(t)
            });
            t = Uc(t.level(), t.type(), t.types(), n);
            return jc(t, e)
        }(r.state(), o && o.tag())).value().map(function(t) {
            var e, n, r = o;
            return e = r.getNode(),
                n = l(!0),
                Qa(mn.fromDom(e), n),
                [l(r)]
        }).getOr([]);
        return Fc(t.state(), r.result().concat(e).concat(n))
    }
    function $c(t) {
        var e = p(oc, "li")
            , n = Hc(t)
            , t = n.value().fold(function() {
            return [e]
        }, function(t) {
            return [p(oc, t), e]
        });
        return Fc(n.state(), t)
    }
    function Vc(t) {
        if (0 === t.length)
            throw "Compose must have at least one element in the list";
        var e = t[t.length - 1]
            , t = ft(t, function(t) {
            return t.result()
        });
        return Fc(e.state(), t)
    }
    function Gc(t) {
        var e = $c(t)
            , t = Yc(e.state());
        return Vc([e, t])
    }
    function Kc(t, i, u, a) {
        return e = u,
            Bc(t, function(t) {
                return t.level() < e
            }, function(t) {
                return n = i,
                    r = u,
                    o = a,
                    t = (e = t).level() === r - 1 && n.type ? {
                        "list-style-type": n.type
                    } : {},
                    t = zc(e, n, t),
                    n = qc(t.state(), t.state().level() == r ? o : void 0, n),
                    Vc([t, n]);
                var e, n, r, o
            });
        var e
    }
    function Xc(t, e) {
        return n = e,
            Bc(t, function(t) {
                return t.level() > n
            }, Gc);
        var n
    }
    function Jc(t, e, n, r) {
        var o = t.level() > e ? Xc(t, e) : Fc(t, [])
            , i = o.state().level() === e ? function(t, e, n) {
            t = 0 < t.level() ? $c(t) : Fc(t, []),
                e = qc(t.state(), n, e);
            return Vc([t, e])
        }(o.state(), r, n) : (t = o.state(),
            r = r,
            i = n,
            e = 1 < (n = e) ? Hc(t) : jc(t, G.none()),
            t = e.value().map(function(t) {
                return [p(oc, t)]
            }).getOr([]),
            i = Kc(e.state(), r, n, i),
            Fc(i.state(), t.concat(i.result())));
        return Vc([o, i])
    }
    function Zc(e, n) {
        function o(t) {
            ct(t.result(), function(t) {
                t = t(n);
                e.emit(t)
            })
        }
        var i = Uc(0, void 0, [], []);
        return {
            closeAllLists: function() {
                var t = Qc(i, 0);
                i = t.state(),
                    o(t)
            },
            openItem: function(t, e, n) {
                var r;
                n && (r = t,
                    n = "ul" === (n = n).tag && ts[r - 1] === n.type ? {
                        tag: "ul"
                    } : n,
                    n = Jc(i, t, e, n),
                    i = n.state(),
                    o(n))
            },
            getCurrentListType: function() {
                return i.type()
            },
            getCurrentLevel: function() {
                return i.level()
            }
        }
    }
    var Qc = Xc
        , ts = ["disc", "circle", "square"]
        , es = {
        getCurrentListType: function() {
            return ns().getCurrentListType()
        },
        getCurrentLevel: function() {
            return ns().getCurrentLevel()
        },
        closeAllLists: function() {
            return ns().closeAllLists.apply(void 0, arguments)
        },
        openItem: function() {
            return ns().openItem.apply(void 0, arguments)
        }
    }
        , ns = function() {
        return {
            getCurrentListType: l({}),
            getCurrentLevel: l(1),
            closeAllLists: y,
            openItem: u
        }
    };
    function rs(t) {
        for (var e = []; null !== t.nextNode(); )
            e.push(mn.fromDom(t.currentNode));
        return e
    }
    function os(t) {
        var e = wo().browser;
        return (e.isIE() || e.isEdge() ? function(t) {
                try {
                    return rs(t)
                } catch (t) {
                    return []
                }
            }
            : rs)(t)
    }
    function is(t) {
        return t.dom.textContent
    }
    function us(o, t) {
        var e = Us[o] ? [Us[o]] : []
            , n = t && js[o] ? [js[o]] : t ? [{
            tag: "ul",
            variant: o
        }] : []
            , t = ft(Fs, function(t) {
            return t.regex.test(o) ? [Ic(t.type, (n = (e = o).split("."),
                r = function() {
                    if (0 === n.length)
                        return e;
                    var t = n[n.length - 1];
                    return 0 === t.length && 1 < n.length ? n[n.length - 2] : t
                }(),
                r = parseInt(r, 10),
                isNaN(r) ? {} : {
                    start: r
                }), {
                variant: (r = t.type,
                    t = o,
                    void 0 !== r.variant ? r.variant : "(" === t.charAt(0) ? "()" : ")" === t.charAt(t.length - 1) ? ")" : ".")
            })] : [];
            var e, n, r
        })
            , t = e.concat(n).concat(t);
        return at(t, function(t) {
            return void 0 !== t.variant ? t : Ic(t, {
                variant: o
            })
        })
    }
    function as(t) {
        return t = Ja(t, ["mso-list"], d)["mso-list"],
            (t = E(t) && / level([0-9]+)/.exec(t)) && t[1] ? G.some(parseInt(t[1], 10)) : G.none()
    }
    function cs(t, e) {
        return t = is(t).trim(),
            0 < (e = us(t, e)).length ? G.some(e) : G.none()
    }
    function ss(t) {
        return Co(t, on).bind(Jr).filter(ke("span"))
    }
    function fs(t) {
        return Po(t, function(t) {
            return (un(t) ? Ja(t, ["mso-list"], d) : {})["mso-list"]
        })
    }
    function ls(t) {
        t = function(t, e) {
            e = e.fold(Ms, function(e) {
                return function(t) {
                    return e(t.nodeValue)
                }
            });
            e.acceptNode = e;
            e = document.createTreeWalker(t.dom, NodeFilter.SHOW_COMMENT, e, !1);
            return os(e)
        }(t, G.none()),
            ct(t, La)
    }
    function ds(t, e, n, r) {
        !function(t, e, n) {
            fn(t, "data-list-level", e);
            n = JSON.stringify(n);
            fn(t, "data-list-emblems", n)
        }(t, e, n),
            ls(t),
            ct(r, La),
            Ue(t, "style"),
            Ue(t, "class")
    }
    function ms(r) {
        return as(r).bind(function(n) {
            return Co(r, Hs).bind(function(e) {
                return cs(e, !0).map(function(t) {
                    return {
                        mutate: function() {
                            ds(r, n, t, [e])
                        }
                    }
                })
            })
        })
    }
    function ps(r) {
        return "p" !== Ce(r) ? G.none() : fs(r).bind(function(t) {
            var n = Gr(t).getOr(t)
                , e = Hs(n);
            return cs(t, e).bind(function(e) {
                return Ju(r, "margin-left").bind(function(t) {
                    t = parseInt(t, 10);
                    return isNaN(t) ? G.none() : G.some(Math.max(1, Math.ceil(t / 18)))
                }).map(function(t) {
                    return {
                        mutate: function() {
                            ds(r, t, e, [n])
                        }
                    }
                })
            })
        })
    }
    function gs(t) {
        return ms(t).orThunk(function() {
            return as(r = t).bind(function(n) {
                return ss(r).bind(function(e) {
                    return cs(e, Hs(e)).map(function(t) {
                        return {
                            mutate: function() {
                                ds(r, n, t, [e])
                            }
                        }
                    })
                })
            });
            var r
        }).orThunk(function() {
            return as(r = t).bind(function(n) {
                return ss(r).bind(function(e) {
                    return cs(e, Hs(e)).map(function(t) {
                        return {
                            mutate: function() {
                                ds(r, n, t, [e])
                            }
                        }
                    })
                })
            });
            var r
        }).orThunk(function() {
            return "p" !== Ce(r = t) ? G.none() : as(r).bind(function(n) {
                return fs(r).bind(function(e) {
                    return cs(e, !1).map(function(t) {
                        return {
                            mutate: function() {
                                ds(r, n, t, [Gr(e).getOr(e)])
                            }
                        }
                    })
                })
            });
            var r
        }).orThunk(function() {
            return ps(t)
        })
    }
    function vs(t, e) {
        var n = mn.fromTag(t);
        return tu(e, n),
            t = e.dom.attributes,
            ct(t, function(t) {
                n.dom.setAttribute(t.name, t.value)
            }),
            t = So(e),
            Zi(n, t),
            La(e),
            n
    }
    function hs(t) {
        var o = vs("span", t)
            , i = {
            "font-size": {
                1: "8pt",
                2: "10pt",
                3: "12pt",
                4: "14pt",
                5: "18pt",
                6: "24pt",
                7: "36pt"
            }
        };
        R({
            face: "font-family",
            size: "font-size",
            color: "color"
        }, function(n, r) {
            Fe(o, r).each(function(t) {
                var e = i[n]
                    , t = void 0 !== e && void 0 !== e[t] ? e[t] : t;
                Gu(o, n, t),
                    Ue(o, r)
            })
        })
    }
    function ys(t) {
        return "td" === (t = Ce(t)) || "tr" === t || "table" === t || "col" === t
    }
    function bs(t) {
        t = vs("span", t),
            Li(t, "ephox-limbo-transform"),
            Gu(t, "text-decoration", "underline")
    }
    var xs, Ts, ws, Es, Ss, As, Is, _s, Ls, Os, Ds, Ns = {
        inside: function() {
            return Ps
        },
        outside: function() {
            return ks
        }
    }, Cs = (xs = !1,
        {
            check: function(t) {
                return !(!xs || t.type() !== Cc) || (t.type() === Dc && "style" === t.tag() ? xs = !0 : t.type() === Nc && "style" === t.tag() && !(xs = !1))
            }
        }), Ps = (Ts = Ns,
        Mc("Inside.List.Item", [yc(function(t, e) {
            t = t.originalToken.get();
            return e.type() === Nc && null !== t && e.tag() === t.tag()
        }, function(t, e) {
            dc(e, Ts.outside())
        }, "Closing open tag")], function(t, e, n) {
            t.emit(n)
        })), ks = Mc("Outside.List.Item", [yc(mc, hc(ws = Ns), "Data List ****"), yc(function(t, e) {
        return e.type() === Cc && ((e = e).type() === Cc && /^[\s\u00A0]*$/.test(e.text()))
    }, function(t, e, n) {
        t.emit(n)
    }, "Whitespace")], function(t, e, n) {
        e.emitter.closeAllLists(),
            t.emit(n),
            dc(e, ws.outside())
    }), Rs = (Ss = fu(Es = ks),
        As = fu(null),
        Is = fu(null),
        {
            reset: function(t) {
                Ss.set(Es),
                    As.set(null),
                    Is.set(null);
                t = Zc(t, t.document);
                ns = l(t)
            },
            nextFilter: Ss,
            originalToken: As,
            listType: Is,
            emitter: es
        }), On = lc(function(t, e, n) {
        var r;
        Cs.check(e) || (r = t,
            t = e,
            (e = Rs).nextFilter.get()(r, e, t))
    }, Rs.reset), Ms = l(m), Fs = [{
        regex: /^\(?[dc][\.\)]$/,
        type: {
            tag: "ol",
            type: "lower-alpha"
        }
    }, {
        regex: /^\(?[DC][\.\)]$/,
        type: {
            tag: "ol",
            type: "upper-alpha"
        }
    }, {
        regex: /^\(?M*(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})[\.\)]$/,
        type: {
            tag: "ol",
            type: "upper-roman"
        }
    }, {
        regex: /^\(?m*(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})[\.\)]$/,
        type: {
            tag: "ol",
            type: "lower-roman"
        }
    }, {
        regex: /^\(?[0-9]+[\.\)]$/,
        type: {
            tag: "ol"
        }
    }, {
        regex: /^([0-9]+\.)*[0-9]+\.?$/,
        type: {
            tag: "ol",
            variant: "outline"
        }
    }, {
        regex: /^\(?[a-z]+[\.\)]$/,
        type: {
            tag: "ol",
            type: "lower-alpha"
        }
    }, {
        regex: /^\(?[A-Z]+[\.\)]$/,
        type: {
            tag: "ol",
            type: "upper-alpha"
        }
    }], js = {
        "\u2022": {
            tag: "ul",
            type: "disc"
        },
        "\xb7": {
            tag: "ul",
            type: "disc"
        },
        "\xa7": {
            tag: "ul",
            type: "square"
        }
    }, Us = {
        o: {
            tag: "ul",
            type: "circle"
        },
        "-": {
            tag: "ul",
            type: "disc"
        },
        "\u25cf": {
            tag: "ul",
            type: "disc"
        },
        "\ufffd": {
            tag: "ul",
            type: "circle"
        }
    }, Hs = function(t) {
        return un(t) && Ju(t, "font-family").exists(function(t) {
            return S(["wingdings", "symbol"], t.toLowerCase())
        })
    }, Bs = cc({
        tags: [{
            name: Lc.pattern(/^(p|h\d+)$/, Lc.caseInsensitive),
            mutate: function(t) {
                gs(t).each(function(t) {
                    t.mutate()
                })
            }
        }]
    }), t = On, Ws = function(t) {
        t = t.dom.attributes;
        return null == t || (0 === t.length || 1 === t.length && "style" === t[0].name)
    }, zs = ke("li"), Ys = function(t) {
        return Xr(t).bind(function(t) {
            return an(t) && 0 === Ou(t).trim().length ? Ys(t) : zs(t) ? G.some(t) : G.none()
        })
    }, On = function(e) {
        return function(t) {
            return Ce(t) === e
        }
    }, qs = ac({
        tags: [{
            name: Lc.pattern(/^([OVWXP]|U[0-9]+|ST[0-9]+):/i, Lc.caseInsensitive)
        }]
    }), $s = Pn({
        attributes: [{
            name: Lc.exact("id", Lc.caseInsensitive),
            value: Lc.starts("docs-internal-guid", Lc.caseInsensitive)
        }]
    }), Vs = [sc([t])], Gs = Pn({
        attributes: [{
            name: Lc.pattern(/^v:/, Lc.caseInsensitive)
        }, {
            name: Lc.exact("href", Lc.caseInsensitive),
            value: Lc.contains("#_toc", Lc.caseInsensitive)
        }, {
            name: Lc.exact("href", Lc.caseInsensitive),
            value: Lc.contains("#_mso", Lc.caseInsensitive)
        }, {
            name: Lc.pattern(/^xmlns(:|$)/, Lc.caseInsensitive)
        }, {
            name: Lc.exact("type", Lc.caseInsensitive),
            condition: function(t) {
                return "ol" === Ce(t) || "ul" === Ce(t)
            }
        }]
    }), Ks = Pn({
        tags: [{
            name: Lc.exact("script", Lc.caseInsensitive)
        }, {
            name: Lc.exact("link", Lc.caseInsensitive)
        }, {
            name: Lc.exact("style", Lc.caseInsensitive),
            condition: function(t) {
                return 0 === Qu(t).length
            }
        }],
        attributes: [{
            name: Lc.starts("on", Lc.caseInsensitive)
        }, {
            name: Lc.exact('"', Lc.caseInsensitive)
        }, {
            name: Lc.exact("lang", Lc.caseInsensitive)
        }, {
            name: Lc.exact("language", Lc.caseInsensitive)
        }],
        styles: [{
            name: Lc.all(),
            value: Lc.pattern(/OLE_LINK/i, Lc.caseInsensitive)
        }]
    }), Xs = Pn({
        tags: [{
            name: Lc.exact("meta", Lc.caseInsensitive)
        }]
    }), Js = Pn({
        tags: [{
            name: Lc.exact("style", Lc.caseInsensitive)
        }]
    }), Zs = Pn({
        styles: [{
            name: Lc.not(Lc.pattern(/^(width|height|list-style-type)$/, Lc.caseInsensitive)),
            condition: function(t) {
                return !Di(t, "ephox-limbo-transform")
            }
        }, {
            name: Lc.pattern(/^(width|height)$/, Lc.caseInsensitive),
            condition: function(t) {
                return "img" !== Ce(t) && !ys(t)
            }
        }]
    }), Qs = Pn({
        styles: [{
            name: Lc.exact("height", Lc.caseInsensitive),
            condition: On("td")
        }, {
            name: Lc.exact("width", Lc.caseInsensitive),
            condition: On("tr")
        }, {
            name: Lc.exact("height", Lc.caseInsensitive),
            condition: On("col")
        }]
    }), tf = Pn({
        classes: [{
            name: Lc.not(Lc.exact("rtf-data-image", Lc.caseInsensitive))
        }]
    }), ef = Pn({
        styles: [{
            name: Lc.pattern(/^(mso-.*|tab-stops|tab-interval|language|text-underline|text-effect|text-line-through|font-color|horiz-align|list-image-[0-9]+|separator-image|table-border-color-(dark|light)|vert-align|vnd\..*)$/, Lc.caseInsensitive)
        }]
    }), nf = Pn({
        classes: [{
            name: Lc.pattern(/mso/i, Lc.caseInsensitive)
        }]
    }), rf = ac({
        tags: [{
            name: Lc.exact("img", Lc.caseInsensitive),
            condition: function(t) {
                t = ln(t, "src");
                return J(t) && /^file:/.test(t)
            }
        }]
    }), of = ac({
        tags: [{
            name: Lc.exact("a", Lc.caseInsensitive),
            condition: Ws
        }]
    }), uf = Pn({
        attributes: [{
            name: Lc.exact("style", Lc.caseInsensitive),
            value: Lc.exact("", Lc.caseInsensitive)
        }]
    }), af = Pn({
        attributes: [{
            name: Lc.exact("class", Lc.caseInsensitive),
            value: Lc.exact("", Lc.caseInsensitive)
        }]
    }), cf = ac({
        tags: [{
            name: Lc.pattern(/^(font|em|strong|samp|acronym|cite|code|dfn|kbd|tt|b|i|u|s|sub|sup|ins|del|var|span)$/, Lc.caseInsensitive),
            condition: (_s = function(t) {
                    return !Ws(t) || (n = null != (n = (e = t).dom.attributes) && 0 < n.length,
                    ("span" !== Ce(e) || n) && ko(t, function(t) {
                        var e = !Ws(t)
                            , n = !S(["font", "em", "strong", "samp", "acronym", "cite", "code", "dfn", "kbd", "tt", "b", "i", "u", "s", "sub", "sup", "ins", "del", "var", "span"], Ce(t));
                        return an(t) || e || n
                    }));
                    var e, n
                }
                    ,
                    function(t) {
                        return !_s(t)
                    }
            )
        }]
    }), sf = ac({
        tags: [{
            name: Lc.exact("p", Lc.caseInsensitive),
            condition: (Ls = "li",
                    function(t) {
                        return Gr(t).exists(function(t) {
                            return Ce(t) === Ls && 1 === So(t).length
                        })
                    }
            )
        }]
    }), ff = cc({
        tags: [{
            name: Lc.exact("p", Lc.caseInsensitive),
            mutate: function(t) {
                0 === Qu(t).length && eu(t, mn.fromTag("br"))
            }
        }]
    }), lf = cc({
        tags: [{
            name: Lc.pattern(/ol|ul/, Lc.caseInsensitive),
            mutate: function(e) {
                Gr(e).each(function(t) {
                    t = Ce(t);
                    S(["ol", "ul"], t) && Ys(e).fold(function() {
                        var t = mn.fromTag("li");
                        Gu(t, "list-style-type", "none"),
                            Xi(e, t)
                    }, function(t) {
                        eu(t, e)
                    })
                })
            }
        }]
    }), df = Pn({
        classes: [{
            name: Lc.exact("ephox-limbo-transform", Lc.caseInsensitive)
        }]
    }), mf = Pn({
        tags: [{
            name: Lc.exact("br", Lc.caseInsensitive),
            condition: pn("Apple-interchange-newline")
        }]
    }), pf = Pn({
        styles: [{
            name: Lc.pattern(/^-/, Lc.caseInsensitive)
        }, {
            name: Lc.all(),
            value: Lc.exact("initial", Lc.caseInsensitive)
        }, {
            name: Lc.exact("background-color", Lc.caseInsensitive),
            value: Lc.exact("transparent", Lc.caseInsensitive)
        }, {
            name: Lc.exact("font-style", Lc.caseInsensitive),
            value: Lc.exact("normal", Lc.caseInsensitive)
        }, {
            name: Lc.pattern(/font-variant.*/, Lc.caseInsensitive)
        }, {
            name: Lc.exact("letter-spacing", Lc.caseInsensitive)
        }, {
            name: Lc.exact("font-weight", Lc.caseInsensitive),
            value: Lc.pattern(/400|normal/, Lc.caseInsensitive)
        }, {
            name: Lc.exact("orphans", Lc.caseInsensitive)
        }, {
            name: Lc.exact("text-decoration", Lc.caseInsensitive),
            value: Lc.exact("none", Lc.caseInsensitive)
        }, {
            name: Lc.exact("text-size-adjust", Lc.caseInsensitive)
        }, {
            name: Lc.exact("text-indent", Lc.caseInsensitive),
            value: Lc.exact("0px", Lc.caseInsensitive)
        }, {
            name: Lc.exact("text-transform", Lc.caseInsensitive),
            value: Lc.exact("none", Lc.caseInsensitive)
        }, {
            name: Lc.exact("white-space", Lc.caseInsensitive),
            value: Lc.exact("normal", Lc.caseInsensitive)
        }, {
            name: Lc.exact("widows", Lc.caseInsensitive)
        }, {
            name: Lc.exact("word-spacing", Lc.caseInsensitive),
            value: Lc.exact("0px", Lc.caseInsensitive)
        }, {
            name: Lc.exact("text-align", Lc.caseInsensitive),
            value: Lc.pattern(/start|end/, Lc.caseInsensitive)
        }, {
            name: Lc.exact("font-weight", Lc.caseInsensitive),
            value: Lc.pattern(/700|bold/, Lc.caseInsensitive),
            condition: function(t) {
                return /^h\d$/.test(Ce(t))
            }
        }]
    }), gf = (Os = vf(Xr, Rt),
        Ds = vf(Jr, kt),
        cc({
            tags: [{
                name: Lc.exact("span", Lc.caseInsensitive),
                condition: pn("Apple-converted-space"),
                mutate: function(t) {
                    "\xa0" === is(t) && (Os(t) || Ds(t) ? Bu(t) : (tu(t, mn.fromText(" ")),
                        La(t)))
                }
            }]
        }));
    function vf(t, n) {
        return function(e) {
            return t(e).filter(function(t) {
                return an(e) && n(is(t) || "", " ")
            }).isSome()
        }
    }
    var hf, yf = (hf = /^file:\/\/\/[^#]+(#[^#]+)$/,
        cc({
            tags: [{
                name: Lc.exact("a", Lc.caseInsensitive),
                condition: function(t) {
                    t = ln(t, "href");
                    return !!t && hf.test(t)
                },
                mutate: function(e) {
                    Fe(e, "href").each(function(t) {
                        fn(e, "href", t.replace(hf, "$1"))
                    })
                }
            }]
        })), bf = Pn({
        attributes: [{
            name: Lc.exact("href", Lc.caseInsensitive),
            value: Lc.starts("file:///", Lc.caseInsensitive)
        }]
    }), xf = cc({
        tags: [Tf("a", "data-ephox-href", "href"), Tf("img", "data-ephox-src", "src")]
    });
    function Tf(t, n, r) {
        return {
            name: Lc.exact(t, Lc.caseInsensitive),
            condition: function(t) {
                return je(t, n)
            },
            mutate: function(e) {
                Fe(e, n).each(function(t) {
                    fn(e, r, t),
                        Ue(e, n)
                })
            }
        }
    }
    function wf(i) {
        var u = ["table", "thead", "tbody", "tfoot", "th", "tr", "td", "ul", "ol", "li"]
            , t = Ko(i, on)
            , e = _(t, function(t) {
            return Pt(ca(t), "StartFragment")
        })
            , n = _(t, function(t) {
            return Pt(ca(t), "EndFragment")
        });
        e.each(function(o) {
            n.each(function(t) {
                for (var e = o, n = [], r = function(t, e, n, r) {
                    r = Cu(t, e, n, r);
                    return mn.fromDom(r.commonAncestorContainer)
                }(o, 0, t, 0); void 0 !== r && !Yr(r, i); )
                    S(u, Ce(r)) ? e = r : n.push(r),
                        r = Gr(r).getOrUndefined();
                ct(n, Bu),
                    ct(Zr(e), La)
            }),
                La(o)
        }),
            n.each(La)
    }
    function Ef(t, e) {
        return t = t,
            Sa.getOption(t).exists(function(t) {
                return 0 === e(t).length
            })
    }
    function Sf(t) {
        return t.browser.isIE() && 11 <= t.browser.version.major
    }
    function Af(n, i) {
        return lc(function(t, e) {
            var r, o, e = (r = e,
                o = i,
                n(mn.fromDom(r.getNode())).fold(function() {
                    return [r]
                }, function(t) {
                    var e = r.type() === Nc
                        , n = [nc(t.dom, e)];
                    return !e && o && n.push(nc(t.dom, !0)),
                        n
                }));
            t.emitTokens(e)
        }, y)
    }
    function If(t, e, n, r) {
        var o = [Df, ef, nf]
            , r = [Df, Zs, function(t) {
            void 0 === t && (t = []);
            t = at(t, function(t) {
                return {
                    name: Lc.exact(t, Lc.caseInsensitive)
                }
            });
            return ac({
                tags: t
            })
        }(r.cleanFilteredInlineElements), tf];
        return e ? o : r
    }
    function _f(t) {
        return void 0 === t && (t = []),
            [Nf, Cf, (e = t,
                t = [{
                    name: "b",
                    transform: {
                        mutate: p(vs, "strong")
                    }
                }, {
                    name: "i",
                    transform: {
                        mutate: p(vs, "em")
                    }
                }, {
                    name: "u",
                    transform: {
                        mutate: bs
                    }
                }, {
                    name: "s",
                    transform: {
                        mutate: p(vs, "strike")
                    }
                }, {
                    name: "font",
                    transform: {
                        mutate: hs,
                        debug: !0
                    }
                }],
                t = st(t, function(t) {
                    return !S(e, t.name)
                }).map(function(t) {
                    return Ft({
                        name: Lc.exact(t.name, Lc.caseInsensitive)
                    }, t.transform)
                }),
                cc({
                    tags: t
                }))];
        var e
    }
    function Lf(t, e, n, r) {
        var o, i, u, a, c = (o = t,
            a = (i = n).browser.isFirefox() || i.browser.isEdge(),
            u = a ? Ga : Va,
            c = !a,
            c = Sf(i) ? Pf : sc([Af(u, c)]),
            {
                annotate: [o ? c : Pf],
                local: [a ? Pf : rf]
            });
        return O([c.local, (a = t,
            Sf(n) || !a ? [] : [Bs]), c.annotate, _f(e ? [] : r.cleanFilteredInlineElements), function(t, e) {
            if (!t)
                return [Pf];
            t = [qs],
                e = Sf(e) ? [] : Vs;
            return t.concat(e).concat([Gs])
        }(t, n), [$s], [lf], [Ks], [Xs], If(0, e, 0, r), [yf, bf, of, xf], [uf], [af], [cf], [mf], !t && e ? [pf] : [], [gf], [ff], (e = t,
            Sf(n) && e ? [sf] : []), t ? [Qs, Of] : [], [df], [Js]])
    }
    var Of = Pn({
        attributes: [{
            name: Lc.pattern(/^(width|height)$/, Lc.caseInsensitive),
            condition: ys
        }]
    })
        , Df = cc({
        tags: [{
            name: Lc.exact("p", Lc.caseInsensitive),
            mutate: function(e) {
                Fe(e, "align").each(function(t) {
                    Ue(e, "align"),
                        Ju(e, "text-align").fold(function() {
                            return Gu(e, "text-align", t)
                        }, y)
                })
            }
        }]
    })
        , Nf = Pn({
        tags: [{
            name: Lc.exact("font", Lc.caseInsensitive),
            condition: function(t) {
                function e(t) {
                    return t.replace(/[ \r\n\uFEFF]+/g, "")
                }
                t = So(t);
                return 0 === t.length || D(t, function(t) {
                    return Ef(t, e)
                })
            }
        }]
    })
        , pn = function(t) {
        return ct(So(t), function(t) {
            Ef(t, Mt) && La(t)
        })
    }
        , Cf = cc({
        tags: [{
            name: Lc.exact("ol", Lc.caseInsensitive),
            mutate: pn
        }, {
            name: Lc.exact("ul", Lc.caseInsensitive),
            mutate: pn
        }]
    })
        , Pf = y
        , kf = ["body", "p", "div", "article", "aside", "figcaption", "figure", "footer", "header", "nav", "section", "ol", "ul", "li", "table", "thead", "tbody", "tfoot", "caption", "tr", "td", "th", "h1", "h2", "h3", "h4", "h5", "h6", "blockquote", "pre", "address"];
    function Rf(t, e) {
        return L(t, function(t) {
            return t.start === e
        })
    }
    function Mf(t, e, n) {
        var r;
        return e = e = n(t, e),
            r = t.start,
            at(e, function(t) {
                return Ft(Ft({}, t), {
                    start: t.start + r,
                    finish: t.finish + r
                })
            })
    }
    function Ff(t, e, n) {
        return {
            element: t,
            start: e,
            finish: n
        }
    }
    function jf(r, t, e) {
        var n = ft(e, function(t) {
            return [t.start, t.finish]
        })
            , o = Jf(t, n, function(t, e) {
            return function(r, t, e) {
                var n = r.property().getText(t)
                    , o = st(ll(n, e), function(t) {
                    return 0 < t.length
                });
                if (o.length <= 1)
                    return [Ff(t, 0, n.length)];
                r.property().setText(t, o[0]);
                e = Xf(o.slice(1), function(t, e) {
                    var n = r.create().text(t)
                        , t = Ff(n, e, e + t.length);
                    return G.some(t)
                }, o[0].length),
                    n = at(e, function(t) {
                        return t.element
                    });
                return r.insert().afterAll(t, n),
                    [Ff(t, 0, o[0].length)].concat(e)
            }(r, t.element, e)
        });
        return at(e, function(t) {
            var e = Zf(o, t.start, t.finish)
                , n = at(e, function(t) {
                return t.element
            })
                , e = at(n, r.property().getText).join("");
            return {
                elements: n,
                word: t.word,
                exact: e
            }
        })
    }
    function Uf(t) {
        var e, n = {
            word: "__INTERNAL__",
            pattern: Kf(pl)
        };
        return dl(ml, t, [n], e)
    }
    function Hf(t) {
        return !Pi(t, "a", e).isSome();
        var e
    }
    function Bf(t) {
        t = Uf(t),
            ct(t, function(t) {
                var n, e = t.exact;
                (e.indexOf("@") < 0 || gl(e)) && (n = t.elements,
                    G.from(n[0]).filter(Hf).map(function(t) {
                        var e = mn.fromTag("a");
                        return tu(t, e),
                            Zi(e, n),
                            fn(e, "href", is(e)),
                            e
                    }))
            })
    }
    function Wf(t) {
        ct(t, function(t) {
            un(t) && Ju(t, "position").isSome() && Zu(t, "position")
        })
    }
    function zf(t) {
        var e, n, r = st(t, ke("li"));
        0 < r.length && (e = Zr(r[0]),
            n = mn.fromTag("ul"),
            tu(t[0], n),
        0 < e.length && (t = mn.fromTag("li"),
            eu(n, t),
            Zi(t, e)),
            Zi(n, r))
    }
    function Yf(t) {
        var e = So(t);
        ct([Bf, Wf, zf], function(t) {
            t(e)
        })
    }
    function qf(t, e) {
        return ko(t, function(t) {
            return un(t) && Fe(t, "style").exists(function(t) {
                return -1 < t.indexOf("mso-")
            })
        })
    }
    function $f(t, e) {
        return t = Qu(t),
            e = e,
        0 <= (t = t).indexOf("<o:p>") || e.browser.isEdge() && 0 <= t.indexOf('v:shapes="') || e.browser.isEdge() && 0 <= t.indexOf("mso-") || 0 <= t.indexOf("mso-list") || 0 <= t.indexOf("p.MsoNormal, li.MsoNormal, div.MsoNormal") || 0 <= t.indexOf("MsoListParagraphCxSpFirst") || 0 <= t.indexOf("<w:WordDocument>")
    }
    function Vf(t, e) {
        return t ? G.some(e) : G.none()
    }
    function Gf(t) {
        return void 0 !== t && void 0 !== t.types && null !== t.types
    }
    var Kf = function(t) {
        return e = t,
            n = l(0),
            t = l(0),
            r = G.none(),
            {
                term: function() {
                    return new RegExp(e,r.getOr("g"))
                },
                prefix: n,
                suffix: t
            };
        var e, n, r
    }
        , Xf = function(t, n, e) {
        return void 0 === e && (e = 0),
            I(t, function(e, t) {
                return n(t, e.len).fold(l(e), function(t) {
                    return {
                        len: t.finish,
                        list: e.list.concat([t])
                    }
                })
            }, {
                len: e,
                list: []
            }).list
    }
        , Jf = function(t, e, n) {
        return 0 === e.length ? t : ft(t, function(r) {
            var t = ft(e, function(t) {
                return (n = t) >= (e = r).start && n <= e.finish ? [t - r.start] : [];
                var e, n
            });
            return 0 < t.length ? Mf(r, t, n) : [r]
        })
    }
        , Zf = function(r, t, o) {
        var t = Rf(r, t)
            , i = Rf(r, o);
        return t.bind(function(t) {
            var e, n, e = i.getOr((n = o,
                (e = r)[e.length - 1] && e[e.length - 1].finish === n ? e.length + 1 : -1));
            return -1 < e ? G.some(r.slice(t, e)) : G.none()
        }).getOr([])
    }
        , Qf = function(n, t) {
        return function(t) {
            t = Array.prototype.slice.call(t, 0);
            return t.sort(function(t, e) {
                return t.start < e.start ? -1 : e.start < t.start ? 1 : 0
            }),
                t
        }(ft(t, function(e) {
            var t = function(t, e) {
                for (var n = e.term(), r = [], o = n.exec(t); o; ) {
                    var i = o.index + e.prefix(o)
                        , u = o[0].length - e.prefix(o) - e.suffix(o);
                    r.push({
                        start: i,
                        finish: i + u
                    }),
                        n.lastIndex = i + u,
                        o = n.exec(t)
                }
                return r
            }(n, e.pattern);
            return at(t, function(t) {
                return Ft(Ft({}, e), t)
            })
        }))
    }
        , Pn = jt([{
        include: ["item"]
    }, {
        excludeWith: ["item"]
    }, {
        excludeWithout: ["item"]
    }])
        , tl = {
        include: Pn.include,
        excludeWith: Pn.excludeWith,
        excludeWithout: Pn.excludeWithout,
        cata: function(t, e, n, r) {
            return t.fold(e, n, r)
        }
    }
        , el = function(t, n) {
        var r = []
            , o = [];
        return ct(t, function(t) {
            var e = n(t);
            tl.cata(e, function() {
                o.push(t)
            }, function() {
                0 < o.length && r.push(o),
                    r.push([t]),
                    o = []
            }, function() {
                0 < o.length && r.push(o),
                    o = []
            })
        }),
        0 < o.length && r.push(o),
            r
    }
        , pn = jt([{
        boundary: ["item", "universe"]
    }, {
        empty: ["item", "universe"]
    }, {
        text: ["item", "universe"]
    }, {
        nonEditable: ["item", "universe"]
    }])
        , nl = d
        , rl = m
        , ol = l(0)
        , il = l(1)
        , Pn = function(t) {
        return Ft(Ft({}, t), {
            isBoundary: function() {
                return t.fold(rl, nl, nl, nl)
            },
            toText: function() {
                return t.fold(G.none, G.none, function(t) {
                    return G.some(t)
                }, G.none)
            },
            is: function(n) {
                return t.fold(nl, nl, function(t, e) {
                    return e.eq(t, n)
                }, nl)
            },
            len: function() {
                return t.fold(ol, il, function(t, e) {
                    return e.property().getText(t).length
                }, il)
            }
        })
    }
        , ul = {
        text: i(Pn, pn.text),
        boundary: i(Pn, pn.boundary),
        empty: i(Pn, pn.empty),
        nonEditable: i(Pn, pn.empty),
        cata: function(t, e, n, r, o) {
            return t.fold(e, n, r, o)
        }
    }
        , al = l([])
        , cl = function(e, t, n) {
        if (e.property().isText(t))
            return [ul.text(t, e)];
        if (e.property().isEmptyTag(t))
            return [ul.empty(t, e)];
        if (e.property().isNonEditable(t))
            return [];
        if (e.property().isElement(t)) {
            var r = e.property().children(t)
                , o = e.property().isBoundary(t) ? [ul.boundary(t, e)] : []
                , r = void 0 !== n && n(t) ? [] : ft(r, function(t) {
                return cl(e, t, n)
            });
            return o.concat(r).concat(o)
        }
        return []
    }
        , sl = cl
        , fl = function(e, t, n) {
        t = ft(t, function(t) {
            return sl(e, t, n)
        }),
            t = el(t, function(t) {
                return t.match({
                    boundary: function() {
                        return tl.excludeWithout(t)
                    },
                    empty: function() {
                        return tl.excludeWith(t)
                    },
                    text: function() {
                        return tl.include(t)
                    },
                    nonEditable: function() {
                        return tl.excludeWithout(t)
                    }
                })
            });
        return st(t, function(t) {
            return 0 < t.length
        })
    }
        , ll = function(r, t) {
        if (0 === t.length)
            return [r];
        var e = I(t, function(t, e) {
            if (0 === e)
                return t;
            var n = r.substring(t.prev, e);
            return {
                prev: e,
                values: t.values.concat([n])
            }
        }, {
            prev: 0,
            values: []
        })
            , t = t[t.length - 1];
        return t < r.length ? e.values.concat(r.substring(t)) : e.values
    }
        , dl = function(n, t, o, e) {
        e = fl(n, t, e);
        return ft(e, function(t) {
            var r, e = ft(t, function(t) {
                return t.fold(al, al, function(t) {
                    return [t]
                }, al)
            }), t = at(e, n.property().getText).join(""), t = Qf(t, o), e = (r = n,
                Xf(e, function(t, e) {
                    var n = e + r.property().getText(t).length;
                    return G.from(Ff(t, e, n))
                }));
            return jf(n, e, t)
        })
    }
        , ml = {
        up: l({
            selector: Ci,
            closest: Pi,
            predicate: No,
            all: Kr
        }),
        down: l({
            selector: Ro,
            predicate: Ko
        }),
        styles: l({
            get: Xu,
            getRaw: Ju,
            set: Gu,
            remove: Zu
        }),
        attrs: l({
            get: ln,
            set: fn,
            remove: Ue,
            copyTo: function(t, e) {
                t = I(t.dom.attributes, function(t, e) {
                    return t[e.name] = e.value,
                        t
                }, {});
                Me(e, t)
            }
        }),
        insert: l({
            before: tu,
            after: Gi,
            afterAll: Ji,
            append: eu,
            appendAll: Zi,
            prepend: Ki,
            wrap: Xi
        }),
        remove: l({
            unwrap: Bu,
            remove: La
        }),
        create: l({
            nu: mn.fromTag,
            clone: function(t) {
                return mn.fromDom(t.dom.cloneNode(!1))
            },
            text: mn.fromText
        }),
        query: l({
            comparePosition: function(t, e) {
                return t.dom.compareDocumentPosition(e.dom)
            },
            prevSibling: Xr,
            nextSibling: Jr
        }),
        property: l({
            children: So,
            name: Ce,
            parent: Gr,
            document: function(t) {
                return $r(t).dom
            },
            isText: an,
            isComment: on,
            isElement: un,
            getText: Ou,
            setText: Du,
            isBoundary: function(t) {
                return !!un(t) && ("body" === Ce(t) || S(kf, Ce(t)))
            },
            isEmptyTag: function(t) {
                return !!un(t) && S(["br", "img", "hr", "input"], Ce(t))
            },
            isNonEditable: function(t) {
                return un(t) && "false" === ln(t, "contenteditable")
            }
        }),
        eq: Yr,
        is: Eo
    }
        , pl = /(?:(?:[A-Za-z]{3,9}:(?:\/\/))(?:[-.~*+=!&;:'%@?^${}(),\w]+@)?[A-Za-z0-9-]+(?:\.[A-Za-z0-9-]+)*|(?:www\.|[-;:&=+$,.\w]+@)[A-Za-z0-9-]+(?:\.[A-Za-z0-9-]+)*)(?::[0-9]+)?(?:\/[-+~=%.()\/\w]*)?(?:\?(?:[-.~*+=!&;:'%@?^${}(),\/\w]+))?(?:#(?:[-.~*+=!&;:'%@?^${}(),\/\w]+))?/g.source
        , gl = function(t) {
        t = t.indexOf("://");
        return 3 <= t && t <= 9
    }
        , vl = function(t, e) {
        return fc(t, e, [Xs, xf])
    }
        , Pn = {
        disabled: function() {
            return {
                discriminator: "disabled",
                data: {}
            }
        },
        fromClipboard: function(t) {
            return {
                discriminator: "fromClipboard",
                data: {
                    rtf: t
                }
            }
        }
    }
        , hl = Ot(Pn)
        , yl = Pn.disabled
        , bl = Pn.fromClipboard
        , xl = function(t, e) {
        var n = new RegExp(e,"i");
        return P(t, function(t) {
            return Vf(null !== t.match(n), {
                type: t,
                flavor: e
            })
        })
    };
    var Tl, wl = Object.hasOwnProperty, El = Object.setPrototypeOf, Sl = Object.isFrozen, Al = Object.freeze, pn = Object.seal, Il = Object.create, Pn = "undefined" != typeof Reflect && Reflect, _l = (_l = Pn.apply) || function(t, e, n) {
        return t.apply(e, n)
    }
        , Al = Al || function(t) {
        return t
    }
        , pn = pn || function(t) {
        return t
    }
        , Ll = (Ll = Pn.construct) || function(t, e) {
        return new (Function.prototype.bind.apply(t, [null].concat(function(t) {
            if (Array.isArray(t)) {
                for (var e = 0, n = Array(t.length); e < t.length; e++)
                    n[e] = t[e];
                return n
            }
            return Array.from(t)
        }(e))))
    }
        , Ol = Ul(Array.prototype.forEach), Dl = Ul(Array.prototype.pop), Nl = Ul(Array.prototype.push), Cl = Ul(String.prototype.toLowerCase), Pl = Ul(String.prototype.match), kl = Ul(String.prototype.replace), Rl = Ul(String.prototype.indexOf), Ml = Ul(String.prototype.trim), Fl = Ul(RegExp.prototype.test), jl = (Tl = TypeError,
            function() {
                for (var t = arguments.length, e = Array(t), n = 0; n < t; n++)
                    e[n] = arguments[n];
                return Ll(Tl, e)
            }
    );
    function Ul(o) {
        return function(t) {
            for (var e = arguments.length, n = Array(1 < e ? e - 1 : 0), r = 1; r < e; r++)
                n[r - 1] = arguments[r];
            return _l(o, t, n)
        }
    }
    function Hl(t, e) {
        El && El(t, null);
        for (var n = e.length; n--; ) {
            var r, o = e[n];
            "string" != typeof o || (r = Cl(o)) !== o && (Sl(e) || (e[n] = r),
                o = r),
                t[o] = !0
        }
        return t
    }
    function Bl(t) {
        var e = Il(null)
            , n = void 0;
        for (n in t)
            _l(wl, t, [n]) && (e[n] = t[n]);
        return e
    }
    var Wl = Al(["a", "abbr", "acronym", "address", "area", "article", "aside", "audio", "b", "bdi", "bdo", "big", "blink", "blockquote", "body", "br", "button", "canvas", "caption", "center", "cite", "code", "col", "colgroup", "content", "data", "datalist", "dd", "decorator", "del", "details", "dfn", "dialog", "dir", "div", "dl", "dt", "element", "em", "fieldset", "figcaption", "figure", "font", "footer", "form", "h1", "h2", "h3", "h4", "h5", "h6", "head", "header", "hgroup", "hr", "html", "i", "img", "input", "ins", "kbd", "label", "legend", "li", "main", "map", "mark", "marquee", "menu", "menuitem", "meter", "nav", "nobr", "ol", "optgroup", "option", "output", "p", "picture", "pre", "progress", "q", "rp", "rt", "ruby", "s", "samp", "section", "select", "shadow", "small", "source", "spacer", "span", "strike", "strong", "style", "sub", "summary", "sup", "table", "tbody", "td", "template", "textarea", "tfoot", "th", "thead", "time", "tr", "track", "tt", "u", "ul", "var", "video", "wbr"])
        , zl = Al(["svg", "a", "altglyph", "altglyphdef", "altglyphitem", "animatecolor", "animatemotion", "animatetransform", "audio", "canvas", "circle", "clippath", "defs", "desc", "ellipse", "filter", "font", "g", "glyph", "glyphref", "hkern", "image", "line", "lineargradient", "marker", "mask", "metadata", "mpath", "path", "pattern", "polygon", "polyline", "radialgradient", "rect", "stop", "style", "switch", "symbol", "text", "textpath", "title", "tref", "tspan", "video", "view", "vkern"])
        , Yl = Al(["feBlend", "feColorMatrix", "feComponentTransfer", "feComposite", "feConvolveMatrix", "feDiffuseLighting", "feDisplacementMap", "feDistantLight", "feFlood", "feFuncA", "feFuncB", "feFuncG", "feFuncR", "feGaussianBlur", "feMerge", "feMergeNode", "feMorphology", "feOffset", "fePointLight", "feSpecularLighting", "feSpotLight", "feTile", "feTurbulence"])
        , ql = Al(["math", "menclose", "merror", "mfenced", "mfrac", "mglyph", "mi", "mlabeledtr", "mmultiscripts", "mn", "mo", "mover", "mpadded", "mphantom", "mroot", "mrow", "ms", "mspace", "msqrt", "mstyle", "msub", "msup", "msubsup", "mtable", "mtd", "mtext", "mtr", "munder", "munderover"])
        , $l = Al(["#text"])
        , Vl = Al(["accept", "action", "align", "alt", "autocapitalize", "autocomplete", "autopictureinpicture", "autoplay", "background", "bgcolor", "border", "capture", "cellpadding", "cellspacing", "checked", "cite", "class", "clear", "color", "cols", "colspan", "controls", "controlslist", "coords", "crossorigin", "datetime", "decoding", "default", "dir", "disabled", "disablepictureinpicture", "disableremoteplayback", "download", "draggable", "enctype", "enterkeyhint", "face", "for", "headers", "height", "hidden", "high", "href", "hreflang", "id", "inputmode", "integrity", "ismap", "kind", "label", "lang", "list", "loading", "loop", "low", "max", "maxlength", "media", "method", "min", "minlength", "multiple", "muted", "name", "noshade", "novalidate", "nowrap", "open", "optimum", "pattern", "placeholder", "playsinline", "poster", "preload", "pubdate", "radiogroup", "readonly", "rel", "required", "rev", "reversed", "role", "rows", "rowspan", "spellcheck", "scope", "selected", "shape", "size", "sizes", "span", "srclang", "start", "src", "srcset", "step", "style", "summary", "tabindex", "title", "translate", "type", "usemap", "valign", "value", "width", "xmlns"])
        , Gl = Al(["accent-height", "accumulate", "additive", "alignment-baseline", "ascent", "attributename", "attributetype", "azimuth", "basefrequency", "baseline-shift", "begin", "bias", "by", "class", "clip", "clippathunits", "clip-path", "clip-rule", "color", "color-interpolation", "color-interpolation-filters", "color-profile", "color-rendering", "cx", "cy", "d", "dx", "dy", "diffuseconstant", "direction", "display", "divisor", "dur", "edgemode", "elevation", "end", "fill", "fill-opacity", "fill-rule", "filter", "filterunits", "flood-color", "flood-opacity", "font-family", "font-size", "font-size-adjust", "font-stretch", "font-style", "font-variant", "font-weight", "fx", "fy", "g1", "g2", "glyph-name", "glyphref", "gradientunits", "gradienttransform", "height", "href", "id", "image-rendering", "in", "in2", "k", "k1", "k2", "k3", "k4", "kerning", "keypoints", "keysplines", "keytimes", "lang", "lengthadjust", "letter-spacing", "kernelmatrix", "kernelunitlength", "lighting-color", "local", "marker-end", "marker-mid", "marker-start", "markerheight", "markerunits", "markerwidth", "maskcontentunits", "maskunits", "max", "mask", "media", "method", "mode", "min", "name", "numoctaves", "offset", "operator", "opacity", "order", "orient", "orientation", "origin", "overflow", "paint-order", "path", "pathlength", "patterncontentunits", "patterntransform", "patternunits", "points", "preservealpha", "preserveaspectratio", "primitiveunits", "r", "rx", "ry", "radius", "refx", "refy", "repeatcount", "repeatdur", "restart", "result", "rotate", "scale", "seed", "shape-rendering", "specularconstant", "specularexponent", "spreadmethod", "startoffset", "stddeviation", "stitchtiles", "stop-color", "stop-opacity", "stroke-dasharray", "stroke-dashoffset", "stroke-linecap", "stroke-linejoin", "stroke-miterlimit", "stroke-opacity", "stroke", "stroke-width", "style", "surfacescale", "systemlanguage", "tabindex", "targetx", "targety", "transform", "text-anchor", "text-decoration", "text-rendering", "textlength", "type", "u1", "u2", "unicode", "values", "viewbox", "visibility", "version", "vert-adv-y", "vert-origin-x", "vert-origin-y", "width", "word-spacing", "wrap", "writing-mode", "xchannelselector", "ychannelselector", "x", "x1", "x2", "xmlns", "y", "y1", "y2", "z", "zoomandpan"])
        , Kl = Al(["accent", "accentunder", "align", "bevelled", "close", "columnsalign", "columnlines", "columnspan", "denomalign", "depth", "dir", "display", "displaystyle", "encoding", "fence", "frame", "height", "href", "id", "largeop", "length", "linethickness", "lspace", "lquote", "mathbackground", "mathcolor", "mathsize", "mathvariant", "maxsize", "minsize", "movablelimits", "notation", "numalign", "open", "rowalign", "rowlines", "rowspacing", "rowspan", "rspace", "rquote", "scriptlevel", "scriptminsize", "scriptsizemultiplier", "selection", "separator", "separators", "stretchy", "subscriptshift", "supscriptshift", "symmetric", "voffset", "width", "xmlns"])
        , Xl = Al(["xlink:href", "xml:id", "xlink:title", "xml:space", "xmlns:xlink"])
        , Jl = pn(/\{\{[\s\S]*|[\s\S]*\}\}/gm)
        , Zl = pn(/<%[\s\S]*|[\s\S]*%>/gm)
        , Ql = pn(/^data-[\-\w.\u00B7-\uFFFF]/)
        , td = pn(/^aria-[\-\w]+$/)
        , ed = pn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i)
        , nd = pn(/^(?:\w+script|data):/i)
        , rd = pn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g)
        , od = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(t) {
            return typeof t
        }
        : function(t) {
            return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t
        }
    ;
    function id(t) {
        if (Array.isArray(t)) {
            for (var e = 0, n = Array(t.length); e < t.length; e++)
                n[e] = t[e];
            return n
        }
        return Array.from(t)
    }
    var ud = function() {
        return "undefined" == typeof window ? null : window
    }
        , ad = function(t, e) {
        if ("object" !== (void 0 === t ? "undefined" : od(t)) || "function" != typeof t.createPolicy)
            return null;
        var n = null
            , r = "data-tt-policy-suffix";
        e.currentScript && e.currentScript.hasAttribute(r) && (n = e.currentScript.getAttribute(r));
        var o = "dompurify" + (n ? "#" + n : "");
        try {
            return t.createPolicy(o, {
                createHTML: function(t) {
                    return t
                }
            })
        } catch (t) {
            return console.warn("TrustedTypes policy " + o + " could not be created."),
                null
        }
    };
    function cd(t, e) {
        Od.addHook("uponSanitizeElement", function(t, e) {
            S(Dd, e.tagName) || Ct(e.allowedTags, e.tagName) || (e.allowedTags[e.tagName] = !0)
        }),
            Od.addHook("uponSanitizeAttribute", function(t, e) {
                0 === e.attrName.indexOf("on") || Ct(e.allowedAttributes, e.attrName) || (e.allowedAttributes[e.attrName] = !0),
                e.attrValue && -1 !== e.attrValue.indexOf("\n") && (e.attrValue = e.attrValue.replace(/\r?\n/g, ""))
            });
        var n = kt(Mt(t), "<!")
            , r = n ? "<body>" + t + "</body>" : t.replace(/^[\S\s]*?(<!DOCTYPE|<html)/i, "$1")
            , t = Od.sanitize(r, {
            ALLOW_UNKNOWN_PROTOCOLS: !0,
            FORBID_TAGS: Dd,
            WHOLE_DOCUMENT: -1 !== t.lastIndexOf("</html>")
        });
        return Od.removeHook("uponSanitizeElement"),
            Od.removeHook("uponSanitizeAttribute"),
            n ? B(H(t, "<body>"), "</body>") : t
    }
    function sd(t) {
        return Pt(e = t, "<html") && (Pt(e, 'xmlns:o="urn:schemas-microsoft-com:office:office"') || Pt(e, 'xmlns:x="urn:schemas-microsoft-com:office:excel"')) || Pt(t, 'meta name="ProgId" content="Word.Document"');
        var e
    }
    function fd(t) {
        return Pt(t, "<meta") && Pt(t, 'id="docs-internal-guid')
    }
    function ld(t) {
        return 0 < t.length
    }
    function dd(e, t) {
        return xl(e.types, t).map(function(t) {
            return e.getData(t.type)
        }).filter(ld)
    }
    function md(t) {
        return dd(t, "html")
    }
    function pd(t) {
        return md(t).filter(fd)
    }
    function gd(t) {
        return Yd ? G.from(t.clipboardData).filter(Gf) : G.none()
    }
    function vd(t) {
        var e, n, r = mn.fromTag("div"), o = (e = qr(r),
            fc(e, t, [wf]));
        return n = o,
            t = qr(e = r).dom,
            o = mn.fromDom(t.createDocumentFragment()),
            t = Vi(n, t),
            Zi(o, t),
            Hu(e),
            eu(e, o),
            kd({
                container: r
            })
    }
    function hd(t, n) {
        function e(r) {
            return void 0 === r.items ? G.none() : (t = qd,
                e = r.types,
                P(t, function(t) {
                    return xl(e, t)
                }).map(function(t) {
                    for (var e = [], n = 0; n < r.items.length; n++)
                        e.push(r.items[n]);
                    return Rd({
                        images: e
                    })
                }));
            var t, e
        }
        function r(e) {
            return P(e.types, function(t) {
                return "text/plain" === t ? G.some(e.getData(t)).map(function(t) {
                    return Fd({
                        text: n.sanitizeText(t)
                    })
                }) : G.none()
            })
        }
        return void 0 === n && (n = Cd),
            {
                getWordData: function() {
                    return gd(t).bind(function(n) {
                        return md(n).filter(sd).map(function(t) {
                            var e = dd(n, "rtf");
                            return Md({
                                html: t,
                                rtf: e.fold(function() {
                                    return yl()
                                }, function(t) {
                                    return bl(t)
                                })
                            })
                        })
                    })
                },
                getGoogleDocsData: function() {
                    return gd(t).bind(pd).map(function(t) {
                        return n.sanitizeHtml(t, "googledocs")
                    }).map(vd)
                },
                getImage: function() {
                    return gd(t).bind(e)
                },
                getText: function() {
                    return gd(t).fold(function() {
                        var t = window.clipboardData;
                        return void 0 !== t ? G.some(Fd({
                            text: n.sanitizeText(t.getData("text"))
                        })) : G.none()
                    }, r)
                },
                getHtml: function() {
                    return gd(t).bind(md).map(n.sanitizeHtml).map(vd)
                },
                getOnlyText: function() {
                    return gd(t).bind(function(t) {
                        return e = t.types,
                            n = "text/plain",
                            1 === e.length && e[0] === n ? r(t) : G.none();
                        var e, n
                    })
                },
                getNative: function() {
                    return Pd({
                        nativeEvent: t
                    })
                },
                getVoid: function() {
                    return jd({})
                }
            }
    }
    function yd(t) {
        return at(t, function(t) {
            return t.asset
        })
    }
    function bd() {
        var e = G.none();
        return {
            convert: function(t) {
                e = function(n) {
                    var t, e = De("window.clipboardData.files"), r = void 0 !== (t = n).convertURL ? t.convertURL : void 0 !== t.msConvertURL ? t.msConvertURL : void 0;
                    if (void 0 !== e && void 0 !== r && 0 < e.length) {
                        e = Qt(e, function(t) {
                            var e = URL.createObjectURL(t);
                            return r.apply(n, [t, "specified", e]),
                                tn(t, e)
                        });
                        return G.some(e)
                    }
                    return G.none()
                }(t)
            },
            listen: function(t) {
                return e.fold(function() {
                    return Jt.nu(function(t) {
                        t([])
                    })
                }, function(t) {
                    return t
                }).get(t)
            },
            clear: function() {
                e = G.none()
            }
        }
    }
    function xd(t, e) {
        return {
            asset: t,
            image: e
        }
    }
    function Td(t, r) {
        return Ht.cata(t, function(t, e, n) {
            return fn(r, "src", n),
                !0
        }, d)
    }
    function wd(t, n) {
        var r = [];
        return ct(t, function(t, e) {
            e = n[e];
            Td(t, e) && r.push(xd(t, e))
        }),
            r
    }
    function Ed(t, e) {
        return {
            futureAsset: t,
            image: e
        }
    }
    function Sd(t) {
        var e = mn.fromTag("div");
        return Zi(e, t),
            Ro(e, "img[src]")
    }
    function Ad(t) {
        return 0 === t.indexOf("data:") && -1 < t.indexOf("base64")
    }
    function Id(t) {
        return 0 === t.indexOf("blob:")
    }
    function _d(t) {
        return Fe(t, "src").exists(function(t) {
            return Ad(t) || Id(t)
        })
    }
    function Ld(t) {
        return ft(Sd(t), function(t) {
            var n, e, r = Fe(t, "src").getOr("");
            return Ad(r) ? (e = t,
                Se(r).map(function(t) {
                    return Ed(Oe(t), e)
                }).toArray()) : Id(r) ? (n = t,
                we(r).map(function(t) {
                    var e = Jt.nu(function(e) {
                        t.then(function(t) {
                            Oe(t).get(e)
                        })
                    });
                    return Ed(e, n)
                }).toArray()) : []
        })
    }
    var Od = function e(t) {
        function s(t) {
            return e(t)
        }
        var a = 0 < arguments.length && void 0 !== t ? t : ud();
        if (s.version = "2.2.2",
            s.removed = [],
        !a || !a.document || 9 !== a.document.nodeType)
            return s.isSupported = !1,
                s;
        var c = a.document
            , i = a.document
            , f = a.DocumentFragment
            , n = a.HTMLTemplateElement
            , l = a.Node
            , r = a.NodeFilter
            , t = a.NamedNodeMap
            , o = void 0 === t ? a.NamedNodeMap || a.MozNamedAttrMap : t
            , u = a.Text
            , d = a.Comment
            , m = a.DOMParser
            , t = a.trustedTypes;
        "function" != typeof n || (n = i.createElement("template")).content && n.content.ownerDocument && (i = n.content.ownerDocument);
        var p = ad(t, c)
            , g = p && ot ? p.createHTML("") : ""
            , v = i.implementation
            , h = i.createNodeIterator
            , y = i.getElementsByTagName
            , b = i.createDocumentFragment
            , x = c.importNode
            , T = {};
        try {
            T = Bl(i).documentMode ? i.documentMode : {}
        } catch (t) {}
        var w = {};
        s.isSupported = v && void 0 !== v.createHTMLDocument && 9 !== T;
        function E(t) {
            mt && mt === t || (t && "object" === (void 0 === t ? "undefined" : od(t)) || (t = {}),
                t = Bl(t),
                W = "ALLOWED_TAGS"in t ? Hl({}, t.ALLOWED_TAGS) : z,
                Y = "ALLOWED_ATTR"in t ? Hl({}, t.ALLOWED_ATTR) : q,
                lt = "ADD_URI_SAFE_ATTR"in t ? Hl(Bl(dt), t.ADD_URI_SAFE_ATTR) : dt,
                st = "ADD_DATA_URI_TAGS"in t ? Hl(Bl(ft), t.ADD_DATA_URI_TAGS) : ft,
                $ = "FORBID_TAGS"in t ? Hl({}, t.FORBID_TAGS) : {},
                V = "FORBID_ATTR"in t ? Hl({}, t.FORBID_ATTR) : {},
                k = "USE_PROFILES"in t && t.USE_PROFILES,
                G = !1 !== t.ALLOW_ARIA_ATTR,
                K = !1 !== t.ALLOW_DATA_ATTR,
                X = t.ALLOW_UNKNOWN_PROTOCOLS || !1,
                J = t.SAFE_FOR_TEMPLATES || !1,
                Z = t.WHOLE_DOCUMENT || !1,
                et = t.RETURN_DOM || !1,
                nt = t.RETURN_DOM_FRAGMENT || !1,
                rt = !1 !== t.RETURN_DOM_IMPORT,
                ot = t.RETURN_TRUSTED_TYPE || !1,
                tt = t.FORCE_BODY || !1,
                it = !1 !== t.SANITIZE_DOM,
                ut = !1 !== t.KEEP_CONTENT,
                at = t.IN_PLACE || !1,
                B = t.ALLOWED_URI_REGEXP || B,
            J && (K = !1),
            nt && (et = !0),
            k && (W = Hl({}, [].concat(id($l))),
                Y = [],
            !0 === k.html && (Hl(W, Wl),
                Hl(Y, Vl)),
            !0 === k.svg && (Hl(W, zl),
                Hl(Y, Gl),
                Hl(Y, Xl)),
            !0 === k.svgFilters && (Hl(W, Yl),
                Hl(Y, Gl),
                Hl(Y, Xl)),
            !0 === k.mathMl && (Hl(W, ql),
                Hl(Y, Kl),
                Hl(Y, Xl))),
            t.ADD_TAGS && (W === z && (W = Bl(W)),
                Hl(W, t.ADD_TAGS)),
            t.ADD_ATTR && (Y === q && (Y = Bl(Y)),
                Hl(Y, t.ADD_ATTR)),
            t.ADD_URI_SAFE_ATTR && Hl(lt, t.ADD_URI_SAFE_ATTR),
            ut && (W["#text"] = !0),
            Z && Hl(W, ["html", "head", "body"]),
            W.table && (Hl(W, ["tbody"]),
                delete $.tbody),
            Al && Al(t),
                mt = t)
        }
        function S(e) {
            Nl(s.removed, {
                element: e
            });
            try {
                e.parentNode.removeChild(e)
            } catch (t) {
                e.outerHTML = g
            }
        }
        function A(t, e) {
            try {
                Nl(s.removed, {
                    attribute: e.getAttributeNode(t),
                    from: e
                })
            } catch (t) {
                Nl(s.removed, {
                    attribute: null,
                    from: e
                })
            }
            e.removeAttribute(t)
        }
        function I(t) {
            var e = void 0
                , n = void 0;
            tt ? t = "<remove></remove>" + t : n = (r = Pl(t, /^[\r\n\t ]+/)) && r[0];
            var r, o = p ? p.createHTML(t) : t;
            try {
                e = (new m).parseFromString(o, "text/html")
            } catch (t) {}
            return e && e.documentElement || ((r = (e = v.createHTMLDocument("")).body).parentNode.removeChild(r.parentNode.firstElementChild),
                r.outerHTML = o),
            t && n && e.body.insertBefore(i.createTextNode(n), e.body.childNodes[0] || null),
                y.call(e, Z ? "html" : "body")[0]
        }
        function _(t) {
            return h.call(t.ownerDocument || t, t, r.SHOW_ELEMENT | r.SHOW_COMMENT | r.SHOW_TEXT, function() {
                return r.FILTER_ACCEPT
            }, !1)
        }
        function L(t) {
            return "object" === (void 0 === l ? "undefined" : od(l)) ? t instanceof l : t && "object" === (void 0 === t ? "undefined" : od(t)) && "number" == typeof t.nodeType && "string" == typeof t.nodeName
        }
        function O(t, e, n) {
            w[t] && Ol(w[t], function(t) {
                t.call(s, e, n, mt)
            })
        }
        function D(t) {
            var e;
            if (O("beforeSanitizeElements", t, null),
                !((n = t)instanceof u || n instanceof d || "string" == typeof n.nodeName && "string" == typeof n.textContent && "function" == typeof n.removeChild && n.attributes instanceof o && "function" == typeof n.removeAttribute && "function" == typeof n.setAttribute && "string" == typeof n.namespaceURI))
                return S(t),
                    1;
            if (Pl(t.nodeName, /[\u0080-\uFFFF]/))
                return S(t),
                    1;
            var n = Cl(t.nodeName);
            if (O("uponSanitizeElement", t, {
                tagName: n,
                allowedTags: W
            }),
            ("svg" === n || "math" === n) && 0 !== t.querySelectorAll("p, br, form, table").length)
                return S(t),
                    1;
            if (!L(t.firstElementChild) && (!L(t.content) || !L(t.content.firstElementChild)) && Fl(/<[!/\w]/g, t.innerHTML) && Fl(/<[!/\w]/g, t.textContent))
                return S(t),
                    1;
            if (W[n] && !$[n])
                return "noscript" !== n && "noembed" !== n || !Fl(/<\/no(script|embed)/i, t.innerHTML) ? (J && 3 === t.nodeType && (e = t.textContent,
                    e = kl(e, R, " "),
                    e = kl(e, M, " "),
                t.textContent !== e && (Nl(s.removed, {
                    element: t.cloneNode()
                }),
                    t.textContent = e)),
                    O("afterSanitizeElements", t, null),
                    0) : (S(t),
                    1);
            if (ut && !ct[n] && "function" == typeof t.insertAdjacentHTML)
                try {
                    var r = t.innerHTML;
                    t.insertAdjacentHTML("AfterEnd", p ? p.createHTML(r) : r)
                } catch (t) {}
            return S(t),
                1
        }
        function N(t, e, n) {
            if (it && ("id" === e || "name" === e) && (n in i || n in pt))
                return !1;
            if (!(K && Fl(F, e) || G && Fl(j, e))) {
                if (!Y[e] || V[e])
                    return !1;
                if (!lt[e] && !Fl(B, kl(n, H, "")) && ("src" !== e && "xlink:href" !== e && "href" !== e || "script" === t || 0 !== Rl(n, "data:") || !st[t]) && (!X || Fl(U, kl(n, H, ""))) && n)
                    return !1
            }
            return !0
        }
        function C(t) {
            var e = void 0
                , n = void 0;
            O("beforeSanitizeAttributes", t, null);
            var r = t.attributes;
            if (r) {
                for (var o = {
                    attrName: "",
                    attrValue: "",
                    keepAttr: !0,
                    allowedAttributes: Y
                }, n = r.length; n--; ) {
                    var i = (c = r[n]).name
                        , u = c.namespaceURI
                        , e = Ml(c.value)
                        , a = Cl(i);
                    if (o.attrName = a,
                        o.attrValue = e,
                        o.keepAttr = !0,
                        o.forceKeepAttr = void 0,
                        O("uponSanitizeAttribute", t, o),
                        e = o.attrValue,
                    !o.forceKeepAttr && (A(i, t),
                        o.keepAttr))
                        if (Fl(/\/>/i, e))
                            A(i, t);
                        else {
                            J && (e = kl(e, R, " "),
                                e = kl(e, M, " "));
                            var c = t.nodeName.toLowerCase();
                            if (N(c, a, e))
                                try {
                                    u ? t.setAttributeNS(u, i, e) : t.setAttribute(i, e),
                                        Dl(s.removed)
                                } catch (t) {}
                        }
                }
                O("afterSanitizeAttributes", t, null)
            }
        }
        function P(t) {
            var e, n = _(t);
            for (O("beforeSanitizeShadowDOM", t, null); e = n.nextNode(); )
                O("uponSanitizeShadowNode", e, null),
                D(e) || (e.content instanceof f && P(e.content),
                    C(e));
            O("afterSanitizeShadowDOM", t, null)
        }
        var k, R = Jl, M = Zl, F = Ql, j = td, U = nd, H = rd, B = ed, W = null, z = Hl({}, [].concat(id(Wl), id(zl), id(Yl), id(ql), id($l))), Y = null, q = Hl({}, [].concat(id(Vl), id(Gl), id(Kl), id(Xl))), $ = null, V = null, G = !0, K = !0, X = !1, J = !1, Z = !1, Q = !1, tt = !1, et = !1, nt = !1, rt = !0, ot = !1, it = !0, ut = !0, at = !1, ct = Hl({}, ["annotation-xml", "audio", "colgroup", "desc", "foreignobject", "head", "iframe", "math", "mi", "mn", "mo", "ms", "mtext", "noembed", "noframes", "plaintext", "script", "style", "svg", "template", "thead", "title", "video", "xmp"]), st = null, ft = Hl({}, ["audio", "video", "img", "source", "image", "track"]), lt = null, dt = Hl({}, ["alt", "class", "for", "id", "label", "name", "pattern", "placeholder", "summary", "title", "value", "style", "xmlns"]), mt = null, pt = i.createElement("form");
        return s.sanitize = function(t, e) {
            var n, r = void 0, o = void 0, i = void 0;
            if ("string" != typeof (t = t || "\x3c!--\x3e") && !L(t)) {
                if ("function" != typeof t.toString)
                    throw jl("toString is not a function");
                if ("string" != typeof (t = t.toString()))
                    throw jl("dirty is not a string, aborting")
            }
            if (!s.isSupported) {
                if ("object" === od(a.toStaticHTML) || "function" == typeof a.toStaticHTML) {
                    if ("string" == typeof t)
                        return a.toStaticHTML(t);
                    if (L(t))
                        return a.toStaticHTML(t.outerHTML)
                }
                return t
            }
            if (Q || E(e),
                s.removed = [],
            "string" == typeof t && (at = !1),
                !at)
                if (t instanceof l)
                    1 === (e = (r = I("\x3c!----\x3e")).ownerDocument.importNode(t, !0)).nodeType && "BODY" === e.nodeName || "HTML" === e.nodeName ? r = e : r.appendChild(e);
                else {
                    if (!et && !J && !Z && -1 === t.indexOf("<"))
                        return p && ot ? p.createHTML(t) : t;
                    if (!(r = I(t)))
                        return et ? null : g
                }
            r && tt && S(r.firstChild);
            for (var u = _(at ? t : r); n = u.nextNode(); )
                3 === n.nodeType && n === o || D(n) || (n.content instanceof f && P(n.content),
                    C(n),
                    o = n);
            if (o = null,
                at)
                return t;
            if (et) {
                if (nt)
                    for (i = b.call(r.ownerDocument); r.firstChild; )
                        i.appendChild(r.firstChild);
                else
                    i = r;
                return rt && (i = x.call(c, i, !0)),
                    i
            }
            return t = Z ? r.outerHTML : r.innerHTML,
            J && (t = kl(t, R, " "),
                t = kl(t, M, " ")),
                p && ot ? p.createHTML(t) : t
        }
            ,
            s.setConfig = function(t) {
                E(t),
                    Q = !0
            }
            ,
            s.clearConfig = function() {
                mt = null,
                    Q = !1
            }
            ,
            s.isValidAttribute = function(t, e, n) {
                return mt || E({}),
                    t = Cl(t),
                    e = Cl(e),
                    N(t, e, n)
            }
            ,
            s.addHook = function(t, e) {
                "function" == typeof e && (w[t] = w[t] || [],
                    Nl(w[t], e))
            }
            ,
            s.removeHook = function(t) {
                w[t] && Dl(w[t])
            }
            ,
            s.removeHooks = function(t) {
                w[t] && (w[t] = [])
            }
            ,
            s.removeAllHooks = function() {
                w = {}
            }
            ,
            s
    }()
        , Dd = ["script", "svg"]
        , Nd = function(n) {
        return {
            sanitizeHtml: function(t, e) {
                return n(t) ? t : cd(t)
            },
            sanitizeText: u
        }
    }
        , Cd = {
        sanitizeHtml: u,
        sanitizeText: u
    }
        , Pn = function(e) {
        return function(t) {
            return {
                discriminator: e,
                data: t
            }
        }
    }
        , pn = function(e) {
        return function(t) {
            return t.discriminator === e ? G.some(t.data) : G.none()
        }
    }
        , Pd = Pn("event")
        , kd = Pn("html")
        , Rd = Pn("images")
        , Md = Pn("word")
        , Fd = Pn("text")
        , jd = Pn("void")
        , Ud = pn("event")
        , Hd = pn("html")
        , Bd = pn("images")
        , Wd = pn("word")
        , zd = pn("text")
        , pn = wo().browser
        , Yd = !(pn.isIE() || pn.isEdge() && pn.version.major < 16)
        , qd = ["^image/", "file"]
        , $d = function(t, e) {
        void 0 === e && (e = Cd);
        return {
            getWordData: function() {
                return G.some(Md({
                    html: e.sanitizeHtml(t),
                    rtf: yl()
                }))
            },
            getGoogleDocsData: G.none,
            getImage: G.none,
            getHtml: G.none,
            getText: G.none,
            getNative: a("There is no native event"),
            getOnlyText: G.none,
            getVoid: a("There is no paste event")
        }
    }
        , Vd = function(t, e) {
        void 0 === e && (e = Cd);
        return {
            getWordData: G.none,
            getGoogleDocsData: G.none,
            getImage: G.none,
            getHtml: G.none,
            getText: function() {
                return G.some(Fd({
                    text: e.sanitizeText(t)
                }))
            },
            getNative: a("There is no native event"),
            getOnlyText: G.none,
            getVoid: a("There is no paste event")
        }
    }
        , Gd = {
        native: "Outside of Textbox.io pasting HTML5 API (could be internal)",
        fallback: "Outside of Textbox.io pasting offscreen (could be internal)",
        msoffice: "Word Import pasting",
        googledocs: " pasting",
        image: "Image pasting",
        plaintext: "Only plain text is available to paste",
        text: "Plain text pasting",
        none: "There is no valid way to paste",
        discard: "There is no valid way to paste, discarding content"
    }
        , Kd = Ft({
        getLabelForApi: function(e) {
            var t = Ot(Gd);
            return _(t, function(t) {
                return Gd[t] === e
            }).fold(function() {
                return "unknown"
            }, function(t) {
                switch (t) {
                    case "native":
                    case "fallback":
                        return "html";
                    case "none":
                    case "discard":
                        return "invalid";
                    default:
                        return t
                }
            })
        }
    }, Gd)
        , Xd = function(r, o, n) {
        function i(t, e, n) {
            (t = xu(r, o, t)).capture && n();
            var n = at(t.steps, function(t) {
                return t(e)
            })
                , n = wu(n, t.input)
                , i = Kd.getLabelForApi(t.label);
            n.get(function(t) {
                var r = t.bundle.isInternal.getOr(!1)
                    , o = t.bundle.officeStyles.fold(l("auto"), function(t) {
                    return t ? "merge" : "clean"
                });
                gu(t.response, function(t) {
                    u.trigger.error(t)
                }, function(t, e) {
                    u.trigger.insert(t, yd(e), e, r, i, o)
                }, function() {
                    u.trigger.cancel()
                }, function(t, e, n) {
                    u.trigger.insert(t, yd(e), e, r, i, o),
                        u.trigger.error(n)
                })
            })
        }
        var u = Go({
            cancel: Vo([]),
            error: Vo(["message"]),
            insert: Vo(["elements", "assets", "correlated", "isInternal", "source", "mode"])
        })
            , a = ta(function(e) {
            var t = Vr(mn.fromDom(e.target));
            Uu(t.dom).each(function(t) {
                Di(t.start, Na()) || (t = hd(e, n),
                Ca() && (a.control.block(),
                    e.preventDefault()),
                    i(t, a.control, function() {
                        e.preventDefault()
                    }))
            })
        });
        return {
            paste: a.instance,
            pasteCustom: function(t, e) {
                void 0 === e && (e = y);
                var n = ta(y);
                i(t, n.control, e)
            },
            isBlocked: a.control.isBlocked,
            destroy: y,
            events: u.registry
        }
    };
    function Jd(c) {
        return function(t, a) {
            return ha(function(o) {
                function i() {
                    hu(o, {
                        response: a.response,
                        bundle: a.bundle
                    })
                }
                function u(t) {
                    var e = st(Sd(t), _d);
                    ct(e, La),
                        hu(o, {
                            response: 0 < e.length ? function(t) {
                                t = st(t, function(t) {
                                    return !ke("img")(t) || !_d(t)
                                });
                                return ga(t, [], "errors.local.images.disallowed")
                            }(t) : a.response,
                            bundle: a.bundle
                        })
                }
                function t(t, e) {
                    var n, r;
                    !1 === c.allowLocalImages ? u(t) : 0 === e.length ? (e = Ld(n = t),
                        t = Qt(e, function(t) {
                            return t.futureAsset
                        }),
                        r = at(e, function(t) {
                            return t.image
                        }),
                        t.get(function(t) {
                            t = wd(t, r);
                            hu(o, {
                                response: ma(n, t),
                                bundle: a.bundle
                            })
                        })) : i()
                }
                gu(a.response, i, t, i, t)
            })
        }
    }
    var Zd = Bt("ephox-cement").resolve;
    function Qd(a, n) {
        function c(t, e, n) {
            n(G.some(Ic(e, {
                officeStyles: t,
                htmlStyles: t
            })))
        }
        var s = n.translations;
        return {
            get: function(t, e) {
                t = n[t ? "officeStyles" : "htmlStyles"];
                "clean" === t ? c(!1, n, e) : "merge" === t ? c(!0, n, e) : function(t, e) {
                    var n = mn.fromTag("div");
                    Li(n, Zd("styles-dialog-content"));
                    var r = mn.fromTag("p")
                        , o = Vi(s("cement.dialog.paste.instructions"));
                    Zi(r, o),
                        eu(n, r);
                    var o = {
                        text: s("cement.dialog.paste.clean"),
                        tabindex: 0,
                        className: Zd("clean-styles"),
                        click: function() {
                            i(),
                                c(!1, t, e)
                        }
                    }
                        , r = {
                        text: s("cement.dialog.paste.merge"),
                        tabindex: 1,
                        className: Zd("merge-styles"),
                        click: function() {
                            i(),
                                c(!0, t, e)
                        }
                    }
                        , i = function() {
                        u.destroy()
                    }
                        , u = a(!0);
                    u.setTitle(s("cement.dialog.paste.title")),
                        u.setContent(n),
                        u.setButtons([o, r]),
                        u.events.close.bind(function() {
                            e(G.none()),
                                i()
                        }),
                        u.show()
                }(n, e)
            },
            destroy: y
        }
    }
    function tm(t, e) {
        var i = Qd(t, e);
        return function(t, n) {
            var r = n.bundle
                , o = n.response;
            return ha(function(e) {
                i.get(xa(r), function(t) {
                    t = t.fold(function() {
                        return {
                            response: pa(),
                            bundle: n.bundle
                        }
                    }, function(t) {
                        return {
                            response: o,
                            bundle: fa({
                                officeStyles: t.officeStyles,
                                htmlStyles: t.htmlStyles
                            })
                        }
                    });
                    hu(e, t)
                })
            })
        }
    }
    function em(t) {
        var e, n = t.dom;
        try {
            var r = n.contentWindow ? n.contentWindow.document : n.contentDocument;
            return e = r,
                r = mn.fromDom,
                null != e ? G.some(r(e)) : G.none()
        } catch (t) {
            return console.log("Error reading iframe: ", n),
                console.log("Error was: " + t),
                G.none()
        }
    }
    function nm(t, e) {
        if (!Ho(t))
            throw "Internal error: attempted to write to an iframe that is not in the DOM";
        var n;
        (t = em(n = t).getOrThunk(function() {
            return qr(n)
        }).dom).open("text/html", "replace"),
            t.writeln(e),
            t.close()
    }
    var rm, om, im, um, am = tm, cm = function(r, o) {
        return function(t, e) {
            function n(t) {
                return vu({
                    response: e.response,
                    bundle: fa({
                        officeStyles: t,
                        htmlStyles: t
                    })
                })
            }
            return Su(e.bundle) ? n(!0) : e.bundle.isGoogleDocs.getOr(!1) ? n(!1) : tm(r, o)(t, e)
        }
    }, sm = function(t) {
        t = t.dom.styleSheets;
        return Array.prototype.slice.call(t)
    }, pn = {}, Bt = {
        exports: pn
    };
    om = pn,
        im = Bt,
        um = rm = void 0,
        function(t) {
            "object" == typeof om && void 0 !== im ? im.exports = t() : "function" == typeof rm && rm.amd ? rm([], t) : ("undefined" != typeof window ? window : "undefined" != typeof global ? global : "undefined" != typeof self ? self : this).EphoxContactWrapper = t()
        }(function() {
            return function r(o, i, u) {
                function a(e, t) {
                    if (!i[e]) {
                        if (!o[e]) {
                            var n = "function" == typeof um && um;
                            if (!t && n)
                                return n(e, !0);
                            if (c)
                                return c(e, !0);
                            throw (n = new Error("Cannot find module '" + e + "'")).code = "MODULE_NOT_FOUND",
                                n
                        }
                        n = i[e] = {
                            exports: {}
                        },
                            o[e][0].call(n.exports, function(t) {
                                return a(o[e][1][t] || t)
                            }, n, n.exports, r, o, i, u)
                    }
                    return i[e].exports
                }
                for (var c = "function" == typeof um && um, t = 0; t < u.length; t++)
                    a(u[t]);
                return a
            }({
                1: [function(t, e, n) {
                    var r, u, r = (r = function(t) {
                        for (var e, n = [], r = t.split(","), o = 0, i = r.length; o < i; o += 1)
                            0 < (e = r[o]).length && n.push(u(e));
                        return n
                    }
                        ,
                        u = function(c) {
                            var t, e, s = c, f = {
                                a: 0,
                                b: 0,
                                c: 0
                            }, l = [];
                            function n(t) {
                                var e, n, r, o;
                                if (t.test(s))
                                    for (n = 0,
                                             r = (e = s.match(t)).length; n < r; n += 1)
                                        o = e[n],
                                            s = s.replace(o, Array(o.length + 1).join("A"))
                            }
                            return t = function(t, e) {
                                var n, r, o, i, u, a;
                                if (t.test(s))
                                    for (r = 0,
                                             o = (n = s.match(t)).length; r < o; r += 1)
                                        f[e] += 1,
                                            i = n[r],
                                            u = s.indexOf(i),
                                            a = i.length,
                                            l.push({
                                                selector: c.substr(u, a),
                                                type: e,
                                                index: u,
                                                length: a
                                            }),
                                            s = s.replace(i, Array(a + 1).join(" "))
                            }
                                ,
                                n(/\\[0-9A-Fa-f]{6}\s?/g),
                                n(/\\[0-9A-Fa-f]{1,5}\s/g),
                                n(/\\./g),
                            (e = /:not\(([^\)]*)\)/g).test(s) && (s = s.replace(e, "     $1 ")),
                                function() {
                                    var t, e, n, r, o = /{[^]*/gm;
                                    if (o.test(s))
                                        for (e = 0,
                                                 n = (t = s.match(o)).length; e < n; e += 1)
                                            r = t[e],
                                                s = s.replace(r, Array(r.length + 1).join(" "))
                                }(),
                                t(/(\[[^\]]+\])/g, "b"),
                                t(/(#[^\#\s\+>~\.\[:]+)/g, "a"),
                                t(/(\.[^\s\+>~\.\[:]+)/g, "b"),
                                t(/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi, "c"),
                                t(/(:[\w-]+\([^\)]*\))/gi, "b"),
                                t(/(:[^\s\+>~\.\[:]+)/g, "b"),
                                s = (s = s.replace(/[\*\s\+>~]/g, " ")).replace(/[#\.]/g, " "),
                                t(/([^\s\+>~\.\[:]+)/g, "c"),
                                l.sort(function(t, e) {
                                    return t.index - e.index
                                }),
                                {
                                    selector: c,
                                    specificity: "0," + f.a.toString() + "," + f.b.toString() + "," + f.c.toString(),
                                    specificityArray: [0, f.a, f.b, f.c],
                                    parts: l
                                }
                        }
                        ,
                        {
                            calculate: r,
                            compare: function(t, e) {
                                var n, r, o;
                                if ("string" == typeof t) {
                                    if (-1 !== t.indexOf(","))
                                        throw "Invalid CSS selector";
                                    n = u(t).specificityArray
                                } else {
                                    if (!Array.isArray(t))
                                        throw "Invalid CSS selector or specificity array";
                                    if (4 !== t.filter(function(t) {
                                        return "number" == typeof t
                                    }).length)
                                        throw "Invalid specificity array";
                                    n = t
                                }
                                if ("string" == typeof e) {
                                    if (-1 !== e.indexOf(","))
                                        throw "Invalid CSS selector";
                                    r = u(e).specificityArray
                                } else {
                                    if (!Array.isArray(e))
                                        throw "Invalid CSS selector or specificity array";
                                    if (4 !== e.filter(function(t) {
                                        return "number" == typeof t
                                    }).length)
                                        throw "Invalid specificity array";
                                    r = e
                                }
                                for (o = 0; o < 4; o += 1) {
                                    if (n[o] < r[o])
                                        return -1;
                                    if (n[o] > r[o])
                                        return 1
                                }
                                return 0
                            }
                        });
                    void 0 !== n && (n.calculate = r.calculate,
                        n.compare = r.compare)
                }
                    , {}],
                2: [function(t, e, n) {
                    t = t("specificity");
                    e.exports = {
                        boltExport: t
                    }
                }
                    , {
                        specificity: 1
                    }]
            }, {}, [2])(2)
        });
    function fm(t) {
        return ft(t, Mm)
    }
    function lm(e, t, n) {
        t = ft(t, function(i) {
            var t = Ro(e, i.selector);
            return ct(t, function(t) {
                var n, r, o, e = (n = i.raw,
                    r = t,
                    o = {},
                    ct(n, function(t) {
                        var e;
                        void 0 !== n[t] && (e = r.dom.style,
                        S(e, t) || (o[t] = n[t]))
                    }),
                    o);
                Ku(t, e)
            }),
                t
        }),
        n && ct(t, function(t) {
            Ue(t, "class")
        })
    }
    function dm(t, e, n) {
        function r(t) {
            return -1 !== t.selector.indexOf(",")
        }
        var o = ft(st(t, r), function(e) {
            var t = e.selector.split(",");
            return at(t, function(t) {
                return {
                    selector: t.trim(),
                    raw: e.raw
                }
            })
        });
        (o = st(t, function(t) {
            return !r(t)
        }).concat(o)).sort(function(t, e) {
            return Rm.compare(t.selector, e.selector)
        }).reverse(),
            lm(e, o, n)
    }
    function mm(t, e, n, r) {
        t = sm(t),
            t = fm(t).map(function(t) {
                var e = t.selector;
                return {
                    selector: n.hasOwnProperty(e) ? n[e] : e,
                    raw: t.raw
                }
            }),
            dm(t, e, r)
    }
    function pm(t, e, n, r) {
        t = sm(t),
            t = fm(t),
            t = st(t, function(t) {
                return kt(t.selector, n)
            }),
            dm(t, e, r)
    }
    function gm(t, e, n, r) {
        t = sm(t),
            t = fm(t),
            t = st(t, function(t) {
                return S(n, t.selector)
            }),
            dm(t, e, r)
    }
    function vm(t) {
        var e, n = (e = mn.fromTag("span"),
            Ki(t, e),
            e);
        return {
            convertToPx: function(t) {
                var e;
                return Gu(n, "margin-left", t),
                    e = Xu(n, "margin-left"),
                    parseFloat(e.match(/-?\d+\.?\d*/)[0])
            },
            destroy: function() {
                return La(n)
            }
        }
    }
    function hm(n) {
        var t, r = (t = mn.fromDom(document.body),
            {
                play: function(n, r, o) {
                    var i = mn.fromTag("div")
                        , u = mn.fromTag("iframe");
                    Ku(i, {
                        display: "none"
                    });
                    var a = Do(u, "load", function() {
                        a.unbind(),
                            nm(u, n);
                        var t = null === (e = u.dom.contentWindow) || void 0 === e ? void 0 : e.document;
                        if (void 0 === t)
                            throw "sandbox iframe load event did not fire correctly";
                        var e = mn.fromDom(t)
                            , t = e.dom.body;
                        if (void 0 === t)
                            throw "sandbox iframe does not have a body";
                        t = mn.fromDom(t),
                            t = r(e, t);
                        La(i),
                            setTimeout(p(o, t), 0)
                    });
                    eu(i, u),
                        eu(t, i)
                }
            });
        return function(t, e) {
            r.play(t, function(t, e) {
                return function(t, e, n) {
                    n = n.mergeInline();
                    (n ? Fm.inlineStyles : Um)(t, e, jm),
                        Hm(e, n)
                }(t, e, {
                    mergeInline: l(n)
                }),
                    Qu(e)
            }, e)
        }
    }
    function ym(e, t, n, i, r) {
        function u(t) {
            hu(e, {
                response: t,
                bundle: fa({})
            })
        }
        n = r.sanitizeHtml(n, "word"),
            hm(t)(n, function(t) {
                function e(t) {
                    u(ma(n, t))
                }
                var n = Vi(t)
                    , r = mn.fromTag("div");
                Zi(r, n);
                var o = st(zr("img[src]", r), function(t) {
                    return Fe(t, "src").exists(function(t) {
                        return kt(t, "blob:") || kt(t, "data:")
                    })
                })
                    , t = zr("img[data-image-src]", r);
                0 === o.length && 0 === t.length ? e([]) : i ? (ct(o, function(t) {
                    return Ue(t, "id")
                }),
                    Qt(o, function(i) {
                        return Jt.nu(function(r) {
                            var o = i.dom;
                            Je(o).then(function(n) {
                                n.toBlob().then(function(t) {
                                    var e = kt(o.src, "blob:") ? o.src : URL.createObjectURL(t)
                                        , t = $t("image")
                                        , e = Ht.blob(t, n, e);
                                    r(xd(e, i))
                                })
                            })
                        })
                    }).get(e)) : (ct(o, La),
                    ct(t, La),
                    r = So(r),
                    u(ga(r, [], "errors.local.images.disallowed")))
            })
    }
    function bm(t, r, e, o) {
        var i = t.html;
        return ha(function(n) {
            e.cleanDocument(i, r, o).then(function(t) {
                var e;
                null == (e = t) || 0 === e.length ? hu(n, {
                    response: ma([], []),
                    bundle: fa({})
                }) : (e = void 0 === o.sanitizer ? Nd(o.intraFlag.isMarked) : o.sanitizer,
                    ym(n, r, t, o.allowLocalImages, e))
            }, function(t) {
                console.error("PowerPaste error code: WIM01"),
                    hu(n, {
                        response: da("errors.paste.process.failure"),
                        bundle: fa({})
                    })
            })
        })
    }
    function xm(t) {
        var t = st(t, function(t) {
            return "file" === t.kind && /image/.test(t.type)
        })
            , n = I(t, function(t, e) {
            e = e.getAsFile();
            return null !== e ? t.concat(e) : t
        }, []);
        return ha(function(e) {
            en(n).get(function(t) {
                var i, u, t = (i = [],
                    u = [],
                    ct(t, function(o) {
                        return Ht.cata(o, function(t, e, n) {
                            var r = mn.fromTag("img");
                            fn(r, "src", n),
                                i.push(r),
                                u.push(xd(o, r))
                        }, function(t, e, n) {
                            console.error("Internal error: Paste operation produced an image URL instead of a Data URI: ", e)
                        })
                    }),
                    ma(i, u));
                hu(e, {
                    response: t,
                    bundle: fa({})
                })
            })
        })
    }
    function Tm(t) {
        try {
            var e = t()
                , e = null != e && 0 < e.length ? Vi(e) : [];
            return zo.value(e)
        } catch (t) {
            return console.error("PowerPaste error code: PT01. Message: ", t),
                zo.error("errors.paste.process.failure")
        }
    }
    function wm(t) {
        return t.fold(yu, function(t) {
            return vu({
                response: ma(t, []),
                bundle: fa({})
            })
        })
    }
    function Em(t, e, n, r, o) {
        return Tm(function() {
            return function(t, e, n, r, o, i) {
                Yf(n);
                n = Qu(n),
                    i = Lf(o, r, e, i);
                return fc(t, n, i)
            }(t, Wm, e, n, r, {
                cleanFilteredInlineElements: o.cleanFilteredInlineElements
            })
        })
    }
    function Sm(t, e) {
        var n = Tm(function() {
            return vl(t, Qu(e))
        });
        return wm(n)
    }
    function Am(t, e, n, r, o, i) {
        return Em(t, e, r, n, i).fold(yu, function(n) {
            return ha(function(e) {
                o.get(function(t) {
                    var o, i, t = (t = t,
                        o = [],
                        i = ft(n, function(t) {
                            return ke("img")(t) ? [t] : Ro(t, "img")
                        }),
                        ct(t, function(r) {
                            Ht.cata(r, function(t, e, n) {
                                ct(i, function(t) {
                                    ln(t, "src") === n && o.push(xd(r, t))
                                })
                            }, y)
                        }),
                        o);
                    hu(e, {
                        response: ma(n, t),
                        bundle: fa({})
                    })
                })
            })
        })
    }
    function Im(t) {
        return "\n" === t || "\r" === t
    }
    function _m(t, e) {
        var o = t.replace(/\t/g, (t = " ",
            (e = e) <= 0 ? "" : new Array(e + 1).join(t)));
        return I(o, function(t, e) {
            return -1 !== " \f\t\v".indexOf(e) || "\xa0" === e ? t.pcIsSpace || "" === t.str || t.str.length === o.length - 1 || (n = o,
            (r = t.str.length + 1) < n.length && 0 <= r && Im(n[r])) ? {
                pcIsSpace: !1,
                str: t.str + "\xa0"
            } : {
                pcIsSpace: !0,
                str: t.str + " "
            } : {
                pcIsSpace: Im(e),
                str: t.str + e
            };
            var n, r
        }, {
            pcIsSpace: !1,
            str: ""
        }).str
    }
    function Lm(t, e) {
        var n, e = function(t, e) {
            e = _m(t, e).replace(/^[\r\n]*|[\r\n]*$/g, "").split(/(?:\r?\n){2}/),
                e = at(e, function(t) {
                    return t.split(/\n|\r\n/).join("<br />")
                });
            return 1 === e.length ? e[0] : at(e, function(t) {
                return "<p>" + t + "</p>"
            }).join("")
        }((n = t,
            t = mn.fromTag("div"),
            n = n,
            t.dom.textContent = n,
            Qu(t)), e), e = Vi(e);
        return ma(e, [])
    }
    function Om(o) {
        return function(t, e) {
            return n = o,
                r = zd(t).getOrDie("Required text input for Text Handler"),
                ha(function(t) {
                    var e = 0 < r.text.length ? Lm(r.text, n) : pa();
                    hu(t, {
                        response: e,
                        bundle: fa({})
                    })
                });
            var n, r
        }
    }
    function Dm(t, r) {
        function e(t, e) {
            var n = mn.fromTag("div");
            return Zi(n, t),
                Yf(n),
                n = So(n),
                vu({
                    response: ma(n, e),
                    bundle: r.bundle
                })
        }
        var n = p(va, r);
        return gu(r.response, n, e, n, e)
    }
    function Nm(r, o, i) {
        return function(t, e) {
            var n = Hd(t).getOrDie("Wrong input type for HTML handler").container
                , t = qr(o)
                , e = e.bundle;
            return Su(e) ? Sm(t, n) : (r(n),
                function(t, e, n, r) {
                    r = Em(t, e, n, !1, r);
                    return wm(r)
                }(t, n, Eu(e), i))
        }
    }
    function Cm(c, s, f) {
        return function(t, e) {
            var n, a = e.bundle;
            return n = a,
                function(t, e) {
                    return n.proxyBin.fold(function() {
                        return console.error(t),
                            vu({
                                response: pa(),
                                bundle: fa({})
                            })
                    }, e)
                }("There was no proxy bin setup. Ensure you have run proxyStep first.", function(t) {
                    var n, e = Eu(a), r = xa(a), o = Su(a), i = (n = a,
                        Jt.nu(function(e) {
                            n.backgroundAssets.fold(function() {
                                e([])
                            }, function(t) {
                                t.listen(e)
                            })
                        })), u = qr(c);
                    return o ? function(t, e, n, r) {
                        e = e.findClipboardTags(So(n)).getOr([]);
                        ct(e, La);
                        e = Jt.nu(function(t) {
                            return t([])
                        });
                        return Am(t, n, !1, !0, e, r)
                    }(u, s, t, f) : Am(u, t, r, e, i, f)
                })
        }
    }
    function Pm(t, e) {
        return vu({
            response: pa(),
            bundle: fa({})
        })
    }
    function km(r) {
        return function(t, e) {
            var n = pu(e.bundle, fa(r));
            return vu({
                response: e.response,
                bundle: n
            })
        }
    }
    var Rm = Bt.exports.boltExport
        , Mm = function(t) {
        t = t.cssRules;
        return ft(t, function(t) {
            return t.type === CSSRule.IMPORT_RULE ? Mm(t.styleSheet) : t.type === CSSRule.STYLE_RULE ? [function(t) {
                var e = t.selectorText
                    , n = t.style.cssText;
                if (void 0 === n)
                    throw new Error("WARNING: Browser does not support cssText property");
                return {
                    selector: e,
                    style: n,
                    raw: t.style
                }
            }(t)] : []
        })
    }
        , Bt = {
        inlineStyles: function(t, e, n) {
            mm(t, e, n, !0)
        },
        inlineStylesKeepClasses: function(t, e, n) {
            mm(t, e, n, !1)
        },
        inlinePrefixedStyles: function(t, e, n) {
            pm(t, e, n, !0)
        },
        inlinePrefixedStylesKeepClasses: function(t, e, n) {
            pm(t, e, n, !1)
        },
        inlineSelectorsStyles: function(t, e, n) {
            gm(t, e, n, !0)
        },
        inlineSelectorsStylesKeepClasses: function(t, e, n) {
            gm(t, e, n, !1)
        }
    }
        , Fm = {
        inlineStyles: Bt.inlineStyles,
        inlineStylesKeepClasses: Bt.inlineStylesKeepClasses,
        inlinePrefixedStyles: Bt.inlinePrefixedStyles,
        inlinePrefixedStylesKeepClasses: Bt.inlinePrefixedStylesKeepClasses,
        inlineSelectorsStyles: Bt.inlineSelectorsStyles,
        inlineSelectorsStylesKeepClasses: Bt.inlineSelectorsStylesKeepClasses
    }
        , jm = {
        p: "p, li[data-converted-paragraph]"
    }
        , Um = y
        , Hm = function(r, t) {
        function o(n) {
            Ue(n, "data-list-level"),
                Ue(n, "data-text-indent-alt"),
                Ue(n, "data-border-margin"),
                Zu(n, "margin-left"),
                Zu(n, "text-indent"),
                R(function(t) {
                    var e = {}
                        , n = t.dom;
                    if (qu(n))
                        for (var r = 0; r < n.style.length; r++) {
                            var o = n.style.item(r);
                            e[o] = n.style[o]
                        }
                    return e
                }(n), function(t, e) {
                    !kt(e, "border") || "border-image" !== e && "none" !== t.trim() && "initial" !== t.trim() || Zu(n, e)
                })
        }
        var e = Ro(r, "li[data-converted-paragraph]");
        ct(e, function(t) {
            Ue(t, "data-converted-paragraph")
        }),
        t && (t = Ro(r, "li"),
            ct(t, function(t) {
                var e = vm(r)
                    , n = function(t, e) {
                    t = Fe(t, "data-tab-interval").getOr("36pt");
                    return e.convertToPx(t)
                }(r, e)
                    , n = Bm(t, n, e).getOr({});
                o(t),
                    e.destroy(),
                    Ku(t, n)
            }),
            t = Ro(r, "ol,ul"),
            ct(t, function(e) {
                var t = Ro(e, "li");
                Ju(e, "margin-top").isNone() && G.from(t[0]).each(function(t) {
                    Gu(e, "margin-top", Xu(t, "margin-top"))
                }),
                Ju(e, "margin-bottom").isNone() && G.from(t[t.length - 1]).each(function(t) {
                    Gu(e, "margin-bottom", Xu(t, "margin-bottom"))
                })
            })),
            Ue(r, "data-tab-interval")
    }
        , Bm = function(i, u, a) {
        function c(t) {
            return Fe(t, "data-list-level").map(function(t) {
                return parseInt(t, 10)
            }).getOr(1)
        }
        return Ju(i, "text-indent").bind(function(o) {
            return Ju(i, "margin-left").map(function(t) {
                var e = Ju(i, "list-style").exists(function(t) {
                    return Pt(t, "none")
                })
                    , n = Fe(i, "data-border-margin").getOr("0px")
                    , r = e ? c(i) + 1 : c(i)
                    , e = a.convertToPx(t) + a.convertToPx(n)
                    , t = u * r
                    , n = Fe(i, "data-text-indent-alt").getOr(o)
                    , r = a.convertToPx(n)
                    , n = {}
                    , r = u / 2 * -1 - r;
                0 < r && (n["text-indent"] = r + "px");
                r = e - t - r;
                return n["margin-left"] = 0 < r ? r + "px" : "0px",
                    n
            })
        })
    }
        , Wm = wo()
        , zm = l(Zd("smartpaste-eph-bin"))
        , Ym = wo();
    function qm(r, a, c, s, o) {
        return function(t, e) {
            var n = Ud(t).getOrDie("Must pass through event type").nativeEvent
                , i = o()
                , u = e.response;
            return ha(function(o) {
                var t = r(c);
                t.events.after.bind(function(t) {
                    var e, n, r = t.container;
                    Ym.browser.isSafari() && Bi(r, 'img[src^="webkit-fake-url"]').isSome() ? (n = Ym.deviceType.isWebView() ? "webview.imagepaste" : "safari.imagepaste",
                        hu(o, {
                            response: da(n),
                            bundle: fa({})
                        })) : (a(r),
                        Li(r, zm()),
                        e = r,
                        n = ((n = (t = Ym).browser).isIE() && 11 <= n.version.major ? qf : $f)(e, t),
                        e = So(r),
                        t = s.findClipboardTags(e).isSome(),
                        e = ut(e, function(t) {
                            return un(t) && Fe(t, "id").exists(function(t) {
                                return kt(t, "docs-internal-guid")
                            })
                        }),
                        hu(o, {
                            response: u,
                            bundle: fa({
                                isWord: n,
                                isGoogleDocs: e,
                                isInternal: t,
                                proxyBin: r,
                                backgroundAssets: i
                            })
                        }))
                }),
                    i.convert(n),
                    t.run()
            })
        }
    }
    function $m(t, e) {
        if (0 === t.length)
            throw new Error("Zero length content passed to Hex conversion");
        return t = function(t) {
            for (var e = new Array(t.length / 2), n = 0; n < t.length; n += 2) {
                var r = t.substr(n, 2);
                e[Math.floor(n / 2)] = parseInt(r, 16)
            }
            return e
        }(t),
            t = new Uint8Array(t),
            new Blob([t],{
                type: e
            })
    }
    function Vm(t, e, n) {
        return e.indexOf(t, n)
    }
    function Gm(t, e, n, r, o, i, u) {
        return -1 === t || -1 === e ? G.none() : G.some({
            start: t,
            end: e,
            bower: n,
            regex: r,
            idRef: o,
            isEquation: i,
            attrs: u
        })
    }
    function Km(t, e, n) {
        return t.substring(e, n)
    }
    function Xm(t, e) {
        if (-1 === e)
            return e;
        var n = 0
            , r = t.length;
        do {
            var o = t.indexOf("{", e)
                , i = t.indexOf("}", e);
            if (o < i && -1 !== o ? (e = o + 1,
                ++n) : (i < o || o < 0) && -1 !== i && (e = i + 1,
                --n),
            r < e || -1 === i)
                return -1
        } while (0 < n);return e
    }
    function Jm(t, e, n, r, o) {
        var i, u = Km(t, n, r), a = (t = Vm("\\picscalex", i = t, a = n),
            a = Vm("\\bliptag", i, t),
            -1 < t && t < a ? G.from(i.substring(t, a)) : G.none());
        return Gm(n, r, u, /[^a-fA-F0-9]([a-fA-F0-9]+)\}$/, "i", o, a)
    }
    function Zm(t, e, n, r, o) {
        return t = Km(t, n, r),
            Gm(n, r, t, /([a-fA-F0-9]{64,})(?:\}.*)/, "s", o, G.none())
    }
    function Qm(t, e) {
        return cp(t, e)
    }
    function tp(t) {
        return 0 <= t.indexOf("\\pngblip") ? zo.value("image/png") : 0 <= t.indexOf("\\jpegblip") ? zo.value("image/jpeg") : zo.error("errors.imageimport.unsupported")
    }
    function ep(t, e) {
        return (e = t.match(e)) && e[1] && e[1].length % 2 == 0 ? zo.value(e[1]) : zo.error("errors.imageimport.invalid")
    }
    function np(t) {
        return null !== (t = t.match(/\\shplid(\d+)/)) ? G.some(t[1]) : G.none()
    }
    function rp(t) {
        for (var a = [], e = function() {
            return t.length
        }, n = function(t) {
            var e, r, o, i, u, n = (r = (e = t).bower,
                o = e.regex,
                i = e.isEquation,
                u = e.attrs,
                np(r).map(function(t) {
                    var n = e.idRef + t;
                    return tp(r).fold(function(t) {
                        return ap.unsupported(n, t, i, u)
                    }, function(e) {
                        return ep(r, o).fold(function(t) {
                            return ap.unsupported(n, t, i, u)
                        }, function(t) {
                            return ap.supported(n, e, $m(t, e), i, u)
                        })
                    })
                }));
            return a = a.concat(n.toArray()),
                t.end
        }, r = 0; r < t.length; )
            r = Qm(t, r).fold(e, n);
        return a
    }
    function op(t) {
        return ap.cata(t, function(t, e, n) {
            return t
        }, function(t, e, n, r, o) {
            return t
        })
    }
    function ip(t) {
        return ap.cata(t, function(t, e, n) {
            return n
        }, function(t, e, n, r, o) {
            return r
        })
    }
    function up(t) {
        return ap.cata(t, function(t, e, n) {
            return zo.error(e)
        }, function(t, e, n, r, o) {
            return zo.value(n)
        })
    }
    var jt = jt([{
        unsupported: ["id", "message", "isEquation", "attrs"]
    }, {
        supported: ["id", "contentType", "blob", "isEquation", "attrs"]
    }])
        , ap = {
        unsupported: jt.unsupported,
        supported: jt.supported,
        cata: function(t, e, n) {
            return t.fold(e, n)
        }
    }
        , cp = function(t, e) {
        var n = Vm("{\\pict{", t, e)
            , r = Xm(t, n)
            , o = Vm("{\\shp{", t, e)
            , i = Xm(t, o)
            , u = Vm("{\\mmathPict{", t, e)
            , a = Xm(t, u)
            , u = -1 !== u && (u < n && r < a || u < o && i < a)
            , a = p(Zm, t, e, o, i, u)
            , u = p(Jm, t, e, n, r, u);
        return -1 === n && -1 === o ? G.none() : -1 === n ? a() : -1 === o || o < n && r < i ? u() : n < o && i < r ? a() : n < o ? u() : o < n ? a() : G.none()
    }
        , sp = function(t) {
        t = t.replace(/\r/g, "").replace(/\n/g, "");
        return rp(t)
    }
        , fp = function(t) {
        return sp(t)
    };
    function lp(e, n, r, o, i) {
        return e.toCanvas().then(function(t) {
            return function(t, e, n, r, o, i) {
                i = ee(o, i);
                return re(i).drawImage(t, -n, -r),
                    function(e, t) {
                        return be(e, t).then(function(t) {
                            return Ae(ae.resolve(e), t, e.toDataURL())
                        })
                    }(i, e)
            }(t, e.getType(), n, r, o, i)
        })
    }
    function dp(t, e) {
        return e = new RegExp("\\\\pic" + e + "(\\-?\\d+)\\\\"),
            e = t.match(e)[1],
            parseInt(e, 10)
    }
    function mp(m, t) {
        return t.fold(function() {
            return Vt.resolve(m)
        }, function(d) {
            return Ht.cata(m, function(s, f, l) {
                return f.toCanvas().then(function(t) {
                    var e, n, r, o, i, u = mn.fromDom(t), a = Fe(u, "width").map(function(t) {
                        return parseInt(t, 10)
                    }).getOr(1), c = Fe(u, "height").map(function(t) {
                        return parseInt(t, 10)
                    }).getOr(1), e = (n = a,
                        r = c,
                        o = p(dp, e = d),
                        i = o("wgoal"),
                        t = o("hgoal"),
                        u = i / n,
                        e = t / r,
                        n = o("cropl"),
                        r = o("cropt"),
                        {
                            cropl: n / u,
                            cropt: r / e,
                            cropw: (i - n - o("cropr")) / u,
                            croph: (t - r - o("cropb")) / e
                        });
                    return a === e.cropw && c === e.croph && 0 === e.cropl && 0 === e.cropt ? Vt.resolve(m) : gp(f, e.cropl, e.cropt, e.cropw, e.croph).then(function(e) {
                        return e.toBlob().then(function(t) {
                            URL.revokeObjectURL(l);
                            t = URL.createObjectURL(t);
                            return Ht.blob(s, e, t)
                        })
                    })
                })
            }, function(t, e, n) {
                return Vt.resolve(m)
            })
        })
    }
    function pp(t, e, i, u, a) {
        var c = []
            , s = []
            , f = !1;
        return {
            blobs: ft(t, function(r, n) {
                var o = ln(r, "data-image-id");
                return Ue(r, "rtf-data-image"),
                    Ue(r, "data-image-id"),
                    Ue(r, "data-ms-equation"),
                a || Ue(r, "data-image-src"),
                    "unsupported" === o ? (f = !0,
                        fn(r, "alt", i("errors.imageimport.unsupported")),
                        []) : _(e, function(t, e) {
                        return u(t, e, o, n)
                    }).fold(function() {
                        return console.log("WARNING: unable to find data for image ", r.dom),
                            f = !0,
                            fn(r, "alt", i("errors.imageimport.unsupported")),
                            []
                    }, function(n) {
                        return up(n).fold(function(t) {
                            return f = !0,
                                console.error("PowerPaste error code: RTF04"),
                                fn(r, "alt", i(t)),
                                []
                        }, function(t) {
                            var e;
                            return c.push(r),
                                s.push((e = n,
                                    ap.cata(e, function(t, e, n) {
                                        return G.none()
                                    }, function(t, e, n, r, o) {
                                        return o
                                    }))),
                            a && Ue(r, "data-image-src"),
                                [t]
                        })
                    })
            }),
            filteredImages: c,
            imageAttrs: s,
            failedImage: f
        }
    }
    var gp = lp
        , vp = function(t, e, r, n, o) {
        var i = I(e, function(e, n) {
            var r = op(n)
                , o = ip(n);
            return L(e, function(t) {
                return !(o || ip(t)) && op(t) === r
            }).fold(function() {
                return e.concat([n])
            }, function(t) {
                return up(e[t]).isValue() ? e : e.slice(0, t).concat(e.slice(t + 1)).concat([n])
            })
        }, [])
            , u = o.keepSrc || !1
            , e = A(i, function(t) {
            return !ip(t)
        })
            , o = e.pass
            , i = e.fail
            , e = A(t, function(t) {
            return "true" !== ln(t, "data-ms-equation")
        })
            , t = e.pass
            , e = e.fail
            , o = pp(t, o, n, function(t, e, n, r) {
            return op(t) === n
        }, u)
            , n = pp(e, i, n, function(t, e, n, r) {
            return e === r
        }, u)
            , a = o.filteredImages.concat(n.filteredImages)
            , c = o.imageAttrs.concat(n.imageAttrs)
            , u = o.blobs.concat(n.blobs)
            , s = o.failedImage || n.failedImage;
        en(u).get(function(t) {
            var n;
            n = c,
                ((t = t).length === n.length ? Vt.all(at(t, function(t, e) {
                    return mp(t, n[e])
                })) : Vt.resolve(t)).then(function(t) {
                    t = wd(t, a);
                    r(t, s)
                })
        })
    }
        , hp = function(t) {
        return Ro(t, "[rtf-data-image]")
    };
    function yp(i) {
        function u(e) {
            f.get().each(function(t) {
                hu(t, {
                    response: e,
                    bundle: fa({})
                })
            })
        }
        var a, c, s = (a = i.translations,
            {
                events: (c = Go({
                    insert: Vo(["elements", "correlated"]),
                    incomplete: Vo(["elements", "correlated", "message"])
                })).registry,
                processRtf: function(r, o, t, e) {
                    var n = fp(t)
                        , t = hp(r);
                    vp(t, n, function(t, e) {
                        var n = So(r)
                            , t = t.concat(o);
                        e ? (console.error("PowerPaste error code: RTF01"),
                            c.trigger.incomplete(n, t, "errors.imageimport.failed")) : c.trigger.insert(n, t)
                    }, a, e)
                }
            }), f = fu(G.none());
        return s.events.insert.bind(function(t) {
            u(ma(t.elements, t.correlated))
        }),
            s.events.incomplete.bind(function(t) {
                console.error("PowerPaste error code: RTF02"),
                    u(ga(t.elements, t.correlated, t.message))
            }),
            function(t, r) {
                function e(o) {
                    return ha(function(e) {
                        function t() {
                            hu(e, r)
                        }
                        function n(t, n) {
                            f.set(G.some(e));
                            var r = mn.fromTag("div");
                            Zi(r, t),
                                o.fold(function() {
                                    var t, e = hp(r);
                                    return 0 < e.length ? function(t) {
                                        ct(t, La);
                                        t = So(r);
                                        console.error("PowerPaste error code: RTF03"),
                                            u(ga(t, n, "errors.imageimport.failed"))
                                    }(e) : (t = So(r),
                                        void u(ma(t, n)))
                                }, function(t) {
                                    s.processRtf(r, n, t, i)
                                })
                        }
                        gu(r.response, t, n, t, n)
                    })
                }
                t = Wd(t).getOrDie("Word input required for rtf data");
                return function(e, n) {
                    var t = Ot(n);
                    if (t.length !== hl.length)
                        throw new Error("Partial match");
                    return P(t, function(t) {
                        return Vf(e.discriminator === t, n[t])
                    }).getOrDie("Must find branch for constructor: " + e.discriminator)(e.data)
                }(t.rtf, {
                    disabled: function() {
                        return e(G.none())
                    },
                    fromClipboard: function(t) {
                        return e(!0 === i.allowLocalImages ? G.some(t.rtf) : G.none())
                    }
                })
            }
    }
    function bp(o) {
        function i() {
            return Jt.pure(o)
        }
        return Ht.cata(o.asset, function(t, e, n) {
            return /tiff$/.test(e.getType()) ? (r = e,
                Jt.nu(function(e) {
                    var t = Le(r, "image/png").then(function(t) {
                        Oe(t).map(G.some).get(e)
                    });
                    return t.catch.call(t, function(t) {
                        return console.warn(t),
                            e(G.none()),
                            t
                    })
                }).map(function(t) {
                    return t.map(function(t) {
                        var e = o.image;
                        return URL.revokeObjectURL(n),
                            Td(t, e),
                            xd(t, e)
                    }).getOr(o)
                })) : i();
            var r
        }, i)
    }
    function xp() {
        return function(t, o) {
            return ha(function(n) {
                function t() {
                    hu(n, o)
                }
                function r(t, e) {
                    Qt(t, bp).get(function(t) {
                        hu(n, {
                            response: e(t),
                            bundle: o.bundle
                        })
                    })
                }
                gu(o.response, t, function(e, t) {
                    r(t, function(t) {
                        return ma(e, t)
                    })
                }, t, function(e, t, n) {
                    r(t, function(t) {
                        return console.error("PowerPaste error code:  IMG01"),
                            ga(e, t, n)
                    })
                })
            })
        }
    }
    function Tp(t) {
        return l(t)
    }
    function wp(t, e) {
        return t.isSupported ? e.getWordData() : G.none()
    }
    function Ep(t) {
        return t.getNative()
    }
    function Sp(t) {
        return t.getImage()
    }
    function Ap(t) {
        return t.getHtml()
    }
    function Ip(t) {
        return t.getText()
    }
    function _p(t) {
        return t.getOnlyText()
    }
    function Lp(t) {
        return t.getGoogleDocsData()
    }
    function Op(t) {
        return t.getVoid()
    }
    function Dp(t, e, n, r) {
        return {
            _label: t,
            label: l(t),
            getAvailable: e,
            steps: l(n),
            capture: l(r)
        }
    }
    function Np(t, e, n, r) {
        return {
            _label: t,
            label: l(t),
            getAvailable: e,
            steps: l(n),
            capture: l(r)
        }
    }
    function Cp(t, e, n, r) {
        return Dp(Kd.native, Ap, [Tp((o = e.intraFlag,
                function(t, e) {
                    t = Hd(t).getOrDie("Wrong input type for HTML handler"),
                        t = o.findClipboardTags(So(t.container));
                    t.each(function(t) {
                        ct(t, La)
                    });
                    t = t.isSome();
                    return vu({
                        response: e.response,
                        bundle: fa({
                            isInternal: t
                        })
                    })
                }
        )), Tp(cm(t, e)), Tp(Nm(n, r, e)), Tp(Jd(e)), Tp(xp())], !0);
        var o
    }
    function Pp(t, e, n) {
        return Dp(Kd.msoffice, p(wp, t), [Tp(km({
            isWord: !0
        })), Tp(am(e, n)), Tp((o = t,
                i = n,
                function(t, e) {
                    t = Wd(t).getOrDie("Wrong input type for Word Import handler"),
                        e = ya(e.bundle);
                    return bm(t, e, o, i)
                }
        )), (r = yp(n),
                function(n) {
                    return function(t, e) {
                        return n.block(),
                            r(t, e).map(function(t) {
                                return n.unblock(),
                                    t
                            })
                    }
                }
        ), Tp(xp())], !0);
        var r, o, i
    }
    function kp(t) {
        return Dp(Kd.image, Sp, [Tp(!1 === t.allowLocalImages ? function(t, e) {
                return yu("errors.local.images.disallowed")
            }
            : function(t, e) {
                t = Bd(t).getOrDie("Must have image data for images handler");
                return xm(t.images)
            }
        ), Tp(xp())], !0)
    }
    var Rp = function(t) {
        return void 0 === t && (t = 4),
            Dp(Kd.text, Ip, [Tp(Om(t)), Tp(Dm)], !0)
    }
        , Mp = function() {
        return Np(Kd.discard, Op, [Tp(Pm)], !0)
    }
        , Fp = function(t, e, n, r, o) {
        void 0 === o && (o = Sc);
        var i, u = Ta(o, r.baseUrl, r.cacheSuffix), a = Ba(void 0 !== r.pasteBinAttrs ? r.pasteBinAttrs : {}), c = void 0 === r.sanitizer ? Nd(r.intraFlag.isMarked) : r.sanitizer, i = [function(t) {
            t = G.from(t.tabSpaces).getOr(4);
            return Dp(Kd.plaintext, _p, [Tp(Om(t)), Tp(Dm)], !0)
        }(r), Pp(u, e, r), (i = r,
            o = n,
            u = t,
            Dp(Kd.googledocs, Lp, [Tp(km({
                officeStyles: !1,
                htmlStyles: !1
            })), Tp(Nm(o, u, i)), Tp(Jd(i)), Tp(xp())], !0)), Cp(e, r, n, t), kp(r)], r = (e = e,
            r = r,
            n = n,
            a = a,
            t = t,
            Np(Kd.fallback, Ep, [Tp(qm(a, n, t, r.intraFlag, bd)), Tp(cm(e, r)), Tp(Cm(t, r.intraFlag, r)), Tp(Jd(r)), Tp(xp())], !1));
        return Xd(i, r, c)
    };
    function jp() {
        function a(t, e, n) {
            function r(n) {
                return function() {
                    for (var t = [], e = 0; e < arguments.length; e++)
                        t[e] = arguments[e];
                    o || (o = !0,
                    null !== i && (clearTimeout(i),
                        i = null),
                        n.apply(null, t))
                }
            }
            void 0 === n && (n = 1e3);
            var o = !1
                , i = null
                , t = r(t)
                , u = r(e);
            return {
                reject: u,
                resolve: t,
                start: function() {
                    for (var t = [], e = 0; e < arguments.length; e++)
                        t[e] = arguments[e];
                    o || (i = setTimeout(function() {
                        return u.apply(null, t)
                    }, n))
                }
            }
        }
        var n = {}
            , c = {};
        tinymce.Resource = {
            add: function(t, e) {
                c[t] && (c[t](e),
                    delete c[t]),
                    n[t] = Vt.resolve(e)
            },
            load: function(r, o) {
                var i = 'Script at URL "' + o + '" failed to load'
                    , u = 'Script at URL "' + o + "\" did not call `tinymce.Resource.add('" + r + "', data)` within 1 second";
                if (void 0 !== n[r])
                    return n[r];
                var t = new Vt(function(t, e) {
                        var n = a(t, e);
                        c[r] = n.resolve,
                            tinymce.ScriptLoader.loadScripts([o], function() {
                                return n.start(u)
                            }, function() {
                                return n.reject(i)
                            })
                    }
                );
                return n[r] = t
            }
        }
    }
    function Up(t, e, n) {
        var r;
        if (r = t,
        !1 === tinymce.Env.iOS && "function" == typeof (null == r ? void 0 : r.setData))
            try {
                return t.clearData(),
                    t.setData("text/html", e),
                    t.setData("text/plain", n),
                    t.setData(Or(), e),
                    1
            } catch (t) {
                return
            }
    }
    function Hp(t, e, n, r) {
        Up(t.clipboardData, e.html, e.text) ? (t.preventDefault(),
            r()) : n(e.html, r)
    }
    function Bp(i) {
        return function(t, e) {
            var n = i.dom.create("div", {
                contenteditable: "false",
                "data-mce-bogus": "all"
            })
                , r = i.dom.create("div", {
                contenteditable: "true",
                "data-mce-bogus": "all"
            }, t);
            i.dom.setStyles(n, {
                position: "fixed",
                top: "50%",
                left: "-3000px",
                width: "1000px",
                overflow: "hidden"
            }),
                n.appendChild(r),
                i.dom.add(i.getBody(), n);
            var o = i.selection.getRng();
            r.focus();
            t = i.dom.createRng();
            t.selectNodeContents(r),
                i.selection.setRng(t),
                setTimeout(function() {
                    var t;
                    i.selection.setRng(o),
                    null !== (t = n.parentNode) && void 0 !== t && t.removeChild(n),
                        e()
                }, 0)
        }
    }
    function Wp(t) {
        var e = t.selection.getContent({
            contextual: !0
        }).replace(/ contenteditable="([^"]+)"/g, ' data-mce-contenteditable="$1"');
        return {
            html: Dr + e,
            text: t.selection.getContent({
                format: "text"
            })
        }
    }
    function zp(t) {
        return !t.selection.isCollapsed() || null !== (t = t).dom.getParent(t.selection.getStart(), "td[data-mce-selected],th[data-mce-selected]", t.getBody())
    }
    function Yp(t, e) {
        return e = new Zp({},t.schema).parse(e, {
            forced_root_block: !1,
            isRootContent: !0
        }),
            new Qp({
                validate: !0
            },t.schema).serialize(e)
    }
    function qp(t) {
        return /^https?:\/\/[\w\?\-\/+=.&%@~#]+$/i.test(t)
    }
    function $p(n) {
        var t = /^<a href="([^"]+)">([^<]+)<\/a>$/.exec(n);
        return G.from(t).bind(function(t) {
            var e = {
                url: t[1],
                html: n
            };
            return Vf(t[1] === t[2], e)
        })
    }
    function Vp(t, e, n) {
        return "extra"in t.undoManager ? (t.undoManager.extra(function() {
            rg(t, e)
        }, n),
            G.some(!0)) : G.none()
    }
    var Gp = Object.freeze({
        __proto__: null,
        loadScript: function(t, e) {
            return tinymce.Resource || jp(),
                tinymce.Resource.load(t, e)
        }
    })
        , Kp = function(t) {
        (n = document.createElement("div")).appendChild(t.cloneNode(!0));
        var e = n.innerHTML
            , n = t = null;
        return e
    }
        , Xp = function(t) {
        ct(at(t.getElementsByTagName("*"), mn.fromDom), function(e) {
            je(e, "data-mce-style") && !je(e, "style") && Fe(e, "data-mce-style").each(function(t) {
                return fn(e, "style", t)
            })
        })
    }
        , Jp = function(t) {
        var n, e;
        t.on("cut", (n = t,
                function(t) {
                    zp(n) && Hp(t, Wp(n), Bp(n), function() {
                        var t, e = wo().browser;
                        e.isChrome() || e.isFirefox() ? (t = n.selection.getRng(),
                            tinymce.util.Delay.setEditorTimeout(n, function() {
                                n.selection.setRng(t),
                                    n.execCommand("Delete")
                            }, 0)) : n.execCommand("Delete")
                    })
                }
        )),
            t.on("copy", (e = t,
                    function(t) {
                        zp(e) && Hp(t, Wp(e), Bp(e), y)
                    }
            ))
    }
        , Zp = tinymce.html.DomParser
        , Qp = tinymce.html.Serializer
        , tg = function(t) {
        return {
            sanitizeHtml: p(Yp, t),
            sanitizeText: u
        }
    }
        , eg = function(r, t) {
        return $p(t).bind(function(t) {
            var e, n;
            return !1 === r.selection.isCollapsed() && qp(t.url) ? Vp(e = r, (n = t).html, function() {
                e.execCommand("mceInsertLink", !1, n.url)
            }) : G.none()
        })
    }
        , ng = function(u, t) {
        return $p(t).bind(function(t) {
            return r = t.url,
                o = _t(u),
                i = r.toLowerCase(),
                qp(i) && ut(o, function(t) {
                    return Rt(i, "." + t.toLowerCase())
                }) ? Vp(e = u, (n = t).html, function() {
                    e.insertContent('<img src="' + n.url + '">')
                }) : G.none();
            var e, n, r, o, i
        })
    }
        , rg = function(t, e) {
        return t.insertContent(e, {
            merge: St(t),
            paste: !0
        }),
            G.some(!0)
    }
        , og = function(e, n, t) {
        return P(t, function(t) {
            return t(e, n)
        })
    };
    var ig = {
        showDialog: function(t, e) {
            e = {
                title: "Error",
                body: {
                    type: "panel",
                    items: [{
                        type: "htmlpanel",
                        html: e
                    }]
                },
                initialData: {},
                buttons: [{
                    text: "OK",
                    type: "cancel",
                    name: "ok",
                    primary: !0
                }]
            };
            t.windowManager.open(e)
        }
    }
        , ug = function() {
        var e = fu([{
            text: "Close",
            name: "close",
            type: "custom",
            primary: !0
        }])
            , r = fu({});
        return {
            setButtons: function(t) {
                var n = {}
                    , t = at(t, function(t) {
                    var e = t.text;
                    return n[e.toLowerCase()] = t.click,
                        {
                            text: e,
                            name: e.toLowerCase(),
                            type: "custom"
                        }
                });
                r.set(n),
                    e.set(t)
            },
            getButtons: e.get,
            getAction: function(t) {
                var e = r.get();
                return e.hasOwnProperty(t) ? G.some(e[t]) : G.none()
            }
        }
    };
    function ag(u, a, t, e, s, f) {
        function l(t, e, n) {
            var r, o = pt(t) ? [eg, ng] : [];
            og(t, e, o.concat([(r = n,
                    function(t, e) {
                        return t.undoManager.transact(function() {
                            rg(t, e),
                                Xp(t.getBody()),
                                s.prepareImages(r)
                        }),
                            G.some(!0)
                    }
            )]))
        }
        function d() {
            p.on(function(t) {
                return u.selection.moveToBookmark(t)
            }),
                p.clear()
        }
        var n, r, m = lu(), p = du(), g = (n = e ? e.jsUrl : t,
            r = "/js",
        n.replace(/\/$/, "") + "/" + r.replace(/^\//, "")), o = Nd(Nr), i = tg(u), v = {
            sanitizeText: o.sanitizeText,
            sanitizeHtml: function(t, e) {
                return (Nr(t) ? i : o).sanitizeHtml(t, e)
            }
        }, h = It(u);
        u.on("init", function() {
            var c, i, t = {
                baseUrl: g,
                cacheSuffix: yt(u),
                officeStyles: xt(u),
                htmlStyles: Tt(u),
                translations: vn,
                allowLocalImages: bt(u),
                pasteBinAttrs: {
                    "data-mce-bogus": "all"
                },
                intraFlag: {
                    isMarked: Nr,
                    findClipboardTags: function(t) {
                        t = st(t, function(t) {
                            return on(t) && Pt(ca(t), Or())
                        });
                        return t.length ? G.some(t) : G.none()
                    }
                },
                keepSrc: vt(u),
                cleanFilteredInlineElements: At(u),
                sanitizer: v,
                tabSpaces: h
            }, e = f ? (i = u,
                {
                    createDialog: function() {
                        function e() {
                            t.trigger.close()
                        }
                        var n = ""
                            , r = du()
                            , o = ug()
                            , t = Go({
                            close: Vo([])
                        });
                        return {
                            events: t.registry,
                            setTitle: function(t) {
                                return n = t
                            },
                            setContent: function(t) {
                                return r.set(t)
                            },
                            setButtons: function(t) {
                                o.setButtons(t)
                            },
                            show: function() {
                                r.on(function(t) {
                                    t = Kp(t.dom),
                                        t = {
                                            title: n,
                                            body: {
                                                type: "panel",
                                                items: [{
                                                    type: "htmlpanel",
                                                    html: t
                                                }]
                                            },
                                            initialData: {},
                                            buttons: o.getButtons(),
                                            onCancel: e,
                                            onAction: function(t, e) {
                                                o.getAction(e.name).each(b),
                                                    t.close()
                                            }
                                        };
                                    i.windowManager.open(t)
                                })
                            },
                            hide: y,
                            destroy: function() {
                                r.clear()
                            },
                            reflow: function() {}
                        }
                    }
                }) : (c = u,
                {
                    createDialog: function() {
                        function e() {
                            n.trigger.close()
                        }
                        function t() {
                            r.off("close", e),
                                r.close("close")
                        }
                        var r, o = "", i = [], u = [], a = du(), n = Go({
                            close: Vo([])
                        });
                        return {
                            events: n.registry,
                            setTitle: function(t) {
                                o = t
                            },
                            setContent: function(t) {
                                var e = Kp(t.dom);
                                i = [{
                                    type: "container",
                                    html: e
                                }],
                                    a.set(t)
                            },
                            setButtons: function(t) {
                                var r = [];
                                t.forEach(function(t, e, n) {
                                    r.push({
                                        text: t.text,
                                        ariaLabel: t.text,
                                        onclick: t.click
                                    })
                                }),
                                    u = r
                            },
                            show: function() {
                                0 === u.length && (u = [{
                                    text: "Close",
                                    onclick: function() {
                                        r.close()
                                    }
                                }]);
                                var t = {
                                    title: o,
                                    spacing: 10,
                                    padding: 10,
                                    minWidth: 300,
                                    minHeight: 100,
                                    layout: "flex",
                                    items: i,
                                    buttons: u
                                };
                                r = c.windowManager.open(t);
                                var n = mn.fromDom(r.getEl());
                                a.on(function(t) {
                                    var e = Bi(n, "." + ln(t, "class")).getOrDie("We must find this element or we cannot continue");
                                    tu(e, t),
                                        La(e)
                                }),
                                    r.on("close", e)
                            },
                            hide: function() {
                                t()
                            },
                            destroy: function() {
                                t()
                            },
                            reflow: function() {}
                        }
                    }
                }), n = mn.fromDom(u.getBody()), r = Fp(n, e.createDialog, y, t, Gp), o = (void 0 === (t = v) && (t = Cd),
                Xd([Rp(h)], Mp(), t));
            ct([r, o], function(t) {
                t.events.cancel.bind(function() {
                    d()
                }),
                    t.events.error.bind(function(t) {
                        d(),
                            u.notificationManager ? u.notificationManager.open({
                                text: vn(t.message),
                                type: "error"
                            }) : (f ? ig : nu).showDialog(u, vn(t.message))
                    }),
                    t.events.insert.bind(function(t) {
                        var e = at(t.elements, function(t) {
                            return Kp(t.dom)
                        }).join("")
                            , n = Cr(e);
                        u.focus(),
                            s.importImages(t.assets).get(function() {
                                d(),
                                    l(u, Pr(u, n, t.isInternal, t.source, t.mode), t.assets),
                                gt(u) && s.uploadImages(t.assets)
                            })
                    })
            }),
                u.addCommand("mceInsertClipboardContent", function(t, e) {
                    void 0 !== e.content ? r.pasteCustom($d(e.content, v)) : void 0 !== e.text && o.pasteCustom(Vd(e.text, v))
                });
            n = Do(n, "paste", function(t) {
                p.isSet() || p.set(u.selection.getBookmark(1)),
                    (a.isText() ? o : r).paste(t.raw),
                    a.reset()
            });
            m.set(n),
                Jp(u)
        }),
            u.on("remove", function() {
                m.clear()
            })
    }
    var cg = function(n, r) {
        var o = fu(n.getParam("paste_as_text", !1, "boolean"))
            , i = fu(!1);
        n.on("keydown", function(t) {
            var e;
            e = t,
            tinymce.util.VK.metaKeyPressed(e) && 86 === e.keyCode && e.shiftKey && (i.set(!0),
            tinymce.Env.ie && tinymce.Env.ie < 10 && (t.preventDefault(),
                n.fire("paste", {})))
        });
        var u = function() {
            var t = !o.get();
            o.set(t),
                t = t,
                n.fire("PastePlainTextToggle", {
                    state: t
                }),
                n.focus()
        };
        return {
            buttonToggle: function(t) {
                var e = !o.get();
                r ? t.setActive(e) : this.active(e),
                    u()
            },
            toggle: u,
            reset: function() {
                i.set(!1)
            },
            isText: function() {
                return i.get() || o.get()
            }
        }
    };
    function sg(a) {
        return c(tinymce, "4.0.28") ? (s.error('The "powerpaste" plugin requires at least 4.0.28 version of TinyMCE.'),
                function() {}
        ) : function(n, t) {
            function e(e) {
                function t(t) {
                    e.setActive(t.state)
                }
                return e.setActive(u.isText()),
                    n.on("PastePlainTextToggle", t),
                    function() {
                        return n.off("PastePlainTextToggle", t)
                    }
            }
            function r() {
                var e = this;
                e.active(u.isText()),
                    n.on("PastePlainTextToggle", function(t) {
                        e.active(t.state)
                    })
            }
            var o, i = !c(tinymce, "5.0.0"), u = cg(n, i);
            tinymce.Env.ie && tinymce.Env.ie < 10 ? su(n, u) : (o = uu(n),
                ag(n, u, t, a, o, i),
                lt(n) ? Lt(n) : Mr(n, 0, o, i)),
                kr(n),
                i ? (n.ui.registry.addToggleButton("pastetext", {
                    icon: "paste-text",
                    tooltip: "Paste as text",
                    onAction: u.buttonToggle,
                    onSetup: e
                }),
                    n.ui.registry.addToggleMenuItem("pastetext", {
                        icon: "paste-text",
                        text: "Paste as text",
                        onAction: u.buttonToggle,
                        onSetup: e
                    })) : (n.addButton("pastetext", {
                    icon: "pastetext",
                    tooltip: "Paste as text",
                    onclick: u.buttonToggle,
                    onPostRender: r
                }),
                    n.addMenuItem("pastetext", {
                        text: "Paste as text",
                        selectable: !0,
                        onclick: u.buttonToggle,
                        onPostRender: r
                    })),
                f(n, u)
        }
    }
    tinymce.PluginManager.requireLangPack("powerpaste", "ar,bg_BG,ca,cs,da,de,el,es,eu,fa,fi,fr_FR,he_IL,hr,hu_HU,id,it,ja,kk,ko_KR,nb_NO,nl,pl,pt_BR,pt_PT,ro,ru,sk,sl_SI,sv_SE,th_TH,tr,uk,zh_CN,zh_TW"),
        tinymce.PluginManager.add("powerpaste", sg(void 0))
}();
